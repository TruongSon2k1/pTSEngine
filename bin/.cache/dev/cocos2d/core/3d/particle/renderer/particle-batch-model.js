
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/3d/particle/renderer/particle-batch-model.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

exports.__esModule = true;
exports["default"] = void 0;

var _gfx = _interopRequireDefault(require("../../../../renderer/gfx"));

var _inputAssembler = _interopRequireDefault(require("../../../../renderer/core/input-assembler"));

var _meshData = require("../../../mesh/mesh-data");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

// Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.
var renderer = require('../../../renderer');

var ParticleBatchModel = /*#__PURE__*/function () {
  function ParticleBatchModel() {
    this._capacity = 0;
    this._vertFormat = null;
    this._vertAttrsFloatCount = 0;
    this._mesh = null;
    this._vertCount = 0;
    this._indexCount = 0;
    this._material = null;
    this._capacity = 0;
    this._vertFormat = null;
    this._vertAttrsFloatCount = 0;
    this._mesh = null;
    this._subDatas = [];
    this._subMeshes = [];
  }

  var _proto = ParticleBatchModel.prototype;

  _proto.setCapacity = function setCapacity(capacity) {
    var capChanged = this._capacity !== capacity;
    this._capacity = capacity;

    if (this._inited && capChanged) {
      this._recreateBuffer();
    }
  };

  _proto.setVertexAttributes = function setVertexAttributes(mesh, vfmt) {
    if (this._mesh === mesh && this._vertFormat === vfmt) {
      return;
    }

    this._mesh = mesh;
    this._vertFormat = vfmt;
    this._vertAttrsFloatCount = this._vertFormat._bytes / 4; // number of float
    // rebuid

    this._createParticleData();

    this._inited = true;
  };

  _proto._recreateBuffer = function _recreateBuffer() {
    this._createParticleData();
  };

  _proto._createParticleData = function _createParticleData() {
    this.destroyIAData();
    this._vertCount = 4;
    this._indexCount = 6;
    var vbData = null;
    var ibData = null;
    var vertSize = this._vertFormat._bytes;

    if (this._mesh) {
      var subData = this._mesh._subDatas[0];
      this._vertCount = subData.vData.byteLength / subData.vfm._bytes;
      this._indexCount = subData.iData.byteLength / 2;
      vbData = new Float32Array(vertSize * this._capacity * this._vertCount / 4);
      ibData = new Uint16Array(this._capacity * this._indexCount);

      var posEle = this._vertFormat.element(_gfx["default"].ATTR_TEX_COORD3);

      var normalEle = this._vertFormat.element(_gfx["default"].ATTR_NORMAL);

      var uvEle = this._vertFormat.element(_gfx["default"].ATTR_TEX_COORD);

      var colorEle = this._vertFormat.element(_gfx["default"].ATTR_COLOR1);

      this._mesh.copyAttribute(0, _gfx["default"].ATTR_POSITION, vbData.buffer, vertSize, posEle.offset);

      this._mesh.copyAttribute(0, _gfx["default"].ATTR_NORMAL, vbData.buffer, vertSize, normalEle.offset);

      this._mesh.copyAttribute(0, _gfx["default"].ATTR_UV0, vbData.buffer, vertSize, uvEle.offset);

      if (!this._mesh.copyAttribute(0, _gfx["default"].ATTR_COLOR, vbData.buffer, vertSize, colorEle.offset)) {
        // copy mesh color to ATTR_COLOR1
        var vb = new Uint32Array(vbData.buffer);

        for (var i = 0; i < this._vertCount; ++i) {
          vb[i * this._vertAttrsFloatCount + colorEle.offset / 4] = cc.Color.WHITE._val;
        }
      }

      var vbFloatArray = new Float32Array(vbData.buffer);

      for (var i = 1; i < this._capacity; i++) {
        vbFloatArray.copyWithin(i * vertSize * this._vertCount / 4, 0, vertSize * this._vertCount / 4);
      }

      this._mesh.copyIndices(0, ibData); // indices


      for (var i = 1; i < this._capacity; i++) {
        for (var j = 0; j < this._indexCount; j++) {
          ibData[i * this._indexCount + j] = ibData[j] + i * this._vertCount;
        }
      }
    } else {
      vbData = new Float32Array(vertSize * this._capacity * this._vertCount / 4);
      ibData = new Uint16Array(this._capacity * this._indexCount);
      var dst = 0;

      for (var i = 0; i < this._capacity; ++i) {
        var baseIdx = 4 * i;
        ibData[dst++] = baseIdx;
        ibData[dst++] = baseIdx + 1;
        ibData[dst++] = baseIdx + 2;
        ibData[dst++] = baseIdx + 3;
        ibData[dst++] = baseIdx + 2;
        ibData[dst++] = baseIdx + 1;
      }
    }

    var meshData = new _meshData.MeshData();
    meshData.vData = vbData;
    meshData.iData = ibData;
    meshData.vfm = this._vertFormat;
    meshData.vDirty = true;
    meshData.iDirty = true;
    meshData.enable = true;
    this._subDatas[0] = meshData;

    if (CC_JSB && CC_NATIVERENDERER) {
      meshData.vDirty = true;
    } else {
      var _vb = new _gfx["default"].VertexBuffer(renderer.device, this._vertFormat, _gfx["default"].USAGE_DYNAMIC, vbData);

      var ib = new _gfx["default"].IndexBuffer(renderer.device, _gfx["default"].INDEX_FMT_UINT16, _gfx["default"].USAGE_STATIC, ibData, ibData.length);
      this._subMeshes[0] = new _inputAssembler["default"](_vb, ib);
    }
  };

  _proto.createTrailData = function createTrailData(vfmt, num) {
    if (this._subDatas[1]) {
      return;
    }

    var vertSize = vfmt._bytes;
    var vBuffer = new ArrayBuffer(vertSize * (num + 1) * 2);
    var ibData = new Uint16Array(num * 6);
    var meshData = new _meshData.MeshData();
    meshData.vData = new Float32Array(vBuffer);
    meshData.iData = ibData;
    meshData.vfm = vfmt;
    meshData.vDirty = true;
    meshData.iDirty = true;
    meshData.enable = true;
    this._subDatas[1] = meshData;

    if (CC_JSB && CC_NATIVERENDERER) {
      meshData.vDirty = true;
    } else {
      var vb = new _gfx["default"].VertexBuffer(renderer.device, vfmt, _gfx["default"].USAGE_DYNAMIC, vBuffer);
      var ib = new _gfx["default"].IndexBuffer(renderer.device, _gfx["default"].INDEX_FMT_UINT16, _gfx["default"].USAGE_DYNAMIC, ibData, num * 6);
      this._subMeshes[1] = new _inputAssembler["default"](vb, ib);
    }
  };

  _proto.setModelMaterial = function setModelMaterial(mat) {
    this._material = mat;
  };

  _proto.addParticleVertexData = function addParticleVertexData(index, pvdata) {
    var subData = this._subDatas[0];
    var vData = subData.getVData();
    var uintVData = subData.getVData(Uint32Array);

    if (!this._mesh) {
      var offset = index * this._vertAttrsFloatCount;
      vData[offset++] = pvdata[0].x; // position

      vData[offset++] = pvdata[0].y;
      vData[offset++] = pvdata[0].z;
      vData[offset++] = pvdata[1].x; // uv

      vData[offset++] = pvdata[1].y;
      vData[offset++] = pvdata[1].z; // frame idx

      vData[offset++] = pvdata[2].x; // size

      vData[offset++] = pvdata[2].y;
      vData[offset++] = pvdata[2].z;
      vData[offset++] = pvdata[3].x; // rotation

      vData[offset++] = pvdata[3].y;
      vData[offset++] = pvdata[3].z;
      uintVData[offset++] = pvdata[4]; // color

      if (pvdata[5]) {
        vData[offset++] = pvdata[5].x; // velocity

        vData[offset++] = pvdata[5].y;
        vData[offset++] = pvdata[5].z;
      }
    } else {
      for (var i = 0; i < this._vertCount; i++) {
        var _offset = (index * this._vertCount + i) * this._vertAttrsFloatCount;

        vData[_offset++] = pvdata[0].x; // position

        vData[_offset++] = pvdata[0].y;
        vData[_offset++] = pvdata[0].z;
        _offset += 2;
        vData[_offset++] = pvdata[1].z; // frame idx

        vData[_offset++] = pvdata[2].x; // size

        vData[_offset++] = pvdata[2].y;
        vData[_offset++] = pvdata[2].z;
        vData[_offset++] = pvdata[3].x; // rotation

        vData[_offset++] = pvdata[3].y;
        vData[_offset++] = pvdata[3].z;
        uintVData[_offset++] = pvdata[4]; // color
      }
    }
  };

  _proto._uploadData = function _uploadData() {
    var subDatas = this._subDatas;
    var subMeshes = this._subMeshes;

    for (var i = 0, len = subDatas.length; i < len; i++) {
      var subData = subDatas[i];
      var subMesh = subMeshes[i];

      if (subData.vDirty) {
        var vBuffer = subMesh._vertexBuffer,
            vData = subData.vData;
        vBuffer.update(0, vData);
        subData.vDirty = false;
      }

      if (subData.iDirty) {
        var iBuffer = subMesh._indexBuffer,
            iData = subData.iData;
        iBuffer.update(0, iData);
        subData.iDirty = false;
      }
    }
  };

  _proto.updateIA = function updateIA(index, count, vDirty, iDirty) {
    if (CC_JSB && CC_NATIVERENDERER) return;
    this._subMeshes[index]._count = count;
    var subData = this._subDatas[index];
    subData.vDirty = vDirty;
    subData.iDirty = iDirty;
  };

  _proto.clear = function clear() {
    var subMesh = this._subMeshes[0];

    if (subMesh) {
      subMesh.indexCount = 0;
    }
  };

  _proto.destroy = function destroy() {
    this._subDatas.length = 0;
    var subMeshes = this._subMeshes;

    for (var i = 0, len = subMeshes.length; i < len; i++) {
      var vb = subMeshes[i]._vertexBuffer;

      if (vb) {
        vb.destroy();
      }

      var ib = subMeshes[i]._indexBuffer;

      if (ib) {
        ib.destroy();
      }
    }

    subMeshes.length = 0;
  };

  _proto.destroyIAData = function destroyIAData() {
    if (this._subMeshes[0]) {
      this._subMeshes[0]._vertexBuffer.destroy();

      this._subMeshes[0]._indexBuffer.destroy();

      this._subMeshes[0] = null;
    }

    this._subDatas[0] = null;
  };

  return ParticleBatchModel;
}();

exports["default"] = ParticleBatchModel;
module.exports = exports["default"];
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuZ2luZS1kZXZcXGNvY29zMmRcXGNvcmVcXDNkXFxwYXJ0aWNsZVxccmVuZGVyZXJcXHBhcnRpY2xlLWJhdGNoLW1vZGVsLnRzIl0sIm5hbWVzIjpbInJlbmRlcmVyIiwicmVxdWlyZSIsIlBhcnRpY2xlQmF0Y2hNb2RlbCIsIl9jYXBhY2l0eSIsIl92ZXJ0Rm9ybWF0IiwiX3ZlcnRBdHRyc0Zsb2F0Q291bnQiLCJfbWVzaCIsIl92ZXJ0Q291bnQiLCJfaW5kZXhDb3VudCIsIl9tYXRlcmlhbCIsIl9zdWJEYXRhcyIsIl9zdWJNZXNoZXMiLCJzZXRDYXBhY2l0eSIsImNhcGFjaXR5IiwiY2FwQ2hhbmdlZCIsIl9pbml0ZWQiLCJfcmVjcmVhdGVCdWZmZXIiLCJzZXRWZXJ0ZXhBdHRyaWJ1dGVzIiwibWVzaCIsInZmbXQiLCJfYnl0ZXMiLCJfY3JlYXRlUGFydGljbGVEYXRhIiwiZGVzdHJveUlBRGF0YSIsInZiRGF0YSIsImliRGF0YSIsInZlcnRTaXplIiwic3ViRGF0YSIsInZEYXRhIiwiYnl0ZUxlbmd0aCIsInZmbSIsImlEYXRhIiwiRmxvYXQzMkFycmF5IiwiVWludDE2QXJyYXkiLCJwb3NFbGUiLCJlbGVtZW50IiwiZ2Z4IiwiQVRUUl9URVhfQ09PUkQzIiwibm9ybWFsRWxlIiwiQVRUUl9OT1JNQUwiLCJ1dkVsZSIsIkFUVFJfVEVYX0NPT1JEIiwiY29sb3JFbGUiLCJBVFRSX0NPTE9SMSIsImNvcHlBdHRyaWJ1dGUiLCJBVFRSX1BPU0lUSU9OIiwiYnVmZmVyIiwib2Zmc2V0IiwiQVRUUl9VVjAiLCJBVFRSX0NPTE9SIiwidmIiLCJVaW50MzJBcnJheSIsImkiLCJjYyIsIkNvbG9yIiwiV0hJVEUiLCJfdmFsIiwidmJGbG9hdEFycmF5IiwiY29weVdpdGhpbiIsImNvcHlJbmRpY2VzIiwiaiIsImRzdCIsImJhc2VJZHgiLCJtZXNoRGF0YSIsIk1lc2hEYXRhIiwidkRpcnR5IiwiaURpcnR5IiwiZW5hYmxlIiwiQ0NfSlNCIiwiQ0NfTkFUSVZFUkVOREVSRVIiLCJWZXJ0ZXhCdWZmZXIiLCJkZXZpY2UiLCJVU0FHRV9EWU5BTUlDIiwiaWIiLCJJbmRleEJ1ZmZlciIsIklOREVYX0ZNVF9VSU5UMTYiLCJVU0FHRV9TVEFUSUMiLCJsZW5ndGgiLCJJbnB1dEFzc2VtYmxlciIsImNyZWF0ZVRyYWlsRGF0YSIsIm51bSIsInZCdWZmZXIiLCJBcnJheUJ1ZmZlciIsInNldE1vZGVsTWF0ZXJpYWwiLCJtYXQiLCJhZGRQYXJ0aWNsZVZlcnRleERhdGEiLCJpbmRleCIsInB2ZGF0YSIsImdldFZEYXRhIiwidWludFZEYXRhIiwieCIsInkiLCJ6IiwiX3VwbG9hZERhdGEiLCJzdWJEYXRhcyIsInN1Yk1lc2hlcyIsImxlbiIsInN1Yk1lc2giLCJfdmVydGV4QnVmZmVyIiwidXBkYXRlIiwiaUJ1ZmZlciIsIl9pbmRleEJ1ZmZlciIsInVwZGF0ZUlBIiwiY291bnQiLCJfY291bnQiLCJjbGVhciIsImluZGV4Q291bnQiLCJkZXN0cm95Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBRUE7O0FBQ0E7O0FBQ0E7Ozs7QUFKQTtBQU1BLElBQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG1CQUFELENBQXhCOztJQUVxQkM7QUFTakIsZ0NBQWU7QUFBQSxTQVJmQyxTQVFlLEdBUkgsQ0FRRztBQUFBLFNBUGZDLFdBT2UsR0FQRCxJQU9DO0FBQUEsU0FOZkMsb0JBTWUsR0FOUSxDQU1SO0FBQUEsU0FMZkMsS0FLZSxHQUxQLElBS087QUFBQSxTQUpmQyxVQUllLEdBSkYsQ0FJRTtBQUFBLFNBSGZDLFdBR2UsR0FIRCxDQUdDO0FBQUEsU0FGZkMsU0FFZSxHQUZILElBRUc7QUFDWCxTQUFLTixTQUFMLEdBQWlCLENBQWpCO0FBQ0EsU0FBS0MsV0FBTCxHQUFtQixJQUFuQjtBQUNBLFNBQUtDLG9CQUFMLEdBQTRCLENBQTVCO0FBQ0EsU0FBS0MsS0FBTCxHQUFhLElBQWI7QUFFQSxTQUFLSSxTQUFMLEdBQWlCLEVBQWpCO0FBQ0EsU0FBS0MsVUFBTCxHQUFrQixFQUFsQjtBQUNIOzs7O1NBRURDLGNBQUEscUJBQWFDLFFBQWIsRUFBdUI7QUFDbkIsUUFBTUMsVUFBVSxHQUFHLEtBQUtYLFNBQUwsS0FBbUJVLFFBQXRDO0FBQ0EsU0FBS1YsU0FBTCxHQUFpQlUsUUFBakI7O0FBQ0EsUUFBSSxLQUFLRSxPQUFMLElBQWdCRCxVQUFwQixFQUFnQztBQUM1QixXQUFLRSxlQUFMO0FBQ0g7QUFDSjs7U0FFREMsc0JBQUEsNkJBQXFCQyxJQUFyQixFQUEyQkMsSUFBM0IsRUFBaUM7QUFDN0IsUUFBSSxLQUFLYixLQUFMLEtBQWVZLElBQWYsSUFBdUIsS0FBS2QsV0FBTCxLQUFxQmUsSUFBaEQsRUFBc0Q7QUFDbEQ7QUFDSDs7QUFDRCxTQUFLYixLQUFMLEdBQWFZLElBQWI7QUFDQSxTQUFLZCxXQUFMLEdBQW1CZSxJQUFuQjtBQUNBLFNBQUtkLG9CQUFMLEdBQTRCLEtBQUtELFdBQUwsQ0FBaUJnQixNQUFqQixHQUEwQixDQUF0RCxDQU42QixDQU00QjtBQUN6RDs7QUFDQSxTQUFLQyxtQkFBTDs7QUFDQSxTQUFLTixPQUFMLEdBQWUsSUFBZjtBQUNIOztTQUVEQyxrQkFBQSwyQkFBbUI7QUFDZixTQUFLSyxtQkFBTDtBQUNIOztTQUVEQSxzQkFBQSwrQkFBdUI7QUFDbkIsU0FBS0MsYUFBTDtBQUNBLFNBQUtmLFVBQUwsR0FBa0IsQ0FBbEI7QUFDQSxTQUFLQyxXQUFMLEdBQW1CLENBQW5CO0FBRUEsUUFBSWUsTUFBTSxHQUFHLElBQWI7QUFDQSxRQUFJQyxNQUFNLEdBQUcsSUFBYjtBQUNBLFFBQUlDLFFBQVEsR0FBRyxLQUFLckIsV0FBTCxDQUFpQmdCLE1BQWhDOztBQUVBLFFBQUksS0FBS2QsS0FBVCxFQUFnQjtBQUNaLFVBQUlvQixPQUFPLEdBQUcsS0FBS3BCLEtBQUwsQ0FBV0ksU0FBWCxDQUFxQixDQUFyQixDQUFkO0FBRUEsV0FBS0gsVUFBTCxHQUFrQm1CLE9BQU8sQ0FBQ0MsS0FBUixDQUFjQyxVQUFkLEdBQTJCRixPQUFPLENBQUNHLEdBQVIsQ0FBWVQsTUFBekQ7QUFDQSxXQUFLWixXQUFMLEdBQW1Ca0IsT0FBTyxDQUFDSSxLQUFSLENBQWNGLFVBQWQsR0FBMkIsQ0FBOUM7QUFFQUwsTUFBQUEsTUFBTSxHQUFHLElBQUlRLFlBQUosQ0FBaUJOLFFBQVEsR0FBRyxLQUFLdEIsU0FBaEIsR0FBNEIsS0FBS0ksVUFBakMsR0FBOEMsQ0FBL0QsQ0FBVDtBQUNBaUIsTUFBQUEsTUFBTSxHQUFHLElBQUlRLFdBQUosQ0FBZ0IsS0FBSzdCLFNBQUwsR0FBaUIsS0FBS0ssV0FBdEMsQ0FBVDs7QUFFQSxVQUFJeUIsTUFBTSxHQUFHLEtBQUs3QixXQUFMLENBQWlCOEIsT0FBakIsQ0FBeUJDLGdCQUFJQyxlQUE3QixDQUFiOztBQUNBLFVBQUlDLFNBQVMsR0FBRyxLQUFLakMsV0FBTCxDQUFpQjhCLE9BQWpCLENBQXlCQyxnQkFBSUcsV0FBN0IsQ0FBaEI7O0FBQ0EsVUFBSUMsS0FBSyxHQUFHLEtBQUtuQyxXQUFMLENBQWlCOEIsT0FBakIsQ0FBeUJDLGdCQUFJSyxjQUE3QixDQUFaOztBQUNBLFVBQUlDLFFBQVEsR0FBRyxLQUFLckMsV0FBTCxDQUFpQjhCLE9BQWpCLENBQXlCQyxnQkFBSU8sV0FBN0IsQ0FBZjs7QUFFQSxXQUFLcEMsS0FBTCxDQUFXcUMsYUFBWCxDQUF5QixDQUF6QixFQUE0QlIsZ0JBQUlTLGFBQWhDLEVBQStDckIsTUFBTSxDQUFDc0IsTUFBdEQsRUFBOERwQixRQUE5RCxFQUF3RVEsTUFBTSxDQUFDYSxNQUEvRTs7QUFDQSxXQUFLeEMsS0FBTCxDQUFXcUMsYUFBWCxDQUF5QixDQUF6QixFQUE0QlIsZ0JBQUlHLFdBQWhDLEVBQTZDZixNQUFNLENBQUNzQixNQUFwRCxFQUE0RHBCLFFBQTVELEVBQXNFWSxTQUFTLENBQUNTLE1BQWhGOztBQUNBLFdBQUt4QyxLQUFMLENBQVdxQyxhQUFYLENBQXlCLENBQXpCLEVBQTRCUixnQkFBSVksUUFBaEMsRUFBMEN4QixNQUFNLENBQUNzQixNQUFqRCxFQUF5RHBCLFFBQXpELEVBQW1FYyxLQUFLLENBQUNPLE1BQXpFOztBQUVBLFVBQUksQ0FBQyxLQUFLeEMsS0FBTCxDQUFXcUMsYUFBWCxDQUF5QixDQUF6QixFQUE0QlIsZ0JBQUlhLFVBQWhDLEVBQTRDekIsTUFBTSxDQUFDc0IsTUFBbkQsRUFBMkRwQixRQUEzRCxFQUFxRWdCLFFBQVEsQ0FBQ0ssTUFBOUUsQ0FBTCxFQUE0RjtBQUFHO0FBQzNGLFlBQU1HLEVBQUUsR0FBRyxJQUFJQyxXQUFKLENBQWdCM0IsTUFBTSxDQUFDc0IsTUFBdkIsQ0FBWDs7QUFDQSxhQUFLLElBQUlNLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUcsS0FBSzVDLFVBQXpCLEVBQXFDLEVBQUU0QyxDQUF2QyxFQUEwQztBQUN0Q0YsVUFBQUEsRUFBRSxDQUFDRSxDQUFDLEdBQUcsS0FBSzlDLG9CQUFULEdBQWdDb0MsUUFBUSxDQUFDSyxNQUFULEdBQWtCLENBQW5ELENBQUYsR0FBMERNLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTQyxLQUFULENBQWVDLElBQXpFO0FBQ0g7QUFDSjs7QUFFRCxVQUFNQyxZQUFZLEdBQUcsSUFBSXpCLFlBQUosQ0FBaUJSLE1BQU0sQ0FBQ3NCLE1BQXhCLENBQXJCOztBQUNBLFdBQUssSUFBSU0sQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxLQUFLaEQsU0FBekIsRUFBb0NnRCxDQUFDLEVBQXJDLEVBQXlDO0FBQ3JDSyxRQUFBQSxZQUFZLENBQUNDLFVBQWIsQ0FBd0JOLENBQUMsR0FBRzFCLFFBQUosR0FBZSxLQUFLbEIsVUFBcEIsR0FBaUMsQ0FBekQsRUFBNEQsQ0FBNUQsRUFBK0RrQixRQUFRLEdBQUcsS0FBS2xCLFVBQWhCLEdBQTZCLENBQTVGO0FBQ0g7O0FBRUQsV0FBS0QsS0FBTCxDQUFXb0QsV0FBWCxDQUF1QixDQUF2QixFQUEwQmxDLE1BQTFCLEVBOUJZLENBK0JaOzs7QUFDQSxXQUFLLElBQUkyQixDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUtoRCxTQUF6QixFQUFvQ2dELENBQUMsRUFBckMsRUFBeUM7QUFDckMsYUFBSyxJQUFJUSxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUtuRCxXQUF6QixFQUFzQ21ELENBQUMsRUFBdkMsRUFBMkM7QUFDdkNuQyxVQUFBQSxNQUFNLENBQUMyQixDQUFDLEdBQUcsS0FBSzNDLFdBQVQsR0FBdUJtRCxDQUF4QixDQUFOLEdBQW1DbkMsTUFBTSxDQUFDbUMsQ0FBRCxDQUFOLEdBQVlSLENBQUMsR0FBRyxLQUFLNUMsVUFBeEQ7QUFDSDtBQUNKO0FBQ0osS0FyQ0QsTUFxQ087QUFDSGdCLE1BQUFBLE1BQU0sR0FBRyxJQUFJUSxZQUFKLENBQWlCTixRQUFRLEdBQUcsS0FBS3RCLFNBQWhCLEdBQTRCLEtBQUtJLFVBQWpDLEdBQThDLENBQS9ELENBQVQ7QUFDQWlCLE1BQUFBLE1BQU0sR0FBRyxJQUFJUSxXQUFKLENBQWdCLEtBQUs3QixTQUFMLEdBQWlCLEtBQUtLLFdBQXRDLENBQVQ7QUFFQSxVQUFJb0QsR0FBRyxHQUFHLENBQVY7O0FBQ0EsV0FBSyxJQUFJVCxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUtoRCxTQUF6QixFQUFvQyxFQUFFZ0QsQ0FBdEMsRUFBeUM7QUFDckMsWUFBTVUsT0FBTyxHQUFHLElBQUlWLENBQXBCO0FBQ0EzQixRQUFBQSxNQUFNLENBQUNvQyxHQUFHLEVBQUosQ0FBTixHQUFnQkMsT0FBaEI7QUFDQXJDLFFBQUFBLE1BQU0sQ0FBQ29DLEdBQUcsRUFBSixDQUFOLEdBQWdCQyxPQUFPLEdBQUcsQ0FBMUI7QUFDQXJDLFFBQUFBLE1BQU0sQ0FBQ29DLEdBQUcsRUFBSixDQUFOLEdBQWdCQyxPQUFPLEdBQUcsQ0FBMUI7QUFDQXJDLFFBQUFBLE1BQU0sQ0FBQ29DLEdBQUcsRUFBSixDQUFOLEdBQWdCQyxPQUFPLEdBQUcsQ0FBMUI7QUFDQXJDLFFBQUFBLE1BQU0sQ0FBQ29DLEdBQUcsRUFBSixDQUFOLEdBQWdCQyxPQUFPLEdBQUcsQ0FBMUI7QUFDQXJDLFFBQUFBLE1BQU0sQ0FBQ29DLEdBQUcsRUFBSixDQUFOLEdBQWdCQyxPQUFPLEdBQUcsQ0FBMUI7QUFDSDtBQUNKOztBQUVELFFBQUlDLFFBQVEsR0FBRyxJQUFJQyxrQkFBSixFQUFmO0FBQ0FELElBQUFBLFFBQVEsQ0FBQ25DLEtBQVQsR0FBaUJKLE1BQWpCO0FBQ0F1QyxJQUFBQSxRQUFRLENBQUNoQyxLQUFULEdBQWlCTixNQUFqQjtBQUNBc0MsSUFBQUEsUUFBUSxDQUFDakMsR0FBVCxHQUFlLEtBQUt6QixXQUFwQjtBQUNBMEQsSUFBQUEsUUFBUSxDQUFDRSxNQUFULEdBQWtCLElBQWxCO0FBQ0FGLElBQUFBLFFBQVEsQ0FBQ0csTUFBVCxHQUFrQixJQUFsQjtBQUNBSCxJQUFBQSxRQUFRLENBQUNJLE1BQVQsR0FBa0IsSUFBbEI7QUFDQSxTQUFLeEQsU0FBTCxDQUFlLENBQWYsSUFBb0JvRCxRQUFwQjs7QUFFQSxRQUFJSyxNQUFNLElBQUlDLGlCQUFkLEVBQWlDO0FBQzdCTixNQUFBQSxRQUFRLENBQUNFLE1BQVQsR0FBa0IsSUFBbEI7QUFDSCxLQUZELE1BRU87QUFDSCxVQUFJZixHQUFFLEdBQUcsSUFBSWQsZ0JBQUlrQyxZQUFSLENBQ0xyRSxRQUFRLENBQUNzRSxNQURKLEVBRUwsS0FBS2xFLFdBRkEsRUFHTCtCLGdCQUFJb0MsYUFIQyxFQUlMaEQsTUFKSyxDQUFUOztBQU9BLFVBQUlpRCxFQUFFLEdBQUcsSUFBSXJDLGdCQUFJc0MsV0FBUixDQUNMekUsUUFBUSxDQUFDc0UsTUFESixFQUVMbkMsZ0JBQUl1QyxnQkFGQyxFQUdMdkMsZ0JBQUl3QyxZQUhDLEVBSUxuRCxNQUpLLEVBS0xBLE1BQU0sQ0FBQ29ELE1BTEYsQ0FBVDtBQVFBLFdBQUtqRSxVQUFMLENBQWdCLENBQWhCLElBQXFCLElBQUlrRSwwQkFBSixDQUFtQjVCLEdBQW5CLEVBQXVCdUIsRUFBdkIsQ0FBckI7QUFDSDtBQUNKOztTQUVETSxrQkFBQSx5QkFBaUIzRCxJQUFqQixFQUF1QjRELEdBQXZCLEVBQTRCO0FBQ3hCLFFBQUksS0FBS3JFLFNBQUwsQ0FBZSxDQUFmLENBQUosRUFBdUI7QUFDbkI7QUFDSDs7QUFFRCxRQUFJZSxRQUFRLEdBQUdOLElBQUksQ0FBQ0MsTUFBcEI7QUFDQSxRQUFJNEQsT0FBTyxHQUFHLElBQUlDLFdBQUosQ0FBZ0J4RCxRQUFRLElBQUlzRCxHQUFHLEdBQUcsQ0FBVixDQUFSLEdBQXVCLENBQXZDLENBQWQ7QUFDQSxRQUFJdkQsTUFBTSxHQUFHLElBQUlRLFdBQUosQ0FBZ0IrQyxHQUFHLEdBQUcsQ0FBdEIsQ0FBYjtBQUVBLFFBQUlqQixRQUFRLEdBQUcsSUFBSUMsa0JBQUosRUFBZjtBQUNBRCxJQUFBQSxRQUFRLENBQUNuQyxLQUFULEdBQWlCLElBQUlJLFlBQUosQ0FBaUJpRCxPQUFqQixDQUFqQjtBQUNBbEIsSUFBQUEsUUFBUSxDQUFDaEMsS0FBVCxHQUFpQk4sTUFBakI7QUFDQXNDLElBQUFBLFFBQVEsQ0FBQ2pDLEdBQVQsR0FBZVYsSUFBZjtBQUNBMkMsSUFBQUEsUUFBUSxDQUFDRSxNQUFULEdBQWtCLElBQWxCO0FBQ0FGLElBQUFBLFFBQVEsQ0FBQ0csTUFBVCxHQUFrQixJQUFsQjtBQUNBSCxJQUFBQSxRQUFRLENBQUNJLE1BQVQsR0FBa0IsSUFBbEI7QUFDQSxTQUFLeEQsU0FBTCxDQUFlLENBQWYsSUFBb0JvRCxRQUFwQjs7QUFFQSxRQUFJSyxNQUFNLElBQUlDLGlCQUFkLEVBQWlDO0FBQzdCTixNQUFBQSxRQUFRLENBQUNFLE1BQVQsR0FBa0IsSUFBbEI7QUFDSCxLQUZELE1BRU87QUFDSCxVQUFJZixFQUFFLEdBQUcsSUFBSWQsZ0JBQUlrQyxZQUFSLENBQ0xyRSxRQUFRLENBQUNzRSxNQURKLEVBRUxuRCxJQUZLLEVBR0xnQixnQkFBSW9DLGFBSEMsRUFJTFMsT0FKSyxDQUFUO0FBTUEsVUFBSVIsRUFBRSxHQUFHLElBQUlyQyxnQkFBSXNDLFdBQVIsQ0FDTHpFLFFBQVEsQ0FBQ3NFLE1BREosRUFFTG5DLGdCQUFJdUMsZ0JBRkMsRUFHTHZDLGdCQUFJb0MsYUFIQyxFQUlML0MsTUFKSyxFQUtMdUQsR0FBRyxHQUFHLENBTEQsQ0FBVDtBQVFBLFdBQUtwRSxVQUFMLENBQWdCLENBQWhCLElBQXFCLElBQUlrRSwwQkFBSixDQUFtQjVCLEVBQW5CLEVBQXVCdUIsRUFBdkIsQ0FBckI7QUFDSDtBQUNKOztTQUVEVSxtQkFBQSwwQkFBa0JDLEdBQWxCLEVBQXVCO0FBQ25CLFNBQUsxRSxTQUFMLEdBQWlCMEUsR0FBakI7QUFDSDs7U0FFREMsd0JBQUEsK0JBQXVCQyxLQUF2QixFQUE4QkMsTUFBOUIsRUFBc0M7QUFDbEMsUUFBSTVELE9BQU8sR0FBRyxLQUFLaEIsU0FBTCxDQUFlLENBQWYsQ0FBZDtBQUNBLFFBQUlpQixLQUFLLEdBQUdELE9BQU8sQ0FBQzZELFFBQVIsRUFBWjtBQUNBLFFBQUlDLFNBQVMsR0FBRzlELE9BQU8sQ0FBQzZELFFBQVIsQ0FBaUJyQyxXQUFqQixDQUFoQjs7QUFFQSxRQUFJLENBQUMsS0FBSzVDLEtBQVYsRUFBaUI7QUFDYixVQUFJd0MsTUFBTSxHQUFHdUMsS0FBSyxHQUFHLEtBQUtoRixvQkFBMUI7QUFDQXNCLE1BQUFBLEtBQUssQ0FBQ21CLE1BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVRyxDQUE1QixDQUZhLENBRWtCOztBQUMvQjlELE1BQUFBLEtBQUssQ0FBQ21CLE1BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVSSxDQUE1QjtBQUNBL0QsTUFBQUEsS0FBSyxDQUFDbUIsTUFBTSxFQUFQLENBQUwsR0FBa0J3QyxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVLLENBQTVCO0FBQ0FoRSxNQUFBQSxLQUFLLENBQUNtQixNQUFNLEVBQVAsQ0FBTCxHQUFrQndDLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVUcsQ0FBNUIsQ0FMYSxDQUtrQjs7QUFDL0I5RCxNQUFBQSxLQUFLLENBQUNtQixNQUFNLEVBQVAsQ0FBTCxHQUFrQndDLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVUksQ0FBNUI7QUFDQS9ELE1BQUFBLEtBQUssQ0FBQ21CLE1BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVSyxDQUE1QixDQVBhLENBT2tCOztBQUMvQmhFLE1BQUFBLEtBQUssQ0FBQ21CLE1BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVRyxDQUE1QixDQVJhLENBUWtCOztBQUMvQjlELE1BQUFBLEtBQUssQ0FBQ21CLE1BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVSSxDQUE1QjtBQUNBL0QsTUFBQUEsS0FBSyxDQUFDbUIsTUFBTSxFQUFQLENBQUwsR0FBa0J3QyxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVLLENBQTVCO0FBQ0FoRSxNQUFBQSxLQUFLLENBQUNtQixNQUFNLEVBQVAsQ0FBTCxHQUFrQndDLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVUcsQ0FBNUIsQ0FYYSxDQVdrQjs7QUFDL0I5RCxNQUFBQSxLQUFLLENBQUNtQixNQUFNLEVBQVAsQ0FBTCxHQUFrQndDLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVUksQ0FBNUI7QUFDQS9ELE1BQUFBLEtBQUssQ0FBQ21CLE1BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVSyxDQUE1QjtBQUNBSCxNQUFBQSxTQUFTLENBQUMxQyxNQUFNLEVBQVAsQ0FBVCxHQUFzQndDLE1BQU0sQ0FBQyxDQUFELENBQTVCLENBZGEsQ0Fjb0I7O0FBQ2pDLFVBQUlBLE1BQU0sQ0FBQyxDQUFELENBQVYsRUFBZTtBQUNYM0QsUUFBQUEsS0FBSyxDQUFDbUIsTUFBTSxFQUFQLENBQUwsR0FBa0J3QyxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVHLENBQTVCLENBRFcsQ0FDb0I7O0FBQy9COUQsUUFBQUEsS0FBSyxDQUFDbUIsTUFBTSxFQUFQLENBQUwsR0FBa0J3QyxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVJLENBQTVCO0FBQ0EvRCxRQUFBQSxLQUFLLENBQUNtQixNQUFNLEVBQVAsQ0FBTCxHQUFrQndDLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVUssQ0FBNUI7QUFDSDtBQUNKLEtBcEJELE1Bb0JPO0FBQ0gsV0FBSyxJQUFJeEMsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxLQUFLNUMsVUFBekIsRUFBcUM0QyxDQUFDLEVBQXRDLEVBQTBDO0FBQ3RDLFlBQUlMLE9BQU0sR0FBRyxDQUFDdUMsS0FBSyxHQUFHLEtBQUs5RSxVQUFiLEdBQTBCNEMsQ0FBM0IsSUFBZ0MsS0FBSzlDLG9CQUFsRDs7QUFDQXNCLFFBQUFBLEtBQUssQ0FBQ21CLE9BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVRyxDQUE1QixDQUZzQyxDQUVQOztBQUMvQjlELFFBQUFBLEtBQUssQ0FBQ21CLE9BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVSSxDQUE1QjtBQUNBL0QsUUFBQUEsS0FBSyxDQUFDbUIsT0FBTSxFQUFQLENBQUwsR0FBa0J3QyxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVLLENBQTVCO0FBQ0E3QyxRQUFBQSxPQUFNLElBQUksQ0FBVjtBQUNBbkIsUUFBQUEsS0FBSyxDQUFDbUIsT0FBTSxFQUFQLENBQUwsR0FBa0J3QyxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVLLENBQTVCLENBTnNDLENBTVA7O0FBQy9CaEUsUUFBQUEsS0FBSyxDQUFDbUIsT0FBTSxFQUFQLENBQUwsR0FBa0J3QyxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVHLENBQTVCLENBUHNDLENBT1A7O0FBQy9COUQsUUFBQUEsS0FBSyxDQUFDbUIsT0FBTSxFQUFQLENBQUwsR0FBa0J3QyxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVJLENBQTVCO0FBQ0EvRCxRQUFBQSxLQUFLLENBQUNtQixPQUFNLEVBQVAsQ0FBTCxHQUFrQndDLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVUssQ0FBNUI7QUFDQWhFLFFBQUFBLEtBQUssQ0FBQ21CLE9BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVRyxDQUE1QixDQVZzQyxDQVVQOztBQUMvQjlELFFBQUFBLEtBQUssQ0FBQ21CLE9BQU0sRUFBUCxDQUFMLEdBQWtCd0MsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVSSxDQUE1QjtBQUNBL0QsUUFBQUEsS0FBSyxDQUFDbUIsT0FBTSxFQUFQLENBQUwsR0FBa0J3QyxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVLLENBQTVCO0FBQ0FILFFBQUFBLFNBQVMsQ0FBQzFDLE9BQU0sRUFBUCxDQUFULEdBQXNCd0MsTUFBTSxDQUFDLENBQUQsQ0FBNUIsQ0Fic0MsQ0FhTDtBQUNwQztBQUNKO0FBQ0o7O1NBRURNLGNBQUEsdUJBQWU7QUFDWCxRQUFJQyxRQUFRLEdBQUcsS0FBS25GLFNBQXBCO0FBQ0EsUUFBSW9GLFNBQVMsR0FBRyxLQUFLbkYsVUFBckI7O0FBQ0EsU0FBSyxJQUFJd0MsQ0FBQyxHQUFHLENBQVIsRUFBVzRDLEdBQUcsR0FBR0YsUUFBUSxDQUFDakIsTUFBL0IsRUFBdUN6QixDQUFDLEdBQUc0QyxHQUEzQyxFQUFnRDVDLENBQUMsRUFBakQsRUFBcUQ7QUFDakQsVUFBSXpCLE9BQU8sR0FBR21FLFFBQVEsQ0FBQzFDLENBQUQsQ0FBdEI7QUFDQSxVQUFJNkMsT0FBTyxHQUFHRixTQUFTLENBQUMzQyxDQUFELENBQXZCOztBQUNBLFVBQUl6QixPQUFPLENBQUNzQyxNQUFaLEVBQW9CO0FBQ2hCLFlBQUlnQixPQUFPLEdBQUdnQixPQUFPLENBQUNDLGFBQXRCO0FBQUEsWUFBcUN0RSxLQUFLLEdBQUdELE9BQU8sQ0FBQ0MsS0FBckQ7QUFDQXFELFFBQUFBLE9BQU8sQ0FBQ2tCLE1BQVIsQ0FBZSxDQUFmLEVBQWtCdkUsS0FBbEI7QUFDQUQsUUFBQUEsT0FBTyxDQUFDc0MsTUFBUixHQUFpQixLQUFqQjtBQUNIOztBQUVELFVBQUl0QyxPQUFPLENBQUN1QyxNQUFaLEVBQW9CO0FBQ2hCLFlBQUlrQyxPQUFPLEdBQUdILE9BQU8sQ0FBQ0ksWUFBdEI7QUFBQSxZQUFvQ3RFLEtBQUssR0FBR0osT0FBTyxDQUFDSSxLQUFwRDtBQUNBcUUsUUFBQUEsT0FBTyxDQUFDRCxNQUFSLENBQWUsQ0FBZixFQUFrQnBFLEtBQWxCO0FBQ0FKLFFBQUFBLE9BQU8sQ0FBQ3VDLE1BQVIsR0FBaUIsS0FBakI7QUFDSDtBQUNKO0FBQ0o7O1NBRURvQyxXQUFBLGtCQUFVaEIsS0FBVixFQUFpQmlCLEtBQWpCLEVBQXdCdEMsTUFBeEIsRUFBZ0NDLE1BQWhDLEVBQXdDO0FBQ3BDLFFBQUlFLE1BQU0sSUFBSUMsaUJBQWQsRUFBaUM7QUFFakMsU0FBS3pELFVBQUwsQ0FBZ0IwRSxLQUFoQixFQUF1QmtCLE1BQXZCLEdBQWdDRCxLQUFoQztBQUVBLFFBQUk1RSxPQUFPLEdBQUcsS0FBS2hCLFNBQUwsQ0FBZTJFLEtBQWYsQ0FBZDtBQUNBM0QsSUFBQUEsT0FBTyxDQUFDc0MsTUFBUixHQUFpQkEsTUFBakI7QUFDQXRDLElBQUFBLE9BQU8sQ0FBQ3VDLE1BQVIsR0FBaUJBLE1BQWpCO0FBQ0g7O1NBRUR1QyxRQUFBLGlCQUFTO0FBQ0wsUUFBSVIsT0FBTyxHQUFHLEtBQUtyRixVQUFMLENBQWdCLENBQWhCLENBQWQ7O0FBQ0EsUUFBSXFGLE9BQUosRUFBYTtBQUNUQSxNQUFBQSxPQUFPLENBQUNTLFVBQVIsR0FBcUIsQ0FBckI7QUFDSDtBQUNKOztTQUVEQyxVQUFBLG1CQUFXO0FBQ1AsU0FBS2hHLFNBQUwsQ0FBZWtFLE1BQWYsR0FBd0IsQ0FBeEI7QUFFQSxRQUFJa0IsU0FBUyxHQUFHLEtBQUtuRixVQUFyQjs7QUFDQSxTQUFLLElBQUl3QyxDQUFDLEdBQUcsQ0FBUixFQUFXNEMsR0FBRyxHQUFHRCxTQUFTLENBQUNsQixNQUFoQyxFQUF3Q3pCLENBQUMsR0FBRzRDLEdBQTVDLEVBQWlENUMsQ0FBQyxFQUFsRCxFQUFzRDtBQUNsRCxVQUFJRixFQUFFLEdBQUc2QyxTQUFTLENBQUMzQyxDQUFELENBQVQsQ0FBYThDLGFBQXRCOztBQUNBLFVBQUloRCxFQUFKLEVBQVE7QUFDSkEsUUFBQUEsRUFBRSxDQUFDeUQsT0FBSDtBQUNIOztBQUVELFVBQUlsQyxFQUFFLEdBQUdzQixTQUFTLENBQUMzQyxDQUFELENBQVQsQ0FBYWlELFlBQXRCOztBQUNBLFVBQUk1QixFQUFKLEVBQVE7QUFDSkEsUUFBQUEsRUFBRSxDQUFDa0MsT0FBSDtBQUNIO0FBQ0o7O0FBQ0RaLElBQUFBLFNBQVMsQ0FBQ2xCLE1BQVYsR0FBbUIsQ0FBbkI7QUFDSDs7U0FFRHRELGdCQUFBLHlCQUFpQjtBQUNiLFFBQUksS0FBS1gsVUFBTCxDQUFnQixDQUFoQixDQUFKLEVBQXdCO0FBQ3BCLFdBQUtBLFVBQUwsQ0FBZ0IsQ0FBaEIsRUFBbUJzRixhQUFuQixDQUFpQ1MsT0FBakM7O0FBQ0EsV0FBSy9GLFVBQUwsQ0FBZ0IsQ0FBaEIsRUFBbUJ5RixZQUFuQixDQUFnQ00sT0FBaEM7O0FBQ0EsV0FBSy9GLFVBQUwsQ0FBZ0IsQ0FBaEIsSUFBcUIsSUFBckI7QUFDSDs7QUFFRCxTQUFLRCxTQUFMLENBQWUsQ0FBZixJQUFvQixJQUFwQjtBQUNIIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE3LTIwMTggWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuXHJcblxyXG5pbXBvcnQgZ2Z4IGZyb20gJy4uLy4uLy4uLy4uL3JlbmRlcmVyL2dmeCdcclxuaW1wb3J0IElucHV0QXNzZW1ibGVyIGZyb20gJy4uLy4uLy4uLy4uL3JlbmRlcmVyL2NvcmUvaW5wdXQtYXNzZW1ibGVyJ1xyXG5pbXBvcnQgeyBNZXNoRGF0YSB9IGZyb20gJy4uLy4uLy4uL21lc2gvbWVzaC1kYXRhJ1xyXG5cclxuY29uc3QgcmVuZGVyZXIgPSByZXF1aXJlKCcuLi8uLi8uLi9yZW5kZXJlcicpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFydGljbGVCYXRjaE1vZGVse1xyXG4gICAgX2NhcGFjaXR5ID0gMDtcclxuICAgIF92ZXJ0Rm9ybWF0ID0gbnVsbDtcclxuICAgIF92ZXJ0QXR0cnNGbG9hdENvdW50ID0gMDtcclxuICAgIF9tZXNoID0gbnVsbDtcclxuICAgIF92ZXJ0Q291bnQgPSAwO1xyXG4gICAgX2luZGV4Q291bnQgPSAwO1xyXG4gICAgX21hdGVyaWFsID0gbnVsbDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciAoKSB7XHJcbiAgICAgICAgdGhpcy5fY2FwYWNpdHkgPSAwO1xyXG4gICAgICAgIHRoaXMuX3ZlcnRGb3JtYXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3ZlcnRBdHRyc0Zsb2F0Q291bnQgPSAwO1xyXG4gICAgICAgIHRoaXMuX21lc2ggPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLl9zdWJEYXRhcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuX3N1Yk1lc2hlcyA9IFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHNldENhcGFjaXR5IChjYXBhY2l0eSkge1xyXG4gICAgICAgIGNvbnN0IGNhcENoYW5nZWQgPSB0aGlzLl9jYXBhY2l0eSAhPT0gY2FwYWNpdHk7XHJcbiAgICAgICAgdGhpcy5fY2FwYWNpdHkgPSBjYXBhY2l0eTtcclxuICAgICAgICBpZiAodGhpcy5faW5pdGVkICYmIGNhcENoYW5nZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVjcmVhdGVCdWZmZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VmVydGV4QXR0cmlidXRlcyAobWVzaCwgdmZtdCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9tZXNoID09PSBtZXNoICYmIHRoaXMuX3ZlcnRGb3JtYXQgPT09IHZmbXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9tZXNoID0gbWVzaDtcclxuICAgICAgICB0aGlzLl92ZXJ0Rm9ybWF0ID0gdmZtdDtcclxuICAgICAgICB0aGlzLl92ZXJ0QXR0cnNGbG9hdENvdW50ID0gdGhpcy5fdmVydEZvcm1hdC5fYnl0ZXMgLyA0OyAvLyBudW1iZXIgb2YgZmxvYXRcclxuICAgICAgICAvLyByZWJ1aWRcclxuICAgICAgICB0aGlzLl9jcmVhdGVQYXJ0aWNsZURhdGEoKTtcclxuICAgICAgICB0aGlzLl9pbml0ZWQgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIF9yZWNyZWF0ZUJ1ZmZlciAoKSB7XHJcbiAgICAgICAgdGhpcy5fY3JlYXRlUGFydGljbGVEYXRhKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2NyZWF0ZVBhcnRpY2xlRGF0YSAoKSB7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95SUFEYXRhKCk7XHJcbiAgICAgICAgdGhpcy5fdmVydENvdW50ID0gNDtcclxuICAgICAgICB0aGlzLl9pbmRleENvdW50ID0gNjtcclxuXHJcbiAgICAgICAgbGV0IHZiRGF0YSA9IG51bGw7XHJcbiAgICAgICAgbGV0IGliRGF0YSA9IG51bGw7XHJcbiAgICAgICAgbGV0IHZlcnRTaXplID0gdGhpcy5fdmVydEZvcm1hdC5fYnl0ZXNcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX21lc2gpIHtcclxuICAgICAgICAgICAgbGV0IHN1YkRhdGEgPSB0aGlzLl9tZXNoLl9zdWJEYXRhc1swXTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3ZlcnRDb3VudCA9IHN1YkRhdGEudkRhdGEuYnl0ZUxlbmd0aCAvIHN1YkRhdGEudmZtLl9ieXRlcztcclxuICAgICAgICAgICAgdGhpcy5faW5kZXhDb3VudCA9IHN1YkRhdGEuaURhdGEuYnl0ZUxlbmd0aCAvIDI7XHJcblxyXG4gICAgICAgICAgICB2YkRhdGEgPSBuZXcgRmxvYXQzMkFycmF5KHZlcnRTaXplICogdGhpcy5fY2FwYWNpdHkgKiB0aGlzLl92ZXJ0Q291bnQgLyA0KTtcclxuICAgICAgICAgICAgaWJEYXRhID0gbmV3IFVpbnQxNkFycmF5KHRoaXMuX2NhcGFjaXR5ICogdGhpcy5faW5kZXhDb3VudCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgcG9zRWxlID0gdGhpcy5fdmVydEZvcm1hdC5lbGVtZW50KGdmeC5BVFRSX1RFWF9DT09SRDMpO1xyXG4gICAgICAgICAgICBsZXQgbm9ybWFsRWxlID0gdGhpcy5fdmVydEZvcm1hdC5lbGVtZW50KGdmeC5BVFRSX05PUk1BTCk7XHJcbiAgICAgICAgICAgIGxldCB1dkVsZSA9IHRoaXMuX3ZlcnRGb3JtYXQuZWxlbWVudChnZnguQVRUUl9URVhfQ09PUkQpO1xyXG4gICAgICAgICAgICBsZXQgY29sb3JFbGUgPSB0aGlzLl92ZXJ0Rm9ybWF0LmVsZW1lbnQoZ2Z4LkFUVFJfQ09MT1IxKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX21lc2guY29weUF0dHJpYnV0ZSgwLCBnZnguQVRUUl9QT1NJVElPTiwgdmJEYXRhLmJ1ZmZlciwgdmVydFNpemUsIHBvc0VsZS5vZmZzZXQpO1xyXG4gICAgICAgICAgICB0aGlzLl9tZXNoLmNvcHlBdHRyaWJ1dGUoMCwgZ2Z4LkFUVFJfTk9STUFMLCB2YkRhdGEuYnVmZmVyLCB2ZXJ0U2l6ZSwgbm9ybWFsRWxlLm9mZnNldCk7XHJcbiAgICAgICAgICAgIHRoaXMuX21lc2guY29weUF0dHJpYnV0ZSgwLCBnZnguQVRUUl9VVjAsIHZiRGF0YS5idWZmZXIsIHZlcnRTaXplLCB1dkVsZS5vZmZzZXQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9tZXNoLmNvcHlBdHRyaWJ1dGUoMCwgZ2Z4LkFUVFJfQ09MT1IsIHZiRGF0YS5idWZmZXIsIHZlcnRTaXplLCBjb2xvckVsZS5vZmZzZXQpKSB7ICAvLyBjb3B5IG1lc2ggY29sb3IgdG8gQVRUUl9DT0xPUjFcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZiID0gbmV3IFVpbnQzMkFycmF5KHZiRGF0YS5idWZmZXIpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl92ZXJ0Q291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZiW2kgKiB0aGlzLl92ZXJ0QXR0cnNGbG9hdENvdW50ICsgY29sb3JFbGUub2Zmc2V0IC8gNF0gPSBjYy5Db2xvci5XSElURS5fdmFsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCB2YkZsb2F0QXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KHZiRGF0YS5idWZmZXIpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRoaXMuX2NhcGFjaXR5OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZiRmxvYXRBcnJheS5jb3B5V2l0aGluKGkgKiB2ZXJ0U2l6ZSAqIHRoaXMuX3ZlcnRDb3VudCAvIDQsIDAsIHZlcnRTaXplICogdGhpcy5fdmVydENvdW50IC8gNCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX21lc2guY29weUluZGljZXMoMCwgaWJEYXRhKTtcclxuICAgICAgICAgICAgLy8gaW5kaWNlc1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRoaXMuX2NhcGFjaXR5OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5faW5kZXhDb3VudDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWJEYXRhW2kgKiB0aGlzLl9pbmRleENvdW50ICsgal0gPSBpYkRhdGFbal0gKyBpICogdGhpcy5fdmVydENvdW50O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmJEYXRhID0gbmV3IEZsb2F0MzJBcnJheSh2ZXJ0U2l6ZSAqIHRoaXMuX2NhcGFjaXR5ICogdGhpcy5fdmVydENvdW50IC8gNCk7XHJcbiAgICAgICAgICAgIGliRGF0YSA9IG5ldyBVaW50MTZBcnJheSh0aGlzLl9jYXBhY2l0eSAqIHRoaXMuX2luZGV4Q291bnQpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGRzdCA9IDA7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2FwYWNpdHk7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYmFzZUlkeCA9IDQgKiBpO1xyXG4gICAgICAgICAgICAgICAgaWJEYXRhW2RzdCsrXSA9IGJhc2VJZHg7XHJcbiAgICAgICAgICAgICAgICBpYkRhdGFbZHN0KytdID0gYmFzZUlkeCArIDE7XHJcbiAgICAgICAgICAgICAgICBpYkRhdGFbZHN0KytdID0gYmFzZUlkeCArIDI7XHJcbiAgICAgICAgICAgICAgICBpYkRhdGFbZHN0KytdID0gYmFzZUlkeCArIDM7XHJcbiAgICAgICAgICAgICAgICBpYkRhdGFbZHN0KytdID0gYmFzZUlkeCArIDI7XHJcbiAgICAgICAgICAgICAgICBpYkRhdGFbZHN0KytdID0gYmFzZUlkeCArIDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBtZXNoRGF0YSA9IG5ldyBNZXNoRGF0YSgpO1xyXG4gICAgICAgIG1lc2hEYXRhLnZEYXRhID0gdmJEYXRhO1xyXG4gICAgICAgIG1lc2hEYXRhLmlEYXRhID0gaWJEYXRhO1xyXG4gICAgICAgIG1lc2hEYXRhLnZmbSA9IHRoaXMuX3ZlcnRGb3JtYXQ7XHJcbiAgICAgICAgbWVzaERhdGEudkRpcnR5ID0gdHJ1ZTtcclxuICAgICAgICBtZXNoRGF0YS5pRGlydHkgPSB0cnVlO1xyXG4gICAgICAgIG1lc2hEYXRhLmVuYWJsZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fc3ViRGF0YXNbMF0gPSBtZXNoRGF0YTtcclxuXHJcbiAgICAgICAgaWYgKENDX0pTQiAmJiBDQ19OQVRJVkVSRU5ERVJFUikge1xyXG4gICAgICAgICAgICBtZXNoRGF0YS52RGlydHkgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCB2YiA9IG5ldyBnZnguVmVydGV4QnVmZmVyKFxyXG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuZGV2aWNlLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmVydEZvcm1hdCxcclxuICAgICAgICAgICAgICAgIGdmeC5VU0FHRV9EWU5BTUlDLFxyXG4gICAgICAgICAgICAgICAgdmJEYXRhXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBsZXQgaWIgPSBuZXcgZ2Z4LkluZGV4QnVmZmVyKFxyXG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuZGV2aWNlLFxyXG4gICAgICAgICAgICAgICAgZ2Z4LklOREVYX0ZNVF9VSU5UMTYsXHJcbiAgICAgICAgICAgICAgICBnZnguVVNBR0VfU1RBVElDLFxyXG4gICAgICAgICAgICAgICAgaWJEYXRhLFxyXG4gICAgICAgICAgICAgICAgaWJEYXRhLmxlbmd0aFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5fc3ViTWVzaGVzWzBdID0gbmV3IElucHV0QXNzZW1ibGVyKHZiLCBpYik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZVRyYWlsRGF0YSAodmZtdCwgbnVtKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3N1YkRhdGFzWzFdKSB7XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHZlcnRTaXplID0gdmZtdC5fYnl0ZXM7XHJcbiAgICAgICAgbGV0IHZCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIodmVydFNpemUgKiAobnVtICsgMSkgKiAyKTtcclxuICAgICAgICBsZXQgaWJEYXRhID0gbmV3IFVpbnQxNkFycmF5KG51bSAqIDYpO1xyXG5cclxuICAgICAgICBsZXQgbWVzaERhdGEgPSBuZXcgTWVzaERhdGEoKTtcclxuICAgICAgICBtZXNoRGF0YS52RGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkodkJ1ZmZlcik7XHJcbiAgICAgICAgbWVzaERhdGEuaURhdGEgPSBpYkRhdGE7XHJcbiAgICAgICAgbWVzaERhdGEudmZtID0gdmZtdDtcclxuICAgICAgICBtZXNoRGF0YS52RGlydHkgPSB0cnVlO1xyXG4gICAgICAgIG1lc2hEYXRhLmlEaXJ0eSA9IHRydWU7XHJcbiAgICAgICAgbWVzaERhdGEuZW5hYmxlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9zdWJEYXRhc1sxXSA9IG1lc2hEYXRhO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChDQ19KU0IgJiYgQ0NfTkFUSVZFUkVOREVSRVIpIHtcclxuICAgICAgICAgICAgbWVzaERhdGEudkRpcnR5ID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgdmIgPSBuZXcgZ2Z4LlZlcnRleEJ1ZmZlcihcclxuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmRldmljZSxcclxuICAgICAgICAgICAgICAgIHZmbXQsXHJcbiAgICAgICAgICAgICAgICBnZnguVVNBR0VfRFlOQU1JQyxcclxuICAgICAgICAgICAgICAgIHZCdWZmZXJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgbGV0IGliID0gbmV3IGdmeC5JbmRleEJ1ZmZlcihcclxuICAgICAgICAgICAgICAgIHJlbmRlcmVyLmRldmljZSxcclxuICAgICAgICAgICAgICAgIGdmeC5JTkRFWF9GTVRfVUlOVDE2LFxyXG4gICAgICAgICAgICAgICAgZ2Z4LlVTQUdFX0RZTkFNSUMsXHJcbiAgICAgICAgICAgICAgICBpYkRhdGEsXHJcbiAgICAgICAgICAgICAgICBudW0gKiA2XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9zdWJNZXNoZXNbMV0gPSBuZXcgSW5wdXRBc3NlbWJsZXIodmIsIGliKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0TW9kZWxNYXRlcmlhbCAobWF0KSB7XHJcbiAgICAgICAgdGhpcy5fbWF0ZXJpYWwgPSBtYXQ7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkUGFydGljbGVWZXJ0ZXhEYXRhIChpbmRleCwgcHZkYXRhKSB7XHJcbiAgICAgICAgbGV0IHN1YkRhdGEgPSB0aGlzLl9zdWJEYXRhc1swXTtcclxuICAgICAgICBsZXQgdkRhdGEgPSBzdWJEYXRhLmdldFZEYXRhKCk7XHJcbiAgICAgICAgbGV0IHVpbnRWRGF0YSA9IHN1YkRhdGEuZ2V0VkRhdGEoVWludDMyQXJyYXkpO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuX21lc2gpIHtcclxuICAgICAgICAgICAgbGV0IG9mZnNldCA9IGluZGV4ICogdGhpcy5fdmVydEF0dHJzRmxvYXRDb3VudDtcclxuICAgICAgICAgICAgdkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzBdLng7IC8vIHBvc2l0aW9uXHJcbiAgICAgICAgICAgIHZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVswXS55O1xyXG4gICAgICAgICAgICB2RGF0YVtvZmZzZXQrK10gPSBwdmRhdGFbMF0uejtcclxuICAgICAgICAgICAgdkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzFdLng7IC8vIHV2XHJcbiAgICAgICAgICAgIHZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVsxXS55O1xyXG4gICAgICAgICAgICB2RGF0YVtvZmZzZXQrK10gPSBwdmRhdGFbMV0uejsgLy8gZnJhbWUgaWR4XHJcbiAgICAgICAgICAgIHZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVsyXS54OyAvLyBzaXplXHJcbiAgICAgICAgICAgIHZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVsyXS55O1xyXG4gICAgICAgICAgICB2RGF0YVtvZmZzZXQrK10gPSBwdmRhdGFbMl0uejtcclxuICAgICAgICAgICAgdkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzNdLng7IC8vIHJvdGF0aW9uXHJcbiAgICAgICAgICAgIHZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVszXS55O1xyXG4gICAgICAgICAgICB2RGF0YVtvZmZzZXQrK10gPSBwdmRhdGFbM10uejtcclxuICAgICAgICAgICAgdWludFZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVs0XTsgLy8gY29sb3JcclxuICAgICAgICAgICAgaWYgKHB2ZGF0YVs1XSkge1xyXG4gICAgICAgICAgICAgICAgdkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzVdLng7IC8vIHZlbG9jaXR5XHJcbiAgICAgICAgICAgICAgICB2RGF0YVtvZmZzZXQrK10gPSBwdmRhdGFbNV0ueTtcclxuICAgICAgICAgICAgICAgIHZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVs1XS56O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl92ZXJ0Q291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IG9mZnNldCA9IChpbmRleCAqIHRoaXMuX3ZlcnRDb3VudCArIGkpICogdGhpcy5fdmVydEF0dHJzRmxvYXRDb3VudDtcclxuICAgICAgICAgICAgICAgIHZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVswXS54OyAvLyBwb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgdkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzBdLnk7XHJcbiAgICAgICAgICAgICAgICB2RGF0YVtvZmZzZXQrK10gPSBwdmRhdGFbMF0uejtcclxuICAgICAgICAgICAgICAgIG9mZnNldCArPSAyO1xyXG4gICAgICAgICAgICAgICAgdkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzFdLno7IC8vIGZyYW1lIGlkeFxyXG4gICAgICAgICAgICAgICAgdkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzJdLng7IC8vIHNpemVcclxuICAgICAgICAgICAgICAgIHZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVsyXS55O1xyXG4gICAgICAgICAgICAgICAgdkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzJdLno7XHJcbiAgICAgICAgICAgICAgICB2RGF0YVtvZmZzZXQrK10gPSBwdmRhdGFbM10ueDsgLy8gcm90YXRpb25cclxuICAgICAgICAgICAgICAgIHZEYXRhW29mZnNldCsrXSA9IHB2ZGF0YVszXS55O1xyXG4gICAgICAgICAgICAgICAgdkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzNdLno7XHJcbiAgICAgICAgICAgICAgICB1aW50VkRhdGFbb2Zmc2V0KytdID0gcHZkYXRhWzRdOyAvLyBjb2xvclxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF91cGxvYWREYXRhICgpIHtcclxuICAgICAgICBsZXQgc3ViRGF0YXMgPSB0aGlzLl9zdWJEYXRhcztcclxuICAgICAgICBsZXQgc3ViTWVzaGVzID0gdGhpcy5fc3ViTWVzaGVzO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBzdWJEYXRhcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgc3ViRGF0YSA9IHN1YkRhdGFzW2ldO1xyXG4gICAgICAgICAgICBsZXQgc3ViTWVzaCA9IHN1Yk1lc2hlc1tpXTtcclxuICAgICAgICAgICAgaWYgKHN1YkRhdGEudkRpcnR5KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdkJ1ZmZlciA9IHN1Yk1lc2guX3ZlcnRleEJ1ZmZlciwgdkRhdGEgPSBzdWJEYXRhLnZEYXRhO1xyXG4gICAgICAgICAgICAgICAgdkJ1ZmZlci51cGRhdGUoMCwgdkRhdGEpO1xyXG4gICAgICAgICAgICAgICAgc3ViRGF0YS52RGlydHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHN1YkRhdGEuaURpcnR5KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaUJ1ZmZlciA9IHN1Yk1lc2guX2luZGV4QnVmZmVyLCBpRGF0YSA9IHN1YkRhdGEuaURhdGE7XHJcbiAgICAgICAgICAgICAgICBpQnVmZmVyLnVwZGF0ZSgwLCBpRGF0YSk7XHJcbiAgICAgICAgICAgICAgICBzdWJEYXRhLmlEaXJ0eSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUlBIChpbmRleCwgY291bnQsIHZEaXJ0eSwgaURpcnR5KSB7XHJcbiAgICAgICAgaWYgKENDX0pTQiAmJiBDQ19OQVRJVkVSRU5ERVJFUikgcmV0dXJuXHJcblxyXG4gICAgICAgIHRoaXMuX3N1Yk1lc2hlc1tpbmRleF0uX2NvdW50ID0gY291bnQ7XHJcblxyXG4gICAgICAgIGxldCBzdWJEYXRhID0gdGhpcy5fc3ViRGF0YXNbaW5kZXhdO1xyXG4gICAgICAgIHN1YkRhdGEudkRpcnR5ID0gdkRpcnR5O1xyXG4gICAgICAgIHN1YkRhdGEuaURpcnR5ID0gaURpcnR5O1xyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyICgpIHtcclxuICAgICAgICBsZXQgc3ViTWVzaCA9IHRoaXMuX3N1Yk1lc2hlc1swXTtcclxuICAgICAgICBpZiAoc3ViTWVzaCkge1xyXG4gICAgICAgICAgICBzdWJNZXNoLmluZGV4Q291bnQgPSAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95ICgpIHtcclxuICAgICAgICB0aGlzLl9zdWJEYXRhcy5sZW5ndGggPSAwO1xyXG5cclxuICAgICAgICBsZXQgc3ViTWVzaGVzID0gdGhpcy5fc3ViTWVzaGVzO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBzdWJNZXNoZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IHZiID0gc3ViTWVzaGVzW2ldLl92ZXJ0ZXhCdWZmZXI7XHJcbiAgICAgICAgICAgIGlmICh2Yikge1xyXG4gICAgICAgICAgICAgICAgdmIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsZXQgaWIgPSBzdWJNZXNoZXNbaV0uX2luZGV4QnVmZmVyO1xyXG4gICAgICAgICAgICBpZiAoaWIpIHtcclxuICAgICAgICAgICAgICAgIGliLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBzdWJNZXNoZXMubGVuZ3RoID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95SUFEYXRhICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fc3ViTWVzaGVzWzBdKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Yk1lc2hlc1swXS5fdmVydGV4QnVmZmVyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgdGhpcy5fc3ViTWVzaGVzWzBdLl9pbmRleEJ1ZmZlci5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Yk1lc2hlc1swXSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9zdWJEYXRhc1swXSA9IG51bGw7XHJcbiAgICB9XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIvIn0=