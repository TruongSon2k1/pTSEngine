
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/renderer/utils/label/letter-font.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

exports.__esModule = true;
exports["default"] = void 0;

var _bmfont = _interopRequireDefault(require("../../webgl/assemblers/label/2d/bmfont"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var Label = require('../../../components/CCLabel');

var LabelOutline = require('../../../components/CCLabelOutline');

var textUtils = require('../../../utils/text-utils');

var Component = require('../../../components/CCComponent');

var RenderTexture = require('../../../assets/CCRenderTexture');

var OUTLINE_SUPPORTED = cc.js.isChildClassOf(LabelOutline, Component);

var getFontFamily = require('../utils').getFontFamily;

var shareLabelInfo = require('../utils').shareLabelInfo;

var FontLetterDefinition = cc.BitmapFont.FontLetterDefinition;
var FontAtlas = cc.BitmapFont.FontAtlas;
var WHITE = cc.Color.WHITE;
var space = 0;
var bleed = 2;

var _invisibleAlpha = (1 / 255).toFixed(3);

function LetterTexture(_char, labelInfo) {
  this._texture = null;
  this._labelInfo = labelInfo;
  this._char = _char;
  this._hash = null;
  this._data = null;
  this._canvas = null;
  this._context = null;
  this._width = 0;
  this._height = 0;
  this._offsetY = 0;
  this._hash = _char.charCodeAt(0) + labelInfo.hash;
}

LetterTexture.prototype = {
  constructor: LetterTexture,
  updateRenderData: function updateRenderData() {
    this._updateProperties();

    this._updateTexture();
  },
  _updateProperties: function _updateProperties() {
    this._texture = new cc.Texture2D();
    this._data = Label._canvasPool.get();
    this._canvas = this._data.canvas;
    this._context = this._data.context;
    this._context.font = this._labelInfo.fontDesc;
    var width = textUtils.safeMeasureText(this._context, this._char, this._labelInfo.fontDesc);
    var blank = this._labelInfo.margin * 2 + bleed;
    this._width = parseFloat(width.toFixed(2)) + blank;
    this._height = (1 + textUtils.BASELINE_RATIO) * this._labelInfo.fontSize + blank;
    this._offsetY = -(this._labelInfo.fontSize * textUtils.BASELINE_RATIO) / 2;

    if (this._canvas.width !== this._width) {
      this._canvas.width = this._width;
    }

    if (this._canvas.height !== this._height) {
      this._canvas.height = this._height;
    }

    this._texture.initWithElement(this._canvas);
  },
  _updateTexture: function _updateTexture() {
    var context = this._context;
    var labelInfo = this._labelInfo,
        width = this._canvas.width,
        height = this._canvas.height;
    var fontSize = this._labelInfo.fontSize;
    var startX = width / 2;
    var startY = height / 2 + fontSize * textUtils.MIDDLE_RATIO + fontSize * textUtils.BASELINE_OFFSET;
    var color = labelInfo.color; // use round for line join to avoid sharp intersect point

    context.lineJoin = 'round';
    context.textAlign = 'center';
    context.clearRect(0, 0, width, height); //Add a white background to avoid black edges.

    context.fillStyle = "rgba(" + color.r + ", " + color.g + ", " + color.b + ", " + _invisibleAlpha + ")";
    context.fillRect(0, 0, width, height);
    context.font = labelInfo.fontDesc;
    context.fillStyle = "rgba(" + color.r + ", " + color.g + ", " + color.b + ", 1)";

    if (labelInfo.isOutlined && labelInfo.margin > 0) {
      var strokeColor = labelInfo.out || WHITE;
      context.strokeStyle = "rgba(" + strokeColor.r + ", " + strokeColor.g + ", " + strokeColor.b + ", " + strokeColor.a / 255 + ")";
      context.lineWidth = labelInfo.margin * 2;
      context.strokeText(this._char, startX, startY);
    }

    context.fillText(this._char, startX, startY);

    this._texture.handleLoadedTexture();
  },
  destroy: function destroy() {
    this._texture.destroy();

    this._texture = null;

    Label._canvasPool.put(this._data);
  }
};

function LetterAtlas(width, height) {
  var texture = new RenderTexture();
  texture.initWithSize(width, height);
  texture.update();
  this._fontDefDictionary = new FontAtlas(texture);
  this._x = space;
  this._y = space;
  this._nexty = space;
  this._width = width;
  this._height = height;
  cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, this.beforeSceneLoad, this);
}

cc.js.mixin(LetterAtlas.prototype, {
  insertLetterTexture: function insertLetterTexture(letterTexture) {
    var texture = letterTexture._texture;
    var width = texture.width,
        height = texture.height;

    if (this._x + width + space > this._width) {
      this._x = space;
      this._y = this._nexty;
    }

    if (this._y + height > this._nexty) {
      this._nexty = this._y + height + space;
    }

    if (this._nexty > this._height) {
      return null;
    }

    this._fontDefDictionary._texture.drawTextureAt(texture, this._x, this._y);

    this._dirty = true;
    var letter = new FontLetterDefinition();
    letter.u = this._x + bleed / 2;
    letter.v = this._y + bleed / 2;
    letter.texture = this._fontDefDictionary._texture;
    letter.valid = true;
    letter.w = letterTexture._width - bleed;
    letter.h = letterTexture._height - bleed;
    letter.xAdvance = letter.w;
    letter.offsetY = letterTexture._offsetY;
    this._x += width + space;

    this._fontDefDictionary.addLetterDefinitions(letterTexture._hash, letter);

    return letter;
  },
  update: function update() {
    if (!this._dirty) return;

    this._fontDefDictionary._texture.update();

    this._dirty = false;
  },
  reset: function reset() {
    this._x = space;
    this._y = space;
    this._nexty = space;
    var chars = this._fontDefDictionary._letterDefinitions;

    for (var i = 0, l = chars.length; i < l; i++) {
      var _char2 = chars[i];

      if (!_char2.isValid) {
        continue;
      }

      _char2.destroy();
    }

    this._fontDefDictionary.clear();
  },
  destroy: function destroy() {
    this.reset();

    this._fontDefDictionary._texture.destroy();

    this._fontDefDictionary._texture = null;
  },
  beforeSceneLoad: function beforeSceneLoad() {
    this.clearAllCache();
  },
  clearAllCache: function clearAllCache() {
    this.destroy();
    var texture = new RenderTexture();
    texture.initWithSize(this._width, this._height);
    texture.update();
    this._fontDefDictionary._texture = texture;
  },
  getLetter: function getLetter(key) {
    return this._fontDefDictionary._letterDefinitions[key];
  },
  getTexture: function getTexture() {
    return this._fontDefDictionary.getTexture();
  },
  getLetterDefinitionForChar: function getLetterDefinitionForChar(_char3, labelInfo) {
    var hash = _char3.charCodeAt(0) + labelInfo.hash;
    var letter = this._fontDefDictionary._letterDefinitions[hash];

    if (!letter) {
      var temp = new LetterTexture(_char3, labelInfo);
      temp.updateRenderData();
      letter = this.insertLetterTexture(temp);
      temp.destroy();
    }

    return letter;
  }
});

function computeHash(labelInfo) {
  var hashData = '';
  var color = labelInfo.color.toHEX();
  var out = '';

  if (labelInfo.isOutlined && labelInfo.margin > 0) {
    out = out + labelInfo.margin + labelInfo.out.toHEX();
  }

  return hashData + labelInfo.fontSize + labelInfo.fontFamily + color + out;
}

var _shareAtlas = null;
var _atlasWidth = 2048;
var _atlasHeight = 2048;
var _isBold = false;

var LetterFontAssembler = /*#__PURE__*/function (_WebglBmfontAssembler) {
  _inheritsLoose(LetterFontAssembler, _WebglBmfontAssembler);

  function LetterFontAssembler() {
    return _WebglBmfontAssembler.apply(this, arguments) || this;
  }

  var _proto = LetterFontAssembler.prototype;

  _proto._getAssemblerData = function _getAssemblerData() {
    if (!_shareAtlas) {
      _shareAtlas = new LetterAtlas(_atlasWidth, _atlasHeight);
      cc.Label._shareAtlas = _shareAtlas;
    }

    return _shareAtlas.getTexture();
  };

  _proto._updateFontFamily = function _updateFontFamily(comp) {
    shareLabelInfo.fontAtlas = _shareAtlas;
    shareLabelInfo.fontFamily = getFontFamily(comp); // outline

    var outline = OUTLINE_SUPPORTED && comp.getComponent(LabelOutline);

    if (outline && outline.enabled) {
      shareLabelInfo.isOutlined = true;
      shareLabelInfo.margin = outline.width;
      shareLabelInfo.out = outline.color.clone();
      shareLabelInfo.out.a = outline.color.a * comp.node.color.a / 255.0;
    } else {
      shareLabelInfo.isOutlined = false;
      shareLabelInfo.margin = 0;
    }
  };

  _proto._updateLabelInfo = function _updateLabelInfo(comp) {
    shareLabelInfo.fontDesc = this._getFontDesc();
    shareLabelInfo.color = comp.node.color;
    shareLabelInfo.hash = computeHash(shareLabelInfo);
  };

  _proto._getFontDesc = function _getFontDesc() {
    var fontDesc = shareLabelInfo.fontSize.toString() + 'px ';
    fontDesc = fontDesc + shareLabelInfo.fontFamily;

    if (_isBold) {
      fontDesc = "bold " + fontDesc;
    }

    return fontDesc;
  };

  _proto._computeHorizontalKerningForText = function _computeHorizontalKerningForText() {};

  _proto._determineRect = function _determineRect(tempRect) {
    return false;
  };

  return LetterFontAssembler;
}(_bmfont["default"]);

exports["default"] = LetterFontAssembler;
module.exports = exports["default"];
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuZ2luZS1kZXZcXGNvY29zMmRcXGNvcmVcXHJlbmRlcmVyXFx1dGlsc1xcbGFiZWxcXGxldHRlci1mb250LmpzIl0sIm5hbWVzIjpbIkxhYmVsIiwicmVxdWlyZSIsIkxhYmVsT3V0bGluZSIsInRleHRVdGlscyIsIkNvbXBvbmVudCIsIlJlbmRlclRleHR1cmUiLCJPVVRMSU5FX1NVUFBPUlRFRCIsImNjIiwianMiLCJpc0NoaWxkQ2xhc3NPZiIsImdldEZvbnRGYW1pbHkiLCJzaGFyZUxhYmVsSW5mbyIsIkZvbnRMZXR0ZXJEZWZpbml0aW9uIiwiQml0bWFwRm9udCIsIkZvbnRBdGxhcyIsIldISVRFIiwiQ29sb3IiLCJzcGFjZSIsImJsZWVkIiwiX2ludmlzaWJsZUFscGhhIiwidG9GaXhlZCIsIkxldHRlclRleHR1cmUiLCJjaGFyIiwibGFiZWxJbmZvIiwiX3RleHR1cmUiLCJfbGFiZWxJbmZvIiwiX2NoYXIiLCJfaGFzaCIsIl9kYXRhIiwiX2NhbnZhcyIsIl9jb250ZXh0IiwiX3dpZHRoIiwiX2hlaWdodCIsIl9vZmZzZXRZIiwiY2hhckNvZGVBdCIsImhhc2giLCJwcm90b3R5cGUiLCJjb25zdHJ1Y3RvciIsInVwZGF0ZVJlbmRlckRhdGEiLCJfdXBkYXRlUHJvcGVydGllcyIsIl91cGRhdGVUZXh0dXJlIiwiVGV4dHVyZTJEIiwiX2NhbnZhc1Bvb2wiLCJnZXQiLCJjYW52YXMiLCJjb250ZXh0IiwiZm9udCIsImZvbnREZXNjIiwid2lkdGgiLCJzYWZlTWVhc3VyZVRleHQiLCJibGFuayIsIm1hcmdpbiIsInBhcnNlRmxvYXQiLCJCQVNFTElORV9SQVRJTyIsImZvbnRTaXplIiwiaGVpZ2h0IiwiaW5pdFdpdGhFbGVtZW50Iiwic3RhcnRYIiwic3RhcnRZIiwiTUlERExFX1JBVElPIiwiQkFTRUxJTkVfT0ZGU0VUIiwiY29sb3IiLCJsaW5lSm9pbiIsInRleHRBbGlnbiIsImNsZWFyUmVjdCIsImZpbGxTdHlsZSIsInIiLCJnIiwiYiIsImZpbGxSZWN0IiwiaXNPdXRsaW5lZCIsInN0cm9rZUNvbG9yIiwib3V0Iiwic3Ryb2tlU3R5bGUiLCJhIiwibGluZVdpZHRoIiwic3Ryb2tlVGV4dCIsImZpbGxUZXh0IiwiaGFuZGxlTG9hZGVkVGV4dHVyZSIsImRlc3Ryb3kiLCJwdXQiLCJMZXR0ZXJBdGxhcyIsInRleHR1cmUiLCJpbml0V2l0aFNpemUiLCJ1cGRhdGUiLCJfZm9udERlZkRpY3Rpb25hcnkiLCJfeCIsIl95IiwiX25leHR5IiwiZGlyZWN0b3IiLCJvbiIsIkRpcmVjdG9yIiwiRVZFTlRfQkVGT1JFX1NDRU5FX0xBVU5DSCIsImJlZm9yZVNjZW5lTG9hZCIsIm1peGluIiwiaW5zZXJ0TGV0dGVyVGV4dHVyZSIsImxldHRlclRleHR1cmUiLCJkcmF3VGV4dHVyZUF0IiwiX2RpcnR5IiwibGV0dGVyIiwidSIsInYiLCJ2YWxpZCIsInciLCJoIiwieEFkdmFuY2UiLCJvZmZzZXRZIiwiYWRkTGV0dGVyRGVmaW5pdGlvbnMiLCJyZXNldCIsImNoYXJzIiwiX2xldHRlckRlZmluaXRpb25zIiwiaSIsImwiLCJsZW5ndGgiLCJpc1ZhbGlkIiwiY2xlYXIiLCJjbGVhckFsbENhY2hlIiwiZ2V0TGV0dGVyIiwia2V5IiwiZ2V0VGV4dHVyZSIsImdldExldHRlckRlZmluaXRpb25Gb3JDaGFyIiwidGVtcCIsImNvbXB1dGVIYXNoIiwiaGFzaERhdGEiLCJ0b0hFWCIsImZvbnRGYW1pbHkiLCJfc2hhcmVBdGxhcyIsIl9hdGxhc1dpZHRoIiwiX2F0bGFzSGVpZ2h0IiwiX2lzQm9sZCIsIkxldHRlckZvbnRBc3NlbWJsZXIiLCJfZ2V0QXNzZW1ibGVyRGF0YSIsIl91cGRhdGVGb250RmFtaWx5IiwiY29tcCIsImZvbnRBdGxhcyIsIm91dGxpbmUiLCJnZXRDb21wb25lbnQiLCJlbmFibGVkIiwiY2xvbmUiLCJub2RlIiwiX3VwZGF0ZUxhYmVsSW5mbyIsIl9nZXRGb250RGVzYyIsInRvU3RyaW5nIiwiX2NvbXB1dGVIb3Jpem9udGFsS2VybmluZ0Zv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QSwwQkFBa0JQLElBQWxCLEVBQXdCO0FBQ3BCMUgsSUFBQUEsY0FBYyxDQUFDb0MsUUFBZixHQUEwQixLQUFLOEYsWUFBTCxFQUExQjtBQUNBbEksSUFBQUEsY0FBYyxDQUFDa0QsS0FBZixHQUF1QndFLElBQUksQ0FBQ00sSUFBTCxDQUFVOUUsS0FBakM7QUFDQWxELElBQUFBLGNBQWMsQ0FBQ3dCLElBQWYsR0FBc0J1RixXQUFXLENBQUMvRyxjQUFELENBQWpDO0FBQ0g7O1NBRURrSSxlQUFBLHdCQUFnQjtBQUNaLFFBQUk5RixRQUFRLEdBQUdwQyxjQUFjLENBQUMyQyxRQUFmLENBQXdCd0YsUUFBeEIsS0FBcUMsS0FBcEQ7QUFDQS9GLElBQUFBLFFBQVEsR0FBR0EsUUFBUSxHQUFHcEMsY0FBYyxDQUFDa0gsVUFBckM7O0FBQ0EsUUFBSUksT0FBSixFQUFhO0FBQ1RsRixNQUFBQSxRQUFRLEdBQUcsVUFBVUEsUUFBckI7QUFDSDs7QUFFRCxXQUFPQSxRQUFQO0FBQ0g7O1NBQ0RnRyxtQ0FBQSw0Q0FBb0MsQ0FBRTs7U0FDdENDLGlCQUFBLHdCQUFnQkMsUUFBaEIsRUFBMEI7QUFDdEIsV0FBTyxLQUFQO0FBQ0g7OztFQTlDNENDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuIENvcHlyaWdodCAoYykgMjAxOCBYaWFtZW4gWWFqaSBTb2Z0d2FyZSBDby4sIEx0ZC5cclxuXHJcbiBodHRwczovL3d3dy5jb2Nvcy5jb20vXHJcblxyXG4gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxyXG4gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBlbmdpbmUgc291cmNlIGNvZGUgKHRoZSBcIlNvZnR3YXJlXCIpLCBhIGxpbWl0ZWQsXHJcbiB3b3JsZHdpZGUsIHJveWFsdHktZnJlZSwgbm9uLWFzc2lnbmFibGUsIHJldm9jYWJsZSBhbmQgbm9uLWV4Y2x1c2l2ZSBsaWNlbnNlXHJcbiB0byB1c2UgQ29jb3MgQ3JlYXRvciBzb2xlbHkgdG8gZGV2ZWxvcCBnYW1lcyBvbiB5b3VyIHRhcmdldCBwbGF0Zm9ybXMuIFlvdSBzaGFsbFxyXG4gbm90IHVzZSBDb2NvcyBDcmVhdG9yIHNvZnR3YXJlIGZvciBkZXZlbG9waW5nIG90aGVyIHNvZnR3YXJlIG9yIHRvb2xzIHRoYXQnc1xyXG4gdXNlZCBmb3IgZGV2ZWxvcGluZyBnYW1lcy4gWW91IGFyZSBub3QgZ3JhbnRlZCB0byBwdWJsaXNoLCBkaXN0cmlidXRlLFxyXG4gc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIENvY29zIENyZWF0b3IuXHJcblxyXG4gVGhlIHNvZnR3YXJlIG9yIHRvb2xzIGluIHRoaXMgTGljZW5zZSBBZ3JlZW1lbnQgYXJlIGxpY2Vuc2VkLCBub3Qgc29sZC5cclxuIFhpYW1lbiBZYWppIFNvZnR3YXJlIENvLiwgTHRkLiByZXNlcnZlcyBhbGwgcmlnaHRzIG5vdCBleHByZXNzbHkgZ3JhbnRlZCB0byB5b3UuXHJcblxyXG4gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbiBUSEUgU09GVFdBUkUuXHJcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG5cclxuaW1wb3J0IFdlYmdsQm1mb250QXNzZW1ibGVyIGZyb20gJy4uLy4uL3dlYmdsL2Fzc2VtYmxlcnMvbGFiZWwvMmQvYm1mb250JztcclxuXHJcbmNvbnN0IExhYmVsID0gcmVxdWlyZSgnLi4vLi4vLi4vY29tcG9uZW50cy9DQ0xhYmVsJyk7XHJcbmNvbnN0IExhYmVsT3V0bGluZSA9IHJlcXVpcmUoJy4uLy4uLy4uL2NvbXBvbmVudHMvQ0NMYWJlbE91dGxpbmUnKTtcclxuY29uc3QgdGV4dFV0aWxzID0gcmVxdWlyZSgnLi4vLi4vLi4vdXRpbHMvdGV4dC11dGlscycpO1xyXG5jb25zdCBDb21wb25lbnQgPSByZXF1aXJlKCcuLi8uLi8uLi9jb21wb25lbnRzL0NDQ29tcG9uZW50Jyk7XHJcbmNvbnN0IFJlbmRlclRleHR1cmUgPSByZXF1aXJlKCcuLi8uLi8uLi9hc3NldHMvQ0NSZW5kZXJUZXh0dXJlJyk7XHJcbmNvbnN0IE9VVExJTkVfU1VQUE9SVEVEID0gY2MuanMuaXNDaGlsZENsYXNzT2YoTGFiZWxPdXRsaW5lLCBDb21wb25lbnQpO1xyXG5jb25zdCBnZXRGb250RmFtaWx5ID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5nZXRGb250RmFtaWx5O1xyXG5jb25zdCBzaGFyZUxhYmVsSW5mbyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuc2hhcmVMYWJlbEluZm87XHJcblxyXG5cclxuY29uc3QgRm9udExldHRlckRlZmluaXRpb24gPSBjYy5CaXRtYXBGb250LkZvbnRMZXR0ZXJEZWZpbml0aW9uO1xyXG5jb25zdCBGb250QXRsYXMgPSBjYy5CaXRtYXBGb250LkZvbnRBdGxhcztcclxuXHJcbmNvbnN0IFdISVRFID0gY2MuQ29sb3IuV0hJVEU7XHJcbmNvbnN0IHNwYWNlID0gMDtcclxuY29uc3QgYmxlZWQgPSAyO1xyXG5jb25zdCBfaW52aXNpYmxlQWxwaGEgPSAoMSAvIDI1NSkudG9GaXhlZCgzKTtcclxuXHJcbmZ1bmN0aW9uIExldHRlclRleHR1cmUoY2hhciwgbGFiZWxJbmZvKSB7XHJcbiAgICB0aGlzLl90ZXh0dXJlID0gbnVsbDtcclxuICAgIHRoaXMuX2xhYmVsSW5mbyA9IGxhYmVsSW5mbztcclxuICAgIHRoaXMuX2NoYXIgPSBjaGFyO1xyXG4gICAgdGhpcy5faGFzaCA9IG51bGw7XHJcbiAgICB0aGlzLl9kYXRhID0gbnVsbDtcclxuICAgIHRoaXMuX2NhbnZhcyA9IG51bGw7XHJcbiAgICB0aGlzLl9jb250ZXh0ID0gbnVsbDtcclxuICAgIHRoaXMuX3dpZHRoID0gMDtcclxuICAgIHRoaXMuX2hlaWdodCA9IDA7XHJcbiAgICB0aGlzLl9vZmZzZXRZID0gMDtcclxuICAgIHRoaXMuX2hhc2ggPSBjaGFyLmNoYXJDb2RlQXQoMCkgKyBsYWJlbEluZm8uaGFzaDtcclxufVxyXG5cclxuTGV0dGVyVGV4dHVyZS5wcm90b3R5cGUgPSB7XHJcbiAgICBjb25zdHJ1Y3RvcjogTGV0dGVyVGV4dHVyZSxcclxuXHJcbiAgICB1cGRhdGVSZW5kZXJEYXRhICgpIHtcclxuICAgICAgICB0aGlzLl91cGRhdGVQcm9wZXJ0aWVzKCk7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVGV4dHVyZSgpO1xyXG4gICAgfSxcclxuICAgIF91cGRhdGVQcm9wZXJ0aWVzICgpIHtcclxuICAgICAgICB0aGlzLl90ZXh0dXJlID0gbmV3IGNjLlRleHR1cmUyRCgpO1xyXG4gICAgICAgIHRoaXMuX2RhdGEgPSBMYWJlbC5fY2FudmFzUG9vbC5nZXQoKTtcclxuICAgICAgICB0aGlzLl9jYW52YXMgPSB0aGlzLl9kYXRhLmNhbnZhcztcclxuICAgICAgICB0aGlzLl9jb250ZXh0ID0gdGhpcy5fZGF0YS5jb250ZXh0O1xyXG4gICAgICAgIHRoaXMuX2NvbnRleHQuZm9udCA9IHRoaXMuX2xhYmVsSW5mby5mb250RGVzYztcclxuICAgICAgICBsZXQgd2lkdGggPSB0ZXh0VXRpbHMuc2FmZU1lYXN1cmVUZXh0KHRoaXMuX2NvbnRleHQsIHRoaXMuX2NoYXIsIHRoaXMuX2xhYmVsSW5mby5mb250RGVzYyk7XHJcbiAgICAgICAgbGV0IGJsYW5rID0gdGhpcy5fbGFiZWxJbmZvLm1hcmdpbiAqIDIgKyBibGVlZDtcclxuICAgICAgICB0aGlzLl93aWR0aCA9IHBhcnNlRmxvYXQod2lkdGgudG9GaXhlZCgyKSkgKyBibGFuaztcclxuICAgICAgICB0aGlzLl9oZWlnaHQgPSAoMSArIHRleHRVdGlscy5CQVNFTElORV9SQVRJTykgKiB0aGlzLl9sYWJlbEluZm8uZm9udFNpemUgKyBibGFuaztcclxuICAgICAgICB0aGlzLl9vZmZzZXRZID0gLSAodGhpcy5fbGFiZWxJbmZvLmZvbnRTaXplICogdGV4dFV0aWxzLkJBU0VMSU5FX1JBVElPKSAvIDI7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9jYW52YXMud2lkdGggIT09IHRoaXMuX3dpZHRoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhbnZhcy53aWR0aCA9IHRoaXMuX3dpZHRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2NhbnZhcy5oZWlnaHQgIT09IHRoaXMuX2hlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jYW52YXMuaGVpZ2h0ID0gdGhpcy5faGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fdGV4dHVyZS5pbml0V2l0aEVsZW1lbnQodGhpcy5fY2FudmFzKTtcclxuICAgIH0sXHJcbiAgICBfdXBkYXRlVGV4dHVyZSAoKSB7XHJcbiAgICAgICAgbGV0IGNvbnRleHQgPSB0aGlzLl9jb250ZXh0O1xyXG4gICAgICAgIGxldCBsYWJlbEluZm8gPSB0aGlzLl9sYWJlbEluZm8sXHJcbiAgICAgICAgICAgIHdpZHRoID0gdGhpcy5fY2FudmFzLndpZHRoLFxyXG4gICAgICAgICAgICBoZWlnaHQgPSB0aGlzLl9jYW52YXMuaGVpZ2h0O1xyXG5cclxuICAgICAgICBjb25zdCBmb250U2l6ZSA9IHRoaXMuX2xhYmVsSW5mby5mb250U2l6ZTtcclxuICAgICAgICBsZXQgc3RhcnRYID0gd2lkdGggLyAyO1xyXG4gICAgICAgIGxldCBzdGFydFkgPSBoZWlnaHQgLyAyICsgIGZvbnRTaXplICogdGV4dFV0aWxzLk1JRERMRV9SQVRJTyArIGZvbnRTaXplICogdGV4dFV0aWxzLkJBU0VMSU5FX09GRlNFVDtcclxuICAgICAgICBsZXQgY29sb3IgPSBsYWJlbEluZm8uY29sb3I7XHJcblxyXG4gICAgICAgIC8vIHVzZSByb3VuZCBmb3IgbGluZSBqb2luIHRvIGF2b2lkIHNoYXJwIGludGVyc2VjdCBwb2ludFxyXG4gICAgICAgIGNvbnRleHQubGluZUpvaW4gPSAncm91bmQnO1xyXG4gICAgICAgIGNvbnRleHQudGV4dEFsaWduID0gJ2NlbnRlcic7XHJcbiAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgLy9BZGQgYSB3aGl0ZSBiYWNrZ3JvdW5kIHRvIGF2b2lkIGJsYWNrIGVkZ2VzLlxyXG4gICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gYHJnYmEoJHtjb2xvci5yfSwgJHtjb2xvci5nfSwgJHtjb2xvci5ifSwgJHtfaW52aXNpYmxlQWxwaGF9KWA7XHJcbiAgICAgICAgY29udGV4dC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICBjb250ZXh0LmZvbnQgPSBsYWJlbEluZm8uZm9udERlc2M7XHJcblxyXG4gICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gYHJnYmEoJHtjb2xvci5yfSwgJHtjb2xvci5nfSwgJHtjb2xvci5ifSwgMSlgO1xyXG4gICAgICAgIGlmIChsYWJlbEluZm8uaXNPdXRsaW5lZCAmJiBsYWJlbEluZm8ubWFyZ2luID4gMCkge1xyXG4gICAgICAgICAgICBsZXQgc3Ryb2tlQ29sb3IgPSBsYWJlbEluZm8ub3V0IHx8IFdISVRFO1xyXG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gYHJnYmEoJHtzdHJva2VDb2xvci5yfSwgJHtzdHJva2VDb2xvci5nfSwgJHtzdHJva2VDb2xvci5ifSwgJHtzdHJva2VDb2xvci5hIC8gMjU1fSlgO1xyXG4gICAgICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IGxhYmVsSW5mby5tYXJnaW4gKiAyO1xyXG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZVRleHQodGhpcy5fY2hhciwgc3RhcnRYLCBzdGFydFkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMuX2NoYXIsIHN0YXJ0WCwgc3RhcnRZKTtcclxuXHJcbiAgICAgICAgdGhpcy5fdGV4dHVyZS5oYW5kbGVMb2FkZWRUZXh0dXJlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGRlc3Ryb3kgKCkge1xyXG4gICAgICAgIHRoaXMuX3RleHR1cmUuZGVzdHJveSgpO1xyXG4gICAgICAgIHRoaXMuX3RleHR1cmUgPSBudWxsO1xyXG4gICAgICAgIExhYmVsLl9jYW52YXNQb29sLnB1dCh0aGlzLl9kYXRhKTtcclxuICAgIH0sXHJcbn1cclxuXHJcbmZ1bmN0aW9uIExldHRlckF0bGFzICh3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICBsZXQgdGV4dHVyZSA9IG5ldyBSZW5kZXJUZXh0dXJlKCk7XHJcbiAgICB0ZXh0dXJlLmluaXRXaXRoU2l6ZSh3aWR0aCwgaGVpZ2h0KTtcclxuICAgIHRleHR1cmUudXBkYXRlKCk7XHJcblxyXG4gICAgdGhpcy5fZm9udERlZkRpY3Rpb25hcnkgPSBuZXcgRm9udEF0bGFzKHRleHR1cmUpO1xyXG4gICAgXHJcbiAgICB0aGlzLl94ID0gc3BhY2U7XHJcbiAgICB0aGlzLl95ID0gc3BhY2U7XHJcbiAgICB0aGlzLl9uZXh0eSA9IHNwYWNlO1xyXG5cclxuICAgIHRoaXMuX3dpZHRoID0gd2lkdGg7XHJcbiAgICB0aGlzLl9oZWlnaHQgPSBoZWlnaHQ7XHJcblxyXG4gICAgY2MuZGlyZWN0b3Iub24oY2MuRGlyZWN0b3IuRVZFTlRfQkVGT1JFX1NDRU5FX0xBVU5DSCwgdGhpcy5iZWZvcmVTY2VuZUxvYWQsIHRoaXMpO1xyXG59XHJcblxyXG5jYy5qcy5taXhpbihMZXR0ZXJBdGxhcy5wcm90b3R5cGUsIHtcclxuICAgIGluc2VydExldHRlclRleHR1cmUgKGxldHRlclRleHR1cmUpIHtcclxuICAgICAgICBsZXQgdGV4dHVyZSA9IGxldHRlclRleHR1cmUuX3RleHR1cmU7XHJcbiAgICAgICAgbGV0IHdpZHRoID0gdGV4dHVyZS53aWR0aCwgaGVpZ2h0ID0gdGV4dHVyZS5oZWlnaHQ7ICAgICAgICBcclxuXHJcbiAgICAgICAgaWYgKCh0aGlzLl94ICsgd2lkdGggKyBzcGFjZSkgPiB0aGlzLl93aWR0aCkge1xyXG4gICAgICAgICAgICB0aGlzLl94ID0gc3BhY2U7XHJcbiAgICAgICAgICAgIHRoaXMuX3kgPSB0aGlzLl9uZXh0eTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgodGhpcy5feSArIGhlaWdodCkgPiB0aGlzLl9uZXh0eSkge1xyXG4gICAgICAgICAgICB0aGlzLl9uZXh0eSA9IHRoaXMuX3kgKyBoZWlnaHQgKyBzcGFjZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9uZXh0eSA+IHRoaXMuX2hlaWdodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5Ll90ZXh0dXJlLmRyYXdUZXh0dXJlQXQodGV4dHVyZSwgdGhpcy5feCwgdGhpcy5feSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2RpcnR5ID0gdHJ1ZTtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgbGV0dGVyID0gbmV3IEZvbnRMZXR0ZXJEZWZpbml0aW9uKCk7XHJcbiAgICAgICAgbGV0dGVyLnUgPSB0aGlzLl94ICsgYmxlZWQvMjtcclxuICAgICAgICBsZXR0ZXIudiA9IHRoaXMuX3kgKyBibGVlZC8yO1xyXG4gICAgICAgIGxldHRlci50ZXh0dXJlID0gdGhpcy5fZm9udERlZkRpY3Rpb25hcnkuX3RleHR1cmU7XHJcbiAgICAgICAgbGV0dGVyLnZhbGlkID0gdHJ1ZTtcclxuICAgICAgICBsZXR0ZXIudyA9IGxldHRlclRleHR1cmUuX3dpZHRoIC0gYmxlZWQ7XHJcbiAgICAgICAgbGV0dGVyLmggPSBsZXR0ZXJUZXh0dXJlLl9oZWlnaHQgLSBibGVlZDtcclxuICAgICAgICBsZXR0ZXIueEFkdmFuY2UgPSBsZXR0ZXIudztcclxuICAgICAgICBsZXR0ZXIub2Zmc2V0WSA9IGxldHRlclRleHR1cmUuX29mZnNldFk7XHJcblxyXG4gICAgICAgIHRoaXMuX3ggKz0gd2lkdGggKyBzcGFjZTtcclxuXHJcbiAgICAgICAgdGhpcy5fZm9udERlZkRpY3Rpb25hcnkuYWRkTGV0dGVyRGVmaW5pdGlvbnMobGV0dGVyVGV4dHVyZS5faGFzaCwgbGV0dGVyKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gbGV0dGVyXHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZSAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9kaXJ0eSkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5Ll90ZXh0dXJlLnVwZGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX2RpcnR5ID0gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuICAgICAgICB0aGlzLl94ID0gc3BhY2U7XHJcbiAgICAgICAgdGhpcy5feSA9IHNwYWNlO1xyXG4gICAgICAgIHRoaXMuX25leHR5ID0gc3BhY2U7XHJcblxyXG4gICAgICAgIGxldCBjaGFycyA9IHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5Ll9sZXR0ZXJEZWZpbml0aW9ucztcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGNoYXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgY2hhciA9IGNoYXJzW2ldO1xyXG4gICAgICAgICAgICBpZiAoIWNoYXIuaXNWYWxpZCkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2hhci5kZXN0cm95KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9mb250RGVmRGljdGlvbmFyeS5jbGVhcigpO1xyXG4gICAgfSxcclxuXHJcbiAgICBkZXN0cm95ICgpIHtcclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgdGhpcy5fZm9udERlZkRpY3Rpb25hcnkuX3RleHR1cmUuZGVzdHJveSgpO1xyXG4gICAgICAgIHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5Ll90ZXh0dXJlID0gbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgYmVmb3JlU2NlbmVMb2FkICgpIHtcclxuICAgICAgICB0aGlzLmNsZWFyQWxsQ2FjaGUoKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xlYXJBbGxDYWNoZSAoKSB7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95KCk7XHJcblxyXG4gICAgICAgIGxldCB0ZXh0dXJlID0gbmV3IFJlbmRlclRleHR1cmUoKTtcclxuICAgICAgICB0ZXh0dXJlLmluaXRXaXRoU2l6ZSh0aGlzLl93aWR0aCwgdGhpcy5faGVpZ2h0KTtcclxuICAgICAgICB0ZXh0dXJlLnVwZGF0ZSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5Ll90ZXh0dXJlID0gdGV4dHVyZTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0TGV0dGVyIChrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZm9udERlZkRpY3Rpb25hcnkuX2xldHRlckRlZmluaXRpb25zW2tleV07XHJcbiAgICB9LFxyXG5cclxuICAgIGdldFRleHR1cmUgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9mb250RGVmRGljdGlvbmFyeS5nZXRUZXh0dXJlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldExldHRlckRlZmluaXRpb25Gb3JDaGFyOiBmdW5jdGlvbihjaGFyLCBsYWJlbEluZm8pIHtcclxuICAgICAgICBsZXQgaGFzaCA9IGNoYXIuY2hhckNvZGVBdCgwKSArIGxhYmVsSW5mby5oYXNoO1xyXG4gICAgICAgIGxldCBsZXR0ZXIgPSB0aGlzLl9mb250RGVmRGljdGlvbmFyeS5fbGV0dGVyRGVmaW5pdGlvbnNbaGFzaF07XHJcbiAgICAgICAgaWYgKCFsZXR0ZXIpIHtcclxuICAgICAgICAgICAgbGV0IHRlbXAgPSBuZXcgTGV0dGVyVGV4dHVyZShjaGFyLCBsYWJlbEluZm8pO1xyXG4gICAgICAgICAgICB0ZW1wLnVwZGF0ZVJlbmRlckRhdGEoKTtcclxuICAgICAgICAgICAgbGV0dGVyID0gdGhpcy5pbnNlcnRMZXR0ZXJUZXh0dXJlKHRlbXApO1xyXG4gICAgICAgICAgICB0ZW1wLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBsZXR0ZXI7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gY29tcHV0ZUhhc2ggKGxhYmVsSW5mbykge1xyXG4gICAgbGV0IGhhc2hEYXRhID0gJyc7XHJcbiAgICBsZXQgY29sb3IgPSBsYWJlbEluZm8uY29sb3IudG9IRVgoKTtcclxuICAgIGxldCBvdXQgPSAnJztcclxuICAgIGlmIChsYWJlbEluZm8uaXNPdXRsaW5lZCAmJiBsYWJlbEluZm8ubWFyZ2luID4gMCkge1xyXG4gICAgICAgIG91dCA9IG91dCArIGxhYmVsSW5mby5tYXJnaW4gKyBsYWJlbEluZm8ub3V0LnRvSEVYKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBoYXNoRGF0YSArIGxhYmVsSW5mby5mb250U2l6ZSArIGxhYmVsSW5mby5mb250RmFtaWx5ICsgY29sb3IgKyBvdXQ7XHJcbn1cclxuXHJcbmxldCBfc2hhcmVBdGxhcyA9IG51bGw7XHJcblxyXG5sZXQgX2F0bGFzV2lkdGggPSAyMDQ4O1xyXG5sZXQgX2F0bGFzSGVpZ2h0ID0gMjA0ODtcclxubGV0IF9pc0JvbGQgPSBmYWxzZTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIExldHRlckZvbnRBc3NlbWJsZXIgZXh0ZW5kcyBXZWJnbEJtZm9udEFzc2VtYmxlciB7XHJcbiAgICBfZ2V0QXNzZW1ibGVyRGF0YSAoKSB7XHJcbiAgICAgICAgaWYgKCFfc2hhcmVBdGxhcykge1xyXG4gICAgICAgICAgICBfc2hhcmVBdGxhcyA9IG5ldyBMZXR0ZXJBdGxhcyhfYXRsYXNXaWR0aCwgX2F0bGFzSGVpZ2h0KTtcclxuICAgICAgICAgICAgY2MuTGFiZWwuX3NoYXJlQXRsYXMgPSBfc2hhcmVBdGxhcztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIF9zaGFyZUF0bGFzLmdldFRleHR1cmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBfdXBkYXRlRm9udEZhbWlseSAoY29tcCkge1xyXG4gICAgICAgIHNoYXJlTGFiZWxJbmZvLmZvbnRBdGxhcyA9IF9zaGFyZUF0bGFzO1xyXG4gICAgICAgIHNoYXJlTGFiZWxJbmZvLmZvbnRGYW1pbHkgPSBnZXRGb250RmFtaWx5KGNvbXApO1xyXG5cclxuICAgICAgICAvLyBvdXRsaW5lXHJcbiAgICAgICAgbGV0IG91dGxpbmUgPSBPVVRMSU5FX1NVUFBPUlRFRCAmJiBjb21wLmdldENvbXBvbmVudChMYWJlbE91dGxpbmUpO1xyXG4gICAgICAgIGlmIChvdXRsaW5lICYmIG91dGxpbmUuZW5hYmxlZCkge1xyXG4gICAgICAgICAgICBzaGFyZUxhYmVsSW5mby5pc091dGxpbmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2hhcmVMYWJlbEluZm8ubWFyZ2luID0gb3V0bGluZS53aWR0aDtcclxuICAgICAgICAgICAgc2hhcmVMYWJlbEluZm8ub3V0ID0gb3V0bGluZS5jb2xvci5jbG9uZSgpO1xyXG4gICAgICAgICAgICBzaGFyZUxhYmVsSW5mby5vdXQuYSA9IG91dGxpbmUuY29sb3IuYSAqIGNvbXAubm9kZS5jb2xvci5hIC8gMjU1LjA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzaGFyZUxhYmVsSW5mby5pc091dGxpbmVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHNoYXJlTGFiZWxJbmZvLm1hcmdpbiA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF91cGRhdGVMYWJlbEluZm8gKGNvbXApIHtcclxuICAgICAgICBzaGFyZUxhYmVsSW5mby5mb250RGVzYyA9IHRoaXMuX2dldEZvbnREZXNjKCk7XHJcbiAgICAgICAgc2hhcmVMYWJlbEluZm8uY29sb3IgPSBjb21wLm5vZGUuY29sb3I7XHJcbiAgICAgICAgc2hhcmVMYWJlbEluZm8uaGFzaCA9IGNvbXB1dGVIYXNoKHNoYXJlTGFiZWxJbmZvKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0Rm9udERlc2MgKCkge1xyXG4gICAgICAgIGxldCBmb250RGVzYyA9IHNoYXJlTGFiZWxJbmZvLmZvbnRTaXplLnRvU3RyaW5nKCkgKyAncHggJztcclxuICAgICAgICBmb250RGVzYyA9IGZvbnREZXNjICsgc2hhcmVMYWJlbEluZm8uZm9udEZhbWlseTtcclxuICAgICAgICBpZiAoX2lzQm9sZCkge1xyXG4gICAgICAgICAgICBmb250RGVzYyA9IFwiYm9sZCBcIiArIGZvbnREZXNjO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZvbnREZXNjO1xyXG4gICAgfVxyXG4gICAgX2NvbXB1dGVIb3Jpem9udGFsS2VybmluZ0ZvclRleHQgKCkge31cclxuICAgIF9kZXRlcm1pbmVSZWN0ICh0ZW1wUmVjdCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufSJdLCJzb3VyY2VSb290IjoiLyJ9