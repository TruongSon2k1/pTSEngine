
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/renderer/webgl/assemblers/label/2d/bmfont.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

exports.__esModule = true;
exports["default"] = void 0;

var _bmfont = _interopRequireDefault(require("../../../../utils/label/bmfont"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var _dataOffset = 0;

var WebglBmfontAssembler = /*#__PURE__*/function (_BmfontAssembler) {
  _inheritsLoose(WebglBmfontAssembler, _BmfontAssembler);

  function WebglBmfontAssembler() {
    return _BmfontAssembler.apply(this, arguments) || this;
  }

  var _proto = WebglBmfontAssembler.prototype;

  _proto.initData = function initData() {
    this._renderData.createFlexData(0, 4, 6, this.getVfmt());
  };

  _proto._reserveQuads = function _reserveQuads(comp, count) {
    var verticesCount = count * 4;
    var indicesCount = count * 6;
    var flexBuffer = this._renderData._flexBuffer;
    flexBuffer.reserve(verticesCount, indicesCount);
    flexBuffer.used(verticesCount, indicesCount);
    var iData = this._renderData.iDatas[0];

    for (var i = 0, vid = 0, l = indicesCount; i < l; i += 6, vid += 4) {
      iData[i] = vid;
      iData[i + 1] = vid + 1;
      iData[i + 2] = vid + 2;
      iData[i + 3] = vid + 1;
      iData[i + 4] = vid + 3;
      iData[i + 5] = vid + 2;
    }

    _dataOffset = 0;
  };

  _proto._quadsUpdated = function _quadsUpdated(comp) {
    _dataOffset = 0;
    var flexBuffer = this._renderData._flexBuffer;
    flexBuffer.used(this.verticesCount, this.indicesCount);
  };

  _proto._getColor = function _getColor(comp) {
    return comp.node._color._val;
  };

  _proto.appendQuad = function appendQuad(comp, texture, rect, rotated, x, y, scale) {
    var renderData = this._renderData;
    var verts = renderData.vDatas[0],
        uintVerts = renderData.uintVDatas[0];
    this.verticesCount += 4;
    this.indicesCount = this.verticesCount / 2 * 3;

    var texw = texture.width,
        texh = texture.height,
        rectWidth = rect.width,
        rectHeight = rect.height,
        color = this._getColor(comp);

    var l, b, r, t;
    var floatsPerVert = this.floatsPerVert; // uvs

    var uvDataOffset = _dataOffset + this.uvOffset;

    if (!rotated) {
      l = rect.x / texw;
      r = (rect.x + rectWidth) / texw;
      b = (rect.y + rectHeight) / texh;
      t = rect.y / texh;
      verts[uvDataOffset] = l;
      verts[uvDataOffset + 1] = b;
      uvDataOffset += floatsPerVert;
      verts[uvDataOffset] = r;
      verts[uvDataOffset + 1] = b;
      uvDataOffset += floatsPerVert;
      verts[uvDataOffset] = l;
      verts[uvDataOffset + 1] = t;
      uvDataOffset += floatsPerVert;
      verts[uvDataOffset] = r;
      verts[uvDataOffset + 1] = t;
    } else {
      l = rect.x / texw;
      r = (rect.x + rectHeight) / texw;
      b = (rect.y + rectWidth) / texh;
      t = rect.y / texh;
      verts[uvDataOffset] = l;
      verts[uvDataOffset + 1] = t;
      uvDataOffset += floatsPerVert;
      verts[uvDataOffset] = l;
      verts[uvDataOffset + 1] = b;
      uvDataOffset += floatsPerVert;
      verts[uvDataOffset] = r;
      verts[uvDataOffset + 1] = t;
      uvDataOffset += floatsPerVert;
      verts[uvDataOffset] = r;
      verts[uvDataOffset + 1] = b;
    } // positions


    l = x;
    r = x + rectWidth * scale;
    b = y - rectHeight * scale;
    t = y;
    this.appendVerts(comp, _dataOffset, l, r, b, t); // colors

    var colorOffset = _dataOffset + this.colorOffset;

    for (var i = 0; i < 4; i++) {
      uintVerts[colorOffset] = color;
      colorOffset += floatsPerVert;
    }

    _dataOffset += this.floatsPerVert * 4;
  };

  _proto.appendVerts = function appendVerts(comp, offset, l, r, b, t) {
    var local = this._local;
    var floatsPerVert = this.floatsPerVert;
    local[offset] = l;
    local[offset + 1] = b;
    offset += floatsPerVert;
    local[offset] = r;
    local[offset + 1] = b;
    offset += floatsPerVert;
    local[offset] = l;
    local[offset + 1] = t;
    offset += floatsPerVert;
    local[offset] = r;
    local[offset + 1] = t;
  };

  _proto.updateWorldVerts = function updateWorldVerts(comp) {
    var node = comp.node;
    var matrix = node._worldMatrix;
    var matrixm = matrix.m,
        a = matrixm[0],
        b = matrixm[1],
        c = matrixm[4],
        d = matrixm[5],
        tx = matrixm[12],
        ty = matrixm[13];
    var local = this._local;
    var world = this._renderData.vDatas[0];
    var floatsPerVert = this.floatsPerVert;

    for (var offset = 0; offset < local.length; offset += floatsPerVert) {
      var x = local[offset];
      var y = local[offset + 1];
      world[offset] = x * a + y * c + tx;
      world[offset + 1] = x * b + y * d + ty;
    }
  };

  return WebglBmfontAssembler;
}(_bmfont["default"]);

exports["default"] = WebglBmfontAssembler;
module.exports = exports["default"];
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuZ2luZS1kZXZcXGNvY29zMmRcXGNvcmVcXHJlbmRlcmVyXFx3ZWJnbFxcYXNzZW1ibGVyc1xcbGFiZWxcXDJkXFxibWZvbnQuanMiXSwibmFtZXMiOlsiX2RhdGFPZmZzZXQiLCJXZWJnbEJtZm9udEFzc2VtYmxlciIsImluaXREYXRhIiwiX3JlbmRlckRhdGEiLCJjcmVhdGVGbGV4RGF0YSIsImdldFZmbXQiLCJfcmVzZXJ2ZVF1YWRzIiwiY29tcCIsImNvdW50IiwidmVydGljZXNDb3VudCIsImluZGljZXNDb3VudCIsImZsZXhCdWZmZXIiLCJfZmxleEJ1ZmZlciIsInJlc2VydmUiLCJ1c2VkIiwiaURhdGEiLCJpRGF0YXMiLCJpIiwidmlkIiwibCIsIl9xdWFkc1VwZGF0ZWQiLCJfZ2V0Q29sb3IiLCJub2RlIiwiX2NvbG9yIiwiX3ZhbCIsImFwcGVuZFF1YWQiLCJ0ZXh0dXJlIiwicmVjdCIsInJvdGF0ZWQiLCJ4IiwieSIsInNjYWxlIiwicmVuZGVyRGF0YSIsInZlcnRzIiwidkRhdGFzIiwidWludFZlcnRzIiwidWludFZEYXRhcyIsInRleHciLCJ3aWR0aCIsInRleGgiLCJoZWlnaHQiLCJyZWN0V2lkdGgiLCJyZWN0SGVpZ2h0IiwiY29sb3IiLCJiIiwiciIsInQiLCJmbG9hdHNQZXJWZXJ0IiwidXZEYXRhT2Zmc2V0IiwidXZPZmZzZXQiLCJhcHBlbmRWZXJ0cyIsImNvbG9yT2Zmc2V0Iiwib2Zmc2V0IiwibG9jYWwiLCJfbG9jYWwiLCJ1cGRhdGVXb3JsZFZlcnRzIiwibWF0cml4IiwiX3dvcmxkTWF0cml4IiwibWF0cml4bSIsIm0iLCJhIiwiYyIsImQiLCJ0eCIsInR5Iiwid29ybGQiLCJsZW5ndGgiLCJCbWZvbnRBc3NlbWJsZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUF5QkE7Ozs7Ozs7O0FBRUEsSUFBSUEsV0FBVyxHQUFHLENBQWxCOztJQUVxQkM7Ozs7Ozs7OztTQUNqQkMsV0FBQSxvQkFBWTtBQUNSLFNBQUtD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QUssQ0FBQ0QsTUFBTSxHQUFHLENBQVYsQ0FBYjtBQUNBYSxNQUFBQSxLQUFLLENBQUNiLE1BQUQsQ0FBTCxHQUFnQnZCLENBQUMsR0FBRytCLENBQUosR0FBUTlCLENBQUMsR0FBRytCLENBQVosR0FBZ0JFLEVBQWhDO0FBQ0FFLE1BQUFBLEtBQUssQ0FBQ2IsTUFBTSxHQUFDLENBQVIsQ0FBTCxHQUFrQnZCLENBQUMsR0FBR2UsQ0FBSixHQUFRZCxDQUFDLEdBQUdnQyxDQUFaLEdBQWdCRSxFQUFsQztBQUNIO0FBQ0o7OztFQXBKNkNHIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuIENvcHlyaWdodCAoYykgMjAxNy0yMDE4IFhpYW1lbiBZYWppIFNvZnR3YXJlIENvLiwgTHRkLlxyXG5cclxuIGh0dHBzOi8vd3d3LmNvY29zLmNvbS9cclxuXHJcbiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGVuZ2luZSBzb3VyY2UgY29kZSAodGhlIFwiU29mdHdhcmVcIiksIGEgbGltaXRlZCxcclxuIHdvcmxkd2lkZSwgcm95YWx0eS1mcmVlLCBub24tYXNzaWduYWJsZSwgcmV2b2NhYmxlIGFuZCBub24tZXhjbHVzaXZlIGxpY2Vuc2VcclxuIHRvIHVzZSBDb2NvcyBDcmVhdG9yIHNvbGVseSB0byBkZXZlbG9wIGdhbWVzIG9uIHlvdXIgdGFyZ2V0IHBsYXRmb3Jtcy4gWW91IHNoYWxsXHJcbiBub3QgdXNlIENvY29zIENyZWF0b3Igc29mdHdhcmUgZm9yIGRldmVsb3Bpbmcgb3RoZXIgc29mdHdhcmUgb3IgdG9vbHMgdGhhdCdzXHJcbiB1c2VkIGZvciBkZXZlbG9waW5nIGdhbWVzLiBZb3UgYXJlIG5vdCBncmFudGVkIHRvIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsXHJcbiBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgQ29jb3MgQ3JlYXRvci5cclxuXHJcbiBUaGUgc29mdHdhcmUgb3IgdG9vbHMgaW4gdGhpcyBMaWNlbnNlIEFncmVlbWVudCBhcmUgbGljZW5zZWQsIG5vdCBzb2xkLlxyXG4gWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuIHJlc2VydmVzIGFsbCByaWdodHMgbm90IGV4cHJlc3NseSBncmFudGVkIHRvIHlvdS5cclxuXHJcbiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuIFRIRSBTT0ZUV0FSRS5cclxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcblxyXG5pbXBvcnQgQm1mb250QXNzZW1ibGVyIGZyb20gJy4uLy4uLy4uLy4uL3V0aWxzL2xhYmVsL2JtZm9udCc7XHJcblxyXG5sZXQgX2RhdGFPZmZzZXQgPSAwO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgV2ViZ2xCbWZvbnRBc3NlbWJsZXIgZXh0ZW5kcyBCbWZvbnRBc3NlbWJsZXIge1xyXG4gICAgaW5pdERhdGEgKCkge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlckRhdGEuY3JlYXRlRmxleERhdGEoMCwgNCwgNiwgdGhpcy5nZXRWZm10KCkpO1xyXG4gICAgfVxyXG5cclxuICAgIF9yZXNlcnZlUXVhZHMgKGNvbXAsIGNvdW50KSB7XHJcbiAgICAgICAgbGV0IHZlcnRpY2VzQ291bnQgPSBjb3VudCAqIDQ7XHJcbiAgICAgICAgbGV0IGluZGljZXNDb3VudCA9IGNvdW50ICogNjtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgZmxleEJ1ZmZlciA9IHRoaXMuX3JlbmRlckRhdGEuX2ZsZXhCdWZmZXI7XHJcbiAgICAgICAgZmxleEJ1ZmZlci5yZXNlcnZlKHZlcnRpY2VzQ291bnQsIGluZGljZXNDb3VudCk7XHJcbiAgICAgICAgZmxleEJ1ZmZlci51c2VkKHZlcnRpY2VzQ291bnQsIGluZGljZXNDb3VudCk7XHJcbiAgICAgICBcclxuICAgICAgICBsZXQgaURhdGEgPSB0aGlzLl9yZW5kZXJEYXRhLmlEYXRhc1swXTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIHZpZCA9IDAsIGwgPSBpbmRpY2VzQ291bnQ7IGkgPCBsOyBpICs9IDYsIHZpZCArPSA0KSB7XHJcbiAgICAgICAgICAgIGlEYXRhW2ldID0gdmlkO1xyXG4gICAgICAgICAgICBpRGF0YVtpICsgMV0gPSB2aWQgKyAxO1xyXG4gICAgICAgICAgICBpRGF0YVtpICsgMl0gPSB2aWQgKyAyO1xyXG4gICAgICAgICAgICBpRGF0YVtpICsgM10gPSB2aWQgKyAxO1xyXG4gICAgICAgICAgICBpRGF0YVtpICsgNF0gPSB2aWQgKyAzO1xyXG4gICAgICAgICAgICBpRGF0YVtpICsgNV0gPSB2aWQgKyAyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX2RhdGFPZmZzZXQgPSAwO1xyXG4gICAgfVxyXG5cclxuICAgIF9xdWFkc1VwZGF0ZWQgKGNvbXApIHtcclxuICAgICAgICBfZGF0YU9mZnNldCA9IDA7XHJcblxyXG4gICAgICAgIGxldCBmbGV4QnVmZmVyID0gdGhpcy5fcmVuZGVyRGF0YS5fZmxleEJ1ZmZlcjtcclxuICAgICAgICBmbGV4QnVmZmVyLnVzZWQodGhpcy52ZXJ0aWNlc0NvdW50LCB0aGlzLmluZGljZXNDb3VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldENvbG9yIChjb21wKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbXAubm9kZS5fY29sb3IuX3ZhbDtcclxuICAgIH1cclxuXHJcbiAgICBhcHBlbmRRdWFkIChjb21wLCB0ZXh0dXJlLCByZWN0LCByb3RhdGVkLCB4LCB5LCBzY2FsZSkge1xyXG4gICAgICAgIGxldCByZW5kZXJEYXRhID0gdGhpcy5fcmVuZGVyRGF0YTtcclxuICAgICAgICBsZXQgdmVydHMgPSByZW5kZXJEYXRhLnZEYXRhc1swXSxcclxuICAgICAgICAgICAgdWludFZlcnRzID0gcmVuZGVyRGF0YS51aW50VkRhdGFzWzBdO1xyXG5cclxuICAgICAgICB0aGlzLnZlcnRpY2VzQ291bnQgKz0gNDtcclxuICAgICAgICB0aGlzLmluZGljZXNDb3VudCA9IHRoaXMudmVydGljZXNDb3VudCAvIDIgKiAzO1xyXG5cclxuICAgICAgICBsZXQgdGV4dyA9IHRleHR1cmUud2lkdGgsXHJcbiAgICAgICAgICAgIHRleGggPSB0ZXh0dXJlLmhlaWdodCxcclxuICAgICAgICAgICAgcmVjdFdpZHRoID0gcmVjdC53aWR0aCxcclxuICAgICAgICAgICAgcmVjdEhlaWdodCA9IHJlY3QuaGVpZ2h0LFxyXG4gICAgICAgICAgICBjb2xvciA9IHRoaXMuX2dldENvbG9yKGNvbXApO1xyXG5cclxuICAgICAgICBsZXQgbCwgYiwgciwgdDtcclxuICAgICAgICBsZXQgZmxvYXRzUGVyVmVydCA9IHRoaXMuZmxvYXRzUGVyVmVydDtcclxuICAgICAgICAvLyB1dnNcclxuICAgICAgICBsZXQgdXZEYXRhT2Zmc2V0ID0gX2RhdGFPZmZzZXQgKyB0aGlzLnV2T2Zmc2V0O1xyXG4gICAgICAgIGlmICghcm90YXRlZCkge1xyXG4gICAgICAgICAgICBsID0gKHJlY3QueCkgLyB0ZXh3O1xyXG4gICAgICAgICAgICByID0gKHJlY3QueCArIHJlY3RXaWR0aCkgLyB0ZXh3O1xyXG4gICAgICAgICAgICBiID0gKHJlY3QueSArIHJlY3RIZWlnaHQpIC8gdGV4aDtcclxuICAgICAgICAgICAgdCA9IChyZWN0LnkpIC8gdGV4aDtcclxuXHJcbiAgICAgICAgICAgIHZlcnRzW3V2RGF0YU9mZnNldF0gPSBsO1xyXG4gICAgICAgICAgICB2ZXJ0c1t1dkRhdGFPZmZzZXQgKyAxXSA9IGI7XHJcbiAgICAgICAgICAgIHV2RGF0YU9mZnNldCArPSBmbG9hdHNQZXJWZXJ0O1xyXG4gICAgICAgICAgICB2ZXJ0c1t1dkRhdGFPZmZzZXRdID0gcjtcclxuICAgICAgICAgICAgdmVydHNbdXZEYXRhT2Zmc2V0ICsgMV0gPSBiO1xyXG4gICAgICAgICAgICB1dkRhdGFPZmZzZXQgKz0gZmxvYXRzUGVyVmVydDtcclxuICAgICAgICAgICAgdmVydHNbdXZEYXRhT2Zmc2V0XSA9IGw7XHJcbiAgICAgICAgICAgIHZlcnRzW3V2RGF0YU9mZnNldCArIDFdID0gdDtcclxuICAgICAgICAgICAgdXZEYXRhT2Zmc2V0ICs9IGZsb2F0c1BlclZlcnQ7XHJcbiAgICAgICAgICAgIHZlcnRzW3V2RGF0YU9mZnNldF0gPSByO1xyXG4gICAgICAgICAgICB2ZXJ0c1t1dkRhdGFPZmZzZXQgKyAxXSA9IHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbCA9IChyZWN0LngpIC8gdGV4dztcclxuICAgICAgICAgICAgciA9IChyZWN0LnggKyByZWN0SGVpZ2h0KSAvIHRleHc7XHJcbiAgICAgICAgICAgIGIgPSAocmVjdC55ICsgcmVjdFdpZHRoKSAvIHRleGg7XHJcbiAgICAgICAgICAgIHQgPSAocmVjdC55KSAvIHRleGg7XHJcblxyXG4gICAgICAgICAgICB2ZXJ0c1t1dkRhdGFPZmZzZXRdID0gbDtcclxuICAgICAgICAgICAgdmVydHNbdXZEYXRhT2Zmc2V0ICsgMV0gPSB0O1xyXG4gICAgICAgICAgICB1dkRhdGFPZmZzZXQgKz0gZmxvYXRzUGVyVmVydDtcclxuICAgICAgICAgICAgdmVydHNbdXZEYXRhT2Zmc2V0XSA9IGw7XHJcbiAgICAgICAgICAgIHZlcnRzW3V2RGF0YU9mZnNldCArIDFdID0gYjtcclxuICAgICAgICAgICAgdXZEYXRhT2Zmc2V0ICs9IGZsb2F0c1BlclZlcnQ7XHJcbiAgICAgICAgICAgIHZlcnRzW3V2RGF0YU9mZnNldF0gPSByO1xyXG4gICAgICAgICAgICB2ZXJ0c1t1dkRhdGFPZmZzZXQgKyAxXSA9IHQ7XHJcbiAgICAgICAgICAgIHV2RGF0YU9mZnNldCArPSBmbG9hdHNQZXJWZXJ0O1xyXG4gICAgICAgICAgICB2ZXJ0c1t1dkRhdGFPZmZzZXRdID0gcjtcclxuICAgICAgICAgICAgdmVydHNbdXZEYXRhT2Zmc2V0ICsgMV0gPSBiO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIC8vIHBvc2l0aW9uc1xyXG4gICAgICAgIGwgPSB4O1xyXG4gICAgICAgIHIgPSB4ICsgcmVjdFdpZHRoICogc2NhbGU7XHJcbiAgICAgICAgYiA9IHkgLSByZWN0SGVpZ2h0ICogc2NhbGU7XHJcbiAgICAgICAgdCA9IHk7XHJcblxyXG4gICAgICAgIHRoaXMuYXBwZW5kVmVydHMoY29tcCwgX2RhdGFPZmZzZXQsIGwsIHIsIGIsIHQpO1xyXG5cclxuICAgICAgICAvLyBjb2xvcnNcclxuICAgICAgICBsZXQgY29sb3JPZmZzZXQgPSBfZGF0YU9mZnNldCArIHRoaXMuY29sb3JPZmZzZXQ7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcclxuICAgICAgICAgICAgdWludFZlcnRzW2NvbG9yT2Zmc2V0XSA9IGNvbG9yO1xyXG4gICAgICAgICAgICBjb2xvck9mZnNldCArPSBmbG9hdHNQZXJWZXJ0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX2RhdGFPZmZzZXQgKz0gdGhpcy5mbG9hdHNQZXJWZXJ0ICogNDtcclxuICAgIH1cclxuXHJcbiAgICBhcHBlbmRWZXJ0cyAoY29tcCwgb2Zmc2V0LCBsLCByLCBiLCB0KSB7XHJcbiAgICAgICAgbGV0IGxvY2FsID0gdGhpcy5fbG9jYWw7XHJcbiAgICAgICAgbGV0IGZsb2F0c1BlclZlcnQgPSB0aGlzLmZsb2F0c1BlclZlcnQ7XHJcblxyXG4gICAgICAgIGxvY2FsW29mZnNldF0gPSBsO1xyXG4gICAgICAgIGxvY2FsW29mZnNldCArIDFdID0gYjtcclxuXHJcbiAgICAgICAgb2Zmc2V0ICs9IGZsb2F0c1BlclZlcnQ7XHJcbiAgICAgICAgbG9jYWxbb2Zmc2V0XSA9IHI7XHJcbiAgICAgICAgbG9jYWxbb2Zmc2V0ICsgMV0gPSBiO1xyXG5cclxuICAgICAgICBvZmZzZXQgKz0gZmxvYXRzUGVyVmVydDtcclxuICAgICAgICBsb2NhbFtvZmZzZXRdID0gbDtcclxuICAgICAgICBsb2NhbFtvZmZzZXQgKyAxXSA9IHQ7XHJcblxyXG4gICAgICAgIG9mZnNldCArPSBmbG9hdHNQZXJWZXJ0O1xyXG4gICAgICAgIGxvY2FsW29mZnNldF0gPSByO1xyXG4gICAgICAgIGxvY2FsW29mZnNldCArIDFdID0gdDtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVXb3JsZFZlcnRzIChjb21wKSB7XHJcbiAgICAgICAgbGV0IG5vZGUgPSBjb21wLm5vZGU7XHJcblxyXG4gICAgICAgIGxldCBtYXRyaXggPSBub2RlLl93b3JsZE1hdHJpeDtcclxuICAgICAgICBsZXQgbWF0cml4bSA9IG1hdHJpeC5tLFxyXG4gICAgICAgICAgICBhID0gbWF0cml4bVswXSwgYiA9IG1hdHJpeG1bMV0sIGMgPSBtYXRyaXhtWzRdLCBkID0gbWF0cml4bVs1XSxcclxuICAgICAgICAgICAgdHggPSBtYXRyaXhtWzEyXSwgdHkgPSBtYXRyaXhtWzEzXTtcclxuXHJcbiAgICAgICAgbGV0IGxvY2FsID0gdGhpcy5fbG9jYWw7XHJcbiAgICAgICAgbGV0IHdvcmxkID0gdGhpcy5fcmVuZGVyRGF0YS52RGF0YXNbMF07XHJcbiAgICAgICAgbGV0IGZsb2F0c1BlclZlcnQgPSB0aGlzLmZsb2F0c1BlclZlcnQ7XHJcbiAgICAgICAgZm9yIChsZXQgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgbG9jYWwubGVuZ3RoOyBvZmZzZXQgKz0gZmxvYXRzUGVyVmVydCkge1xyXG4gICAgICAgICAgICBsZXQgeCA9IGxvY2FsW29mZnNldF07XHJcbiAgICAgICAgICAgIGxldCB5ID0gbG9jYWxbb2Zmc2V0ICsgMV07XHJcbiAgICAgICAgICAgIHdvcmxkW29mZnNldF0gPSB4ICogYSArIHkgKiBjICsgdHg7XHJcbiAgICAgICAgICAgIHdvcmxkW29mZnNldCsxXSA9IHggKiBiICsgeSAqIGQgKyB0eTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiLyJ9