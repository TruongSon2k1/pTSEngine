
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/components/CCProgressBar.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

/****************************************************************************
 Copyright (c) 2013-2016 Chukong Technologies Inc.
 Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.

 https://www.cocos.com/

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated engine source code (the "Software"), a limited,
  worldwide, royalty-free, non-assignable, revocable and non-exclusive license
 to use Cocos Creator solely to develop games on your target platforms. You shall
  not use Cocos Creator software for developing other software or tools that's
  used for developing games. You are not granted to publish, distribute,
  sublicense, and/or sell copies of Cocos Creator.

 The software or tools in this License Agreement are licensed, not sold.
 Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 ****************************************************************************/
var misc = require('../utils/misc');

var Component = require('./CCComponent');
/**
 * !#en Enum for ProgressBar mode
 * !#zh 进度条模式
 * @enum ProgressBar.Mode
 */


var Mode = cc.Enum({
  /**
   * !#en TODO
   * !#zh 水平方向模式
   * @property {Number} HORIZONTAL
   */
  HORIZONTAL: 0,

  /**
   * !#en TODO
   * !#zh 垂直方向模式
   * @property {Number} VERTICAL
   */
  VERTICAL: 1,

  /**
   * !#en TODO
   * !#zh 填充模式
   * @property {Number} FILLED
   */
  FILLED: 2
});
/**
 * !#en
 * Visual indicator of progress in some operation.
 * Displays a bar to the user representing how far the operation has progressed.
 * !#zh
 * 进度条组件，可用于显示加载资源时的进度。
 * @class ProgressBar
 * @extends Component
 * @example
 * // update progressBar
 * update: function (dt) {
 *     var progress = progressBar.progress;
 *     if (progress > 0) {
 *         progress += dt;
 *     }
 *     else {
 *         progress = 1;
 *     }
 *     progressBar.progress = progress;
 * }
 *
 */

var ProgressBar = cc.Class({
  name: 'cc.ProgressBar',
  "extends": Component,
  editor: CC_EDITOR && {
    menu: 'i18n:MAIN_MENU.component.ui/ProgressBar',
    help: 'i18n:COMPONENT.help_url.progressbar'
  },
  _initBarSprite: function _initBarSprite() {
    if (this.barSprite) {
      var entity = this.barSprite.node;
      if (!entity) return;
      var nodeSize = this.node.getContentSize();
      var nodeAnchor = this.node.getAnchorPoint();
      var entitySize = entity.getContentSize();

      if (entity.parent === this.node) {
        this.node.setContentSize(entitySize);
      }

      if (this.barSprite.fillType === cc.Sprite.FillType.RADIAL) {
        this.mode = Mode.FILLED;
      }

      var barSpriteSize = entity.getContentSize();

      if (this.mode === Mode.HORIZONTAL) {
        this.totalLength = barSpriteSize.width;
      } else if (this.mode === Mode.VERTICAL) {
        this.totalLength = barSpriteSize.height;
      } else {
        this.totalLength = this.barSprite.fillRange;
      }

      if (entity.parent === this.node) {
        var x = -nodeSize.width * nodeAnchor.x;
        var y = 0;
        entity.setPosition(cc.v2(x, y));
      }
    }
  },
  _updateBarStatus: function _updateBarStatus() {
    if (this.barSprite) {
      var entity = this.barSprite.node;
      if (!entity) return;
      var entityAnchorPoint = entity.getAnchorPoint();
      var entitySize = entity.getContentSize();
      var entityPosition = entity.getPosition();
      var anchorPoint = cc.v2(0, 0.5);
      var progress = misc.clamp01(this.progress);
      var actualLenth = this.totalLength * progress;
      var finalContentSize;
      var totalWidth;
      var totalHeight;

      switch (this.mode) {
        case Mode.HORIZONTAL:
          if (this.reverse) {
            anchorPoint = cc.v2(1, 0.5);
          }

          finalContentSize = cc.size(actualLenth, entitySize.height);
          totalWidth = this.totalLength;
          totalHeight = entitySize.height;
          break;

        case Mode.VERTICAL:
          if (this.reverse) {
            anchorPoint = cc.v2(0.5, 1);
          } else {
            anchorPoint = cc.v2(0.5, 0);
          }

          finalContentSize = cc.size(entitySize.width, actualLenth);
          totalWidth = entitySize.width;
          totalHeight = this.totalLength;
          break;
      } //handling filled mode


      if (this.mode === Mode.FILLED) {
        if (this.barSprite.type !== cc.Sprite.Type.FILLED) {
          cc.warn('ProgressBar FILLED mode only works when barSprite\'s Type is FILLED!');
        } else {
          if (this.reverse) {
            actualLenth = actualLenth * -1;
          }

          this.barSprite.fillRange = actualLenth;
        }
      } else {
        if (this.barSprite.type !== cc.Sprite.Type.FILLED) {
          var anchorOffsetX = anchorPoint.x - entityAnchorPoint.x;
          var anchorOffsetY = anchorPoint.y - entityAnchorPoint.y;
          var finalPosition = cc.v2(totalWidth * anchorOffsetX, totalHeight * anchorOffsetY);
          entity.setPosition(entityPosition.x + finalPosition.x, entityPosition.y + finalPosition.y);
          entity.setAnchorPoint(anchorPoint);
          entity.setContentSize(finalContentSize);
        } else {
          cc.warn('ProgressBar non-FILLED mode only works when barSprite\'s Type is non-FILLED!');
        }
      }
    }
  },
  properties: {
    /**
     * !#en The targeted Sprite which will be changed progressively.
     * !#zh 用来显示进度条比例的 Sprite 对象。
     * @property {Sprite} barSprite
     */
    barSprite: {
      "default": null,
      type: cc.Sprite,
      tooltip: CC_DEV && 'i18n:COMPONENT.progress.bar_sprite',
      notify: function notify() {
        this._initBarSprite();
      },
      animatable: false
    },

    /**
     * !#en The progress mode, there are two modes supported now: horizontal and vertical.
     * !#zh 进度条的模式
     * @property {ProgressBar.Mode} mode
     */
    mode: {
      "default": Mode.HORIZONTAL,
      type: Mode,
      tooltip: CC_DEV && 'i18n:COMPONENT.progress.mode',
      notify: function notify() {
        if (this.barSprite) {
          var entity = this.barSprite.node;
          if (!entity) return;
          var entitySize = entity.getContentSize();

          if (this.mode === Mode.HORIZONTAL) {
            this.totalLength = entitySize.width;
          } else if (this.mode === Mode.VERTICAL) {
            this.totalLength = entitySize.height;
          } else if (this.mode === Mode.FILLED) {
            this.totalLength = this.barSprite.fillRange;
          }
        }
      },
      animatable: false
    },
    _N$totalLength: 1,

    /**
     * !#en The total width or height of the bar sprite.
     * !#zh 进度条实际的总长度
     * @property {Number} totalLength
     */
    totalLength: {
      range: [0, Number.MAX_VALUE],
      tooltip: CC_DEV && 'i18n:COMPONENT.progress.total_length',
      get: function get() {
        return this._N$totalLength;
      },
      set: function set(value) {
        if (this.mode === Mode.FILLED) {
          value = misc.clamp01(value);
        }

        this._N$totalLength = value;

        this._updateBarStatus();
      }
    },

    /**
     * !#en The current progress of the bar sprite. The valid value is between 0-1.
     * !#zh 当前进度值，该数值的区间是 0-1 之间。
     * @property {Number} progress
     */
    progress: {
      "default": 1,
      type: cc.Float,
      range: [0, 1, 0.1],
      slide: true,
      tooltip: CC_DEV && 'i18n:COMPONENT.progress.progress',
      notify: function notify() {
        this._updateBarStatus();
      }
    },

    /**
     * !#en Whether reverse the progress direction of the bar sprite.
     * !#zh 进度条是否进行反方向变化。
     * @property {Boolean} reverse
     */
    reverse: {
      "default": false,
      tooltip: CC_DEV && 'i18n:COMPONENT.progress.reverse',
      notify: function notify() {
        if (this.barSprite) {
          this.barSprite.fillStart = 1 - this.barSprite.fillStart;
        }

        this._updateBarStatus();
      },
      animatable: false
    }
  },
  statics: {
    Mode: Mode
  }
});
cc.ProgressBar = module.exports = ProgressBar;
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuZ2luZS1kZXZcXGNvY29zMmRcXGNvcmVcXGNvbXBvbmVudHNcXENDUHJvZ3Jlc3NCYXIuanMiXSwibmFtZXMiOlsibWlzYyIsInJlcXVpcmUiLCJDb21wb25lbnQiLCJNb2RlIiwiY2MiLCJFbnVtIiwiSE9SSVpPTlRBTCIsIlZFUlRJQ0FMIiwiRklMTEVEIiwiUHJvZ3Jlc3NCYXIiLCJDbGFzcyIsIm5hbWUiLCJlZGl0b3IiLCJDQ19FRElUT1IiLCJtZW51IiwiaGVscCIsIl9pbml0QmFyU3ByaXRlIiwiYmFyU3ByaXRlIiwiZW50aXR5Iiwibm9kZSIsIm5vZGVTaXplIiwiZ2V0Q29udGVudFNpemUiLCJub2RlQW5jaG9yIiwiZ2V0QW5jaG9yUG9pbnQiLCJlbnRpdHlTaXplIiwicGFyZW50Iiwic2V0Q29udGVudFNpemUiLCJmaWxsVHlwZSIsIlNwcml0ZSIsIkZpbGxUeXBlIiwiUkFESUFMIiwibW9kZSIsImJhclNwcml0ZVNpemUiLCJ0b3RhbExlbmd0aCIsIndpZHRoIiwiaGVpZ2h0IiwiZmlsbFJhbmdlIiwieCIsInkiLCJzZXRQb3NpdGlvbiIsInYyIiwiX3VwZGF0ZUJhclN0YXR1cyIsImVudGl0eUFuY2hvclBvaW50IiwiZW50aXR5UG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsImFuY2hvclBvaW50IiwicHJvZ3Jlc3MiLCJjbGFtcDAxIiwiYWN0dWFsTGVudGgiLCJmaW5hbENvbnRlbnRTaXplIiwidG90YWxXaWR0aCIsInRvdGFsSGVpZ2h0IiwicmV2ZXJzZSIsInNpemUiLCJ0eXBlIiwiVHlwZSIsIndhcm4iLCJhbmNob3JPZmZzZXRYIiwiYW5jaG9yT2Zmc2V0WSIsImZpbmFsUG9zaXRpb24iLCJzZXRBbmNob3JQb2ludCIsInByb3BlcnRpZXMiLCJ0b29sdGlwIiwiQ0NfREVWIiwibm90aWZ5IiwiYW5pbWF0YWJsZSIsIl9OJHRvdGFsTGVuZ3RoIiwicmFuZ2UiLCJOdW1iZXIiLCJNQVhfVkFMVUUiLCJnZXQiLCJzZXQiLCJ2YWx1ZSIsIkZsb2F0Iiwic2xpZGUiLCJmaWxsU3RhcnQiLCJzdGF0aWNzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUEsSUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsZUFBRCxDQUFwQjs7QUFDQSxJQUFNQyxTQUFTLEdBQUdELE9BQU8sQ0FBQyxlQUFELENBQXpCO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0EsSUFBSUUsSUFBSSxHQUFHQyxFQUFFLENBQUNDLElBQUgsQ0FBUTtBQUNmO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDSUMsRUFBQUEsVUFBVSxFQUFFLENBTkc7O0FBUWY7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNJQyxFQUFBQSxRQUFRLEVBQUUsQ0FiSzs7QUFjZjtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0lDLEVBQUFBLE1BQU0sRUFBRTtBQW5CTyxDQUFSLENBQVg7QUFzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0EsSUFBSUMsV0FBVyxHQUFHTCxFQUFFLENBQUNNLEtBQUgsQ0FBUztBQUN2QkMsRUFBQUEsSUFBSSxFQUFFLGdCQURpQjtBQUV2QixhQUFTVCxTQUZjO0FBSXZCVSxFQUFBQSxNQUFNLEVBQUVDLFNBQVMsSUFBSTtBQUNqQkMsSUFBQUEsSUFBSSxFQUFFLHlDQURXO0FBRWpCQyxJQUFBQSxJQUFJLEVBQUU7QUFGVyxHQUpFO0FBU3ZCQyxFQUFBQSxjQUFjLEVBQUUsMEJBQVc7QUFDdkIsUUFBSSxLQUFLQyxTQUFULEVBQW9CO0FBQ2hCLFVBQUlDLE1BQU0sR0FBRyxLQUFLRCxTQUFMLENBQWVFLElBQTVCO0FBQ0EsVUFBSSxDQUFDRCxNQUFMLEVBQWE7QUFFYixVQUFJRSxRQUFRLEdBQUcsS0FBS0QsSUFBTCxDQUFVRSxjQUFWLEVBQWY7QUFDQSxVQUFJQyxVQUFVLEdBQUcsS0FBS0gsSUFBTCxDQUFVSSxjQUFWLEVBQWpCO0FBRUEsVUFBSUMsVUFBVSxHQUFHTixNQUFNLENBQUNHLGNBQVAsRUFBakI7O0FBRUEsVUFBR0gsTUFBTSxDQUFDTyxNQUFQLEtBQWtCLEtBQUtOLElBQTFCLEVBQStCO0FBQzNCLGFBQUtBLElBQUwsQ0FBVU8sY0FBVixDQUF5QkYsVUFBekI7QUFDSDs7QUFFRCxVQUFJLEtBQUtQLFNBQUwsQ0FBZVUsUUFBZixLQUE0QnZCLEVBQUUsQ0FBQ3dCLE1BQUgsQ0FBVUMsUUFBVixDQUFtQkMsTUFBbkQsRUFBMkQ7QUFDdkQsYUFBS0MsSUFBTCxHQUFZNUIsSUFBSSxDQUFDSyxNQUFqQjtBQUNIOztBQUVELFVBQUl3QixhQUFhLEdBQUdkLE1BQU0sQ0FBQ0csY0FBUCxFQUFwQjs7QUFDQSxVQUFJLEtBQUtVLElBQUwsS0FBYzVCLElBQUksQ0FBQ0csVUFBdkIsRUFBbUM7QUFDL0IsYUFBSzJCLFdBQUwsR0FBbUJELGFBQWEsQ0FBQ0UsS0FBakM7QUFDSCxPQUZELE1BR0ssSUFBRyxLQUFLSCxJQUFMLEtBQWM1QixJQUFJLENBQUNJLFFBQXRCLEVBQWdDO0FBQ2pDLGFBQUswQixXQUFMLEdBQW1CRCxhQUFhLENBQUNHLE1BQWpDO0FBQ0gsT0FGSSxNQUdBO0FBQ0QsYUFBS0YsV0FBTCxHQUFtQixLQUFLaEIsU0FBTCxDQUFlbUIsU0FBbEM7QUFDSDs7QUFFRCxVQUFHbEIsTUFBTSxDQUFDTyxNQUFQLEtBQWtCLEtBQUtOLElBQTFCLEVBQStCO0FBQzNCLFlBQUlrQixDQUFDLEdBQUcsQ0FBRWpCLFFBQVEsQ0FBQ2MsS0FBWCxHQUFtQlosVUFBVSxDQUFDZSxDQUF0QztBQUNBLFlBQUlDLENBQUMsR0FBRyxDQUFSO0FBQ0FwQixRQUFBQSxNQUFNLENBQUNxQixXQUFQLENBQW1CbkMsRUFBRSxDQUFDb0MsRUFBSCxDQUFNSCxDQUFOLEVBQVNDLENBQVQsQ0FBbkI7QUFDSDtBQUNKO0FBQ0osR0E1Q3NCO0FBOEN2QkcsRUFBQUEsZ0JBQWdCLEVBQUUsNEJBQVc7QUFDekIsUUFBSSxLQUFLeEIsU0FBVCxFQUFvQjtBQUNoQixVQUFJQyxNQUFNLEdBQUcsS0FBS0QsU0FBTCxDQUFlRSxJQUE1QjtBQUVBLFVBQUksQ0FBQ0QsTUFBTCxFQUFhO0FBRWIsVUFBSXdCLGlCQUFpQixHQUFHeEIsTUFBTSxDQUFDSyxjQUFQLEVBQXhCO0FBQ0EsVUFBSUMsVUFBVSxHQUFHTixNQUFNLENBQUNHLGNBQVAsRUFBakI7QUFDQSxVQUFJc0IsY0FBYyxHQUFHekIsTUFBTSxDQUFDMEIsV0FBUCxFQUFyQjtBQUVBLFVBQUlDLFdBQVcsR0FBR3pDLEVBQUUsQ0FBQ29DLEVBQUgsQ0FBTSxDQUFOLEVBQVMsR0FBVCxDQUFsQjtBQUNBLFVBQUlNLFFBQVEsR0FBRzlDLElBQUksQ0FBQytDLE9BQUwsQ0FBYSxLQUFLRCxRQUFsQixDQUFmO0FBQ0EsVUFBSUUsV0FBVyxHQUFHLEtBQUtmLFdBQUwsR0FBbUJhLFFBQXJDO0FBQ0EsVUFBSUcsZ0JBQUo7QUFDQSxVQUFJQyxVQUFKO0FBQ0EsVUFBSUMsV0FBSjs7QUFDQSxjQUFRLEtBQUtwQixJQUFiO0FBQ0ksYUFBSzVCLElBQUksQ0FBQ0csVUFBVjtBQUNJLGNBQUksS0FBSzhDLE9BQVQsRUFBa0I7QUFDZFAsWUFBQUEsV0FBVyxHQUFHekMsRUFBRSxDQUFDb0MsRUFBSCxDQUFNLENBQU4sRUFBUyxHQUFULENBQWQ7QUFDSDs7QUFDRFMsVUFBQUEsZ0JBQWdCLEdBQUc3QyxFQUFFLENBQUNpRCxJQUFILENBQVFMLFdBQVIsRUFBcUJ4QixVQUFVLENBQUNXLE1BQWhDLENBQW5CO0FBQ0FlLFVBQUFBLFVBQVUsR0FBRyxLQUFLakIsV0FBbEI7QUFDQWtCLFVBQUFBLFdBQVcsR0FBRzNCLFVBQVUsQ0FBQ1csTUFBekI7QUFDQTs7QUFDSixhQUFLaEMsSUFBSSxDQUFDSSxRQUFWO0FBQ0ksY0FBSSxLQUFLNkMsT0FBVCxFQUFrQjtBQUNkUCxZQUFBQSxXQUFXLEdBQUd6QyxFQUFFLENBQUNvQyxFQUFILENBQU0sR0FBTixFQUFXLENBQVgsQ0FBZDtBQUNILFdBRkQsTUFFTztBQUNISyxZQUFBQSxXQUFXLEdBQUd6QyxFQUFFLENBQUNvQyxFQUFILENBQU0sR0FBTixFQUFXLENBQVgsQ0FBZDtBQUNIOztBQUNEUyxVQUFBQSxnQkFBZ0IsR0FBRzdDLEVBQUUsQ0FBQ2lELElBQUgsQ0FBUTdCLFVBQVUsQ0FBQ1UsS0FBbkIsRUFBMEJjLFdBQTFCLENBQW5CO0FBQ0FFLFVBQUFBLFVBQVUsR0FBRzFCLFVBQVUsQ0FBQ1UsS0FBeEI7QUFDQWlCLFVBQUFBLFdBQVcsR0FBRyxLQUFLbEIsV0FBbkI7QUFDQTtBQWxCUixPQWZnQixDQW9DaEI7OztBQUNBLFVBQUksS0FBS0YsSUFBTCxLQUFjNUIsSUFBSSxDQUFDSyxNQUF2QixFQUErQjtBQUMzQixZQUFJLEtBQUtTLFNBQUwsQ0FBZXFDLElBQWYsS0FBd0JsRCxFQUFFLENBQUN3QixNQUFILENBQVUyQixJQUFWLENBQWUvQyxNQUEzQyxFQUFtRDtBQUMvQ0osVUFBQUEsRUFBRSxDQUFDb0QsSUFBSCxDQUFRLHNFQUFSO0FBQ0gsU0FGRCxNQUVPO0FBQ0gsY0FBSSxLQUFLSixPQUFULEVBQWtCO0FBQ2RKLFlBQUFBLFdBQVcsR0FBR0EsV0FBVyxHQUFHLENBQUMsQ0FBN0I7QUFDSDs7QUFDRCxlQUFLL0IsU0FBTCxDQUFlbUIsU0FBZixHQUEyQlksV0FBM0I7QUFDSDtBQUNKLE9BVEQsTUFTTztBQUNILFlBQUksS0FBSy9CLFNBQUwsQ0FBZXFDLElBQWYsS0FBd0JsRCxFQUFFLENBQUN3QixNQUFILENBQVUyQixJQUFWLENBQWUvQyxNQUEzQyxFQUFtRDtBQUUvQyxjQUFJaUQsYUFBYSxHQUFHWixXQUFXLENBQUNSLENBQVosR0FBZ0JLLGlCQUFpQixDQUFDTCxDQUF0RDtBQUNBLGNBQUlxQixhQUFhLEdBQUdiLFdBQVcsQ0FBQ1AsQ0FBWixHQUFnQkksaUJBQWlCLENBQUNKLENBQXREO0FBQ0EsY0FBSXFCLGFBQWEsR0FBR3ZELEVBQUUsQ0FBQ29DLEVBQUgsQ0FBTVUsVUFBVSxHQUFHTyxhQUFuQixFQUFrQ04sV0FBVyxHQUFHTyxhQUFoRCxDQUFwQjtBQUVBeEMsVUFBQUEsTUFBTSxDQUFDcUIsV0FBUCxDQUFtQkksY0FBYyxDQUFDTixDQUFmLEdBQW1Cc0IsYUFBYSxDQUFDdEIsQ0FBcEQsRUFBdURNLGNBQWMsQ0FBQ0wsQ0FBZixHQUFtQnFCLGFBQWEsQ0FBQ3JCLENBQXhGO0FBRUFwQixVQUFBQSxNQUFNLENBQUMwQyxjQUFQLENBQXNCZixXQUF0QjtBQUNBM0IsVUFBQUEsTUFBTSxDQUFDUSxjQUFQLENBQXNCdUIsZ0JBQXRCO0FBQ0gsU0FWRCxNQVVPO0FBQ0g3QyxVQUFBQSxFQUFFLENBQUNvRCxJQUFILENBQVEsOEVBQVI7QUFDSDtBQUNKO0FBSUo7QUFDSixHQWhIc0I7QUFrSHZCSyxFQUFBQSxVQUFVLEVBQUU7QUFDUjtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ1E1QyxJQUFBQSxTQUFTLEVBQUU7QUFDUCxpQkFBUyxJQURGO0FBRVBxQyxNQUFBQSxJQUFJLEVBQUVsRCxFQUFFLENBQUN3QixNQUZGO0FBR1BrQyxNQUFBQSxPQUFPLEVBQUVDLE1BQU0sSUFBSSxvQ0FIWjtBQUlQQyxNQUFBQSxNQUFNLEVBQUUsa0JBQVc7QUFDZixhQUFLaEQsY0FBTDtBQUNILE9BTk07QUFPUGlELE1BQUFBLFVBQVUsRUFBRTtBQVBMLEtBTkg7O0FBZ0JSO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDUWxDLElBQUFBLElBQUksRUFBRTtBQUNGLGlCQUFTNUIsSUFBSSxDQUFDRyxVQURaO0FBRUZnRCxNQUFBQSxJQUFJLEVBQUVuRCxJQUZKO0FBR0YyRCxNQUFBQSxPQUFPLEVBQUVDLE1BQU0sSUFBSSw4QkFIakI7QUFJRkMsTUFBQUEsTUFBTSxFQUFFLGtCQUFXO0FBQ2YsWUFBSSxLQUFLL0MsU0FBVCxFQUFvQjtBQUNoQixjQUFJQyxNQUFNLEdBQUcsS0FBS0QsU0FBTCxDQUFlRSxJQUE1QjtBQUNBLGNBQUksQ0FBQ0QsTUFBTCxFQUFhO0FBRWIsY0FBSU0sVUFBVSxHQUFHTixNQUFNLENBQUNHLGNBQVAsRUFBakI7O0FBQ0EsY0FBSSxLQUFLVSxJQUFMLEtBQWM1QixJQUFJLENBQUNHLFVBQXZCLEVBQW1DO0FBQy9CLGlCQUFLMkIsV0FBTCxHQUFtQlQsVUFBVSxDQUFDVSxLQUE5QjtBQUNILFdBRkQsTUFFTyxJQUFJLEtBQUtILElBQUwsS0FBYzVCLElBQUksQ0FBQ0ksUUFBdkIsRUFBaUM7QUFDcEMsaUJBQUswQixXQUFMLEdBQW1CVCxVQUFVLENBQUNXLE1BQTlCO0FBQ0gsV0FGTSxNQUVBLElBQUksS0FBS0osSUFBTCxLQUFjNUIsSUFBSSxDQUFDSyxNQUF2QixFQUErQjtBQUNsQyxpQkFBS3lCLFdBQUwsR0FBbUIsS0FBS2hCLFNBQUwsQ0FBZW1CLFNBQWxDO0FBQ0g7QUFDSjtBQUNKLE9BbEJDO0FBbUJGNkIsTUFBQUEsVUFBVSxFQUFFO0FBbkJWLEtBckJFO0FBMkNSQyxJQUFBQSxjQUFjLEVBQUUsQ0EzQ1I7O0FBNENSO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDUWpDLElBQUFBLFdBQVcsRUFBRTtBQUNUa0MsTUFBQUEsS0FBSyxFQUFFLENBQUMsQ0FBRCxFQUFJQyxNQUFNLENBQUNDLFNBQVgsQ0FERTtBQUVUUCxNQUFBQSxPQUFPLEVBQUVDLE1BQU0sSUFBSSxzQ0FGVjtBQUdUTyxNQUFBQSxHQUFHLEVBQUUsZUFBWTtBQUNiLGVBQU8sS0FBS0osY0FBWjtBQUNILE9BTFE7QUFNVEssTUFBQUEsR0FBRyxFQUFFLGFBQVNDLEtBQVQsRUFBZ0I7QUFDakIsWUFBSSxLQUFLekMsSUFBTCxLQUFjNUIsSUFBSSxDQUFDSyxNQUF2QixFQUErQjtBQUMzQmdFLFVBQUFBLEtBQUssR0FBR3hFLElBQUksQ0FBQytDLE9BQUwsQ0FBYXlCLEtBQWIsQ0FBUjtBQUNIOztBQUNELGFBQUtOLGNBQUwsR0FBc0JNLEtBQXRCOztBQUNBLGFBQUsvQixnQkFBTDtBQUNIO0FBWlEsS0FqREw7O0FBZ0VSO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDUUssSUFBQUEsUUFBUSxFQUFFO0FBQ04saUJBQVMsQ0FESDtBQUVOUSxNQUFBQSxJQUFJLEVBQUVsRCxFQUFFLENBQUNxRSxLQUZIO0FBR05OLE1BQUFBLEtBQUssRUFBRSxDQUFDLENBQUQsRUFBSSxDQUFKLEVBQU8sR0FBUCxDQUhEO0FBSU5PLE1BQUFBLEtBQUssRUFBRSxJQUpEO0FBS05aLE1BQUFBLE9BQU8sRUFBRUMsTUFBTSxJQUFJLGtDQUxiO0FBTU5DLE1BQUFBLE1BQU0sRUFBRSxrQkFBVztBQUNmLGFBQUt2QixnQkFBTDtBQUNIO0FBUkssS0FyRUY7O0FBZ0ZSO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDUVcsSUFBQUEsT0FBTyxFQUFFO0FBQ0wsaUJBQVMsS0FESjtBQUVMVSxNQUFBQSxPQUFPLEVBQUVDLE1BQU0sSUFBSSxpQ0FGZDtBQUdMQyxNQUFBQSxNQUFNLEVBQUUsa0JBQVc7QUFDZixZQUFJLEtBQUsvQyxTQUFULEVBQW9CO0FBQ2hCLGVBQUtBLFNBQUwsQ0FBZTBELFNBQWYsR0FBMkIsSUFBSSxLQUFLMUQsU0FBTCxDQUFlMEQsU0FBOUM7QUFDSDs7QUFDRCxhQUFLbEMsZ0JBQUw7QUFDSCxPQVJJO0FBU0x3QixNQUFBQSxVQUFVLEVBQUU7QUFUUDtBQXJGRCxHQWxIVztBQW9OdkJXLEVBQUFBLE9BQU8sRUFBRTtBQUNMekUsSUFBQUEsSUFBSSxFQUFFQTtBQUREO0FBcE5jLENBQVQsQ0FBbEI7QUEwTkFDLEVBQUUsQ0FBQ0ssV0FBSCxHQUFpQm9FLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQnJFLFdBQWxDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuIENvcHlyaWdodCAoYykgMjAxMy0yMDE2IENodWtvbmcgVGVjaG5vbG9naWVzIEluYy5cclxuIENvcHlyaWdodCAoYykgMjAxNy0yMDE4IFhpYW1lbiBZYWppIFNvZnR3YXJlIENvLiwgTHRkLlxyXG5cclxuIGh0dHBzOi8vd3d3LmNvY29zLmNvbS9cclxuXHJcbiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGVuZ2luZSBzb3VyY2UgY29kZSAodGhlIFwiU29mdHdhcmVcIiksIGEgbGltaXRlZCxcclxuICB3b3JsZHdpZGUsIHJveWFsdHktZnJlZSwgbm9uLWFzc2lnbmFibGUsIHJldm9jYWJsZSBhbmQgbm9uLWV4Y2x1c2l2ZSBsaWNlbnNlXHJcbiB0byB1c2UgQ29jb3MgQ3JlYXRvciBzb2xlbHkgdG8gZGV2ZWxvcCBnYW1lcyBvbiB5b3VyIHRhcmdldCBwbGF0Zm9ybXMuIFlvdSBzaGFsbFxyXG4gIG5vdCB1c2UgQ29jb3MgQ3JlYXRvciBzb2Z0d2FyZSBmb3IgZGV2ZWxvcGluZyBvdGhlciBzb2Z0d2FyZSBvciB0b29scyB0aGF0J3NcclxuICB1c2VkIGZvciBkZXZlbG9waW5nIGdhbWVzLiBZb3UgYXJlIG5vdCBncmFudGVkIHRvIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsXHJcbiAgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIENvY29zIENyZWF0b3IuXHJcblxyXG4gVGhlIHNvZnR3YXJlIG9yIHRvb2xzIGluIHRoaXMgTGljZW5zZSBBZ3JlZW1lbnQgYXJlIGxpY2Vuc2VkLCBub3Qgc29sZC5cclxuIFhpYW1lbiBZYWppIFNvZnR3YXJlIENvLiwgTHRkLiByZXNlcnZlcyBhbGwgcmlnaHRzIG5vdCBleHByZXNzbHkgZ3JhbnRlZCB0byB5b3UuXHJcblxyXG4gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbiBUSEUgU09GVFdBUkUuXHJcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG5cclxuY29uc3QgbWlzYyA9IHJlcXVpcmUoJy4uL3V0aWxzL21pc2MnKTtcclxuY29uc3QgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9DQ0NvbXBvbmVudCcpO1xyXG5cclxuLyoqXHJcbiAqICEjZW4gRW51bSBmb3IgUHJvZ3Jlc3NCYXIgbW9kZVxyXG4gKiAhI3poIOi/m+W6puadoeaooeW8j1xyXG4gKiBAZW51bSBQcm9ncmVzc0Jhci5Nb2RlXHJcbiAqL1xyXG52YXIgTW9kZSA9IGNjLkVudW0oe1xyXG4gICAgLyoqXHJcbiAgICAgKiAhI2VuIFRPRE9cclxuICAgICAqICEjemgg5rC05bmz5pa55ZCR5qih5byPXHJcbiAgICAgKiBAcHJvcGVydHkge051bWJlcn0gSE9SSVpPTlRBTFxyXG4gICAgICovXHJcbiAgICBIT1JJWk9OVEFMOiAwLFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogISNlbiBUT0RPXHJcbiAgICAgKiAhI3poIOWeguebtOaWueWQkeaooeW8j1xyXG4gICAgICogQHByb3BlcnR5IHtOdW1iZXJ9IFZFUlRJQ0FMXHJcbiAgICAgKi9cclxuICAgIFZFUlRJQ0FMOiAxLFxyXG4gICAgLyoqXHJcbiAgICAgKiAhI2VuIFRPRE9cclxuICAgICAqICEjemgg5aGr5YWF5qih5byPXHJcbiAgICAgKiBAcHJvcGVydHkge051bWJlcn0gRklMTEVEXHJcbiAgICAgKi9cclxuICAgIEZJTExFRDogMixcclxufSk7XHJcblxyXG4vKipcclxuICogISNlblxyXG4gKiBWaXN1YWwgaW5kaWNhdG9yIG9mIHByb2dyZXNzIGluIHNvbWUgb3BlcmF0aW9uLlxyXG4gKiBEaXNwbGF5cyBhIGJhciB0byB0aGUgdXNlciByZXByZXNlbnRpbmcgaG93IGZhciB0aGUgb3BlcmF0aW9uIGhhcyBwcm9ncmVzc2VkLlxyXG4gKiAhI3poXHJcbiAqIOi/m+W6puadoee7hOS7tu+8jOWPr+eUqOS6juaYvuekuuWKoOi9vei1hOa6kOaXtueahOi/m+W6puOAglxyXG4gKiBAY2xhc3MgUHJvZ3Jlc3NCYXJcclxuICogQGV4dGVuZHMgQ29tcG9uZW50XHJcbiAqIEBleGFtcGxlXHJcbiAqIC8vIHVwZGF0ZSBwcm9ncmVzc0JhclxyXG4gKiB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gKiAgICAgdmFyIHByb2dyZXNzID0gcHJvZ3Jlc3NCYXIucHJvZ3Jlc3M7XHJcbiAqICAgICBpZiAocHJvZ3Jlc3MgPiAwKSB7XHJcbiAqICAgICAgICAgcHJvZ3Jlc3MgKz0gZHQ7XHJcbiAqICAgICB9XHJcbiAqICAgICBlbHNlIHtcclxuICogICAgICAgICBwcm9ncmVzcyA9IDE7XHJcbiAqICAgICB9XHJcbiAqICAgICBwcm9ncmVzc0Jhci5wcm9ncmVzcyA9IHByb2dyZXNzO1xyXG4gKiB9XHJcbiAqXHJcbiAqL1xyXG52YXIgUHJvZ3Jlc3NCYXIgPSBjYy5DbGFzcyh7XHJcbiAgICBuYW1lOiAnY2MuUHJvZ3Jlc3NCYXInLFxyXG4gICAgZXh0ZW5kczogQ29tcG9uZW50LFxyXG5cclxuICAgIGVkaXRvcjogQ0NfRURJVE9SICYmIHtcclxuICAgICAgICBtZW51OiAnaTE4bjpNQUlOX01FTlUuY29tcG9uZW50LnVpL1Byb2dyZXNzQmFyJyxcclxuICAgICAgICBoZWxwOiAnaTE4bjpDT01QT05FTlQuaGVscF91cmwucHJvZ3Jlc3NiYXInLFxyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdEJhclNwcml0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYmFyU3ByaXRlKSB7XHJcbiAgICAgICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLmJhclNwcml0ZS5ub2RlO1xyXG4gICAgICAgICAgICBpZiAoIWVudGl0eSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgdmFyIG5vZGVTaXplID0gdGhpcy5ub2RlLmdldENvbnRlbnRTaXplKCk7XHJcbiAgICAgICAgICAgIHZhciBub2RlQW5jaG9yID0gdGhpcy5ub2RlLmdldEFuY2hvclBvaW50KCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgZW50aXR5U2l6ZSA9IGVudGl0eS5nZXRDb250ZW50U2l6ZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYoZW50aXR5LnBhcmVudCA9PT0gdGhpcy5ub2RlKXtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5zZXRDb250ZW50U2l6ZShlbnRpdHlTaXplKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuYmFyU3ByaXRlLmZpbGxUeXBlID09PSBjYy5TcHJpdGUuRmlsbFR5cGUuUkFESUFMKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGUgPSBNb2RlLkZJTExFRDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGJhclNwcml0ZVNpemUgPSBlbnRpdHkuZ2V0Q29udGVudFNpemUoKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gTW9kZS5IT1JJWk9OVEFMKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsTGVuZ3RoID0gYmFyU3ByaXRlU2l6ZS53aWR0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHRoaXMubW9kZSA9PT0gTW9kZS5WRVJUSUNBTCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3RhbExlbmd0aCA9IGJhclNwcml0ZVNpemUuaGVpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3RhbExlbmd0aCA9IHRoaXMuYmFyU3ByaXRlLmZpbGxSYW5nZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoZW50aXR5LnBhcmVudCA9PT0gdGhpcy5ub2RlKXtcclxuICAgICAgICAgICAgICAgIHZhciB4ID0gLSBub2RlU2l6ZS53aWR0aCAqIG5vZGVBbmNob3IueDtcclxuICAgICAgICAgICAgICAgIHZhciB5ID0gMDtcclxuICAgICAgICAgICAgICAgIGVudGl0eS5zZXRQb3NpdGlvbihjYy52Mih4LCB5KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF91cGRhdGVCYXJTdGF0dXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmJhclNwcml0ZSkge1xyXG4gICAgICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5iYXJTcHJpdGUubm9kZTtcclxuXHJcbiAgICAgICAgICAgIGlmICghZW50aXR5KSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICB2YXIgZW50aXR5QW5jaG9yUG9pbnQgPSBlbnRpdHkuZ2V0QW5jaG9yUG9pbnQoKTtcclxuICAgICAgICAgICAgdmFyIGVudGl0eVNpemUgPSBlbnRpdHkuZ2V0Q29udGVudFNpemUoKTtcclxuICAgICAgICAgICAgdmFyIGVudGl0eVBvc2l0aW9uID0gZW50aXR5LmdldFBvc2l0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgYW5jaG9yUG9pbnQgPSBjYy52MigwLCAwLjUpO1xyXG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSBtaXNjLmNsYW1wMDEodGhpcy5wcm9ncmVzcyk7XHJcbiAgICAgICAgICAgIHZhciBhY3R1YWxMZW50aCA9IHRoaXMudG90YWxMZW5ndGggKiBwcm9ncmVzcztcclxuICAgICAgICAgICAgdmFyIGZpbmFsQ29udGVudFNpemU7XHJcbiAgICAgICAgICAgIHZhciB0b3RhbFdpZHRoO1xyXG4gICAgICAgICAgICB2YXIgdG90YWxIZWlnaHQ7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIE1vZGUuSE9SSVpPTlRBTDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXZlcnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvclBvaW50ID0gY2MudjIoMSwgMC41KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxDb250ZW50U2l6ZSA9IGNjLnNpemUoYWN0dWFsTGVudGgsIGVudGl0eVNpemUuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbFdpZHRoID0gdGhpcy50b3RhbExlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEhlaWdodCA9IGVudGl0eVNpemUuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBNb2RlLlZFUlRJQ0FMOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJldmVyc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yUG9pbnQgPSBjYy52MigwLjUsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvclBvaW50ID0gY2MudjIoMC41LCAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxDb250ZW50U2l6ZSA9IGNjLnNpemUoZW50aXR5U2l6ZS53aWR0aCwgYWN0dWFsTGVudGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsV2lkdGggPSBlbnRpdHlTaXplLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsSGVpZ2h0ID0gdGhpcy50b3RhbExlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy9oYW5kbGluZyBmaWxsZWQgbW9kZVxyXG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlID09PSBNb2RlLkZJTExFRCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYmFyU3ByaXRlLnR5cGUgIT09IGNjLlNwcml0ZS5UeXBlLkZJTExFRCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLndhcm4oJ1Byb2dyZXNzQmFyIEZJTExFRCBtb2RlIG9ubHkgd29ya3Mgd2hlbiBiYXJTcHJpdGVcXCdzIFR5cGUgaXMgRklMTEVEIScpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXZlcnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdHVhbExlbnRoID0gYWN0dWFsTGVudGggKiAtMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iYXJTcHJpdGUuZmlsbFJhbmdlID0gYWN0dWFsTGVudGg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5iYXJTcHJpdGUudHlwZSAhPT0gY2MuU3ByaXRlLlR5cGUuRklMTEVEKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhbmNob3JPZmZzZXRYID0gYW5jaG9yUG9pbnQueCAtIGVudGl0eUFuY2hvclBvaW50Lng7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuY2hvck9mZnNldFkgPSBhbmNob3JQb2ludC55IC0gZW50aXR5QW5jaG9yUG9pbnQueTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxQb3NpdGlvbiA9IGNjLnYyKHRvdGFsV2lkdGggKiBhbmNob3JPZmZzZXRYLCB0b3RhbEhlaWdodCAqIGFuY2hvck9mZnNldFkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc2V0UG9zaXRpb24oZW50aXR5UG9zaXRpb24ueCArIGZpbmFsUG9zaXRpb24ueCwgZW50aXR5UG9zaXRpb24ueSArIGZpbmFsUG9zaXRpb24ueSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS5zZXRBbmNob3JQb2ludChhbmNob3JQb2ludCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5LnNldENvbnRlbnRTaXplKGZpbmFsQ29udGVudFNpemUpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy53YXJuKCdQcm9ncmVzc0JhciBub24tRklMTEVEIG1vZGUgb25seSB3b3JrcyB3aGVuIGJhclNwcml0ZVxcJ3MgVHlwZSBpcyBub24tRklMTEVEIScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogISNlbiBUaGUgdGFyZ2V0ZWQgU3ByaXRlIHdoaWNoIHdpbGwgYmUgY2hhbmdlZCBwcm9ncmVzc2l2ZWx5LlxyXG4gICAgICAgICAqICEjemgg55So5p2l5pi+56S66L+b5bqm5p2h5q+U5L6L55qEIFNwcml0ZSDlr7nosaHjgIJcclxuICAgICAgICAgKiBAcHJvcGVydHkge1Nwcml0ZX0gYmFyU3ByaXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYmFyU3ByaXRlOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlNwcml0ZSxcclxuICAgICAgICAgICAgdG9vbHRpcDogQ0NfREVWICYmICdpMThuOkNPTVBPTkVOVC5wcm9ncmVzcy5iYXJfc3ByaXRlJyxcclxuICAgICAgICAgICAgbm90aWZ5OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2luaXRCYXJTcHJpdGUoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYW5pbWF0YWJsZTogZmFsc2VcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAhI2VuIFRoZSBwcm9ncmVzcyBtb2RlLCB0aGVyZSBhcmUgdHdvIG1vZGVzIHN1cHBvcnRlZCBub3c6IGhvcml6b250YWwgYW5kIHZlcnRpY2FsLlxyXG4gICAgICAgICAqICEjemgg6L+b5bqm5p2h55qE5qih5byPXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtQcm9ncmVzc0Jhci5Nb2RlfSBtb2RlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbW9kZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBNb2RlLkhPUklaT05UQUwsXHJcbiAgICAgICAgICAgIHR5cGU6IE1vZGUsXHJcbiAgICAgICAgICAgIHRvb2x0aXA6IENDX0RFViAmJiAnaTE4bjpDT01QT05FTlQucHJvZ3Jlc3MubW9kZScsXHJcbiAgICAgICAgICAgIG5vdGlmeTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5iYXJTcHJpdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5iYXJTcHJpdGUubm9kZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWVudGl0eSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZW50aXR5U2l6ZSA9IGVudGl0eS5nZXRDb250ZW50U2l6ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgPT09IE1vZGUuSE9SSVpPTlRBTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvdGFsTGVuZ3RoID0gZW50aXR5U2l6ZS53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PT0gTW9kZS5WRVJUSUNBTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvdGFsTGVuZ3RoID0gZW50aXR5U2l6ZS5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGUgPT09IE1vZGUuRklMTEVEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG90YWxMZW5ndGggPSB0aGlzLmJhclNwcml0ZS5maWxsUmFuZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBhbmltYXRhYmxlOiBmYWxzZVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9OJHRvdGFsTGVuZ3RoOiAxLFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICEjZW4gVGhlIHRvdGFsIHdpZHRoIG9yIGhlaWdodCBvZiB0aGUgYmFyIHNwcml0ZS5cclxuICAgICAgICAgKiAhI3poIOi/m+W6puadoeWunumZheeahOaAu+mVv+W6plxyXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSB0b3RhbExlbmd0aFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvdGFsTGVuZ3RoOiB7XHJcbiAgICAgICAgICAgIHJhbmdlOiBbMCwgTnVtYmVyLk1BWF9WQUxVRV0sXHJcbiAgICAgICAgICAgIHRvb2x0aXA6IENDX0RFViAmJiAnaTE4bjpDT01QT05FTlQucHJvZ3Jlc3MudG90YWxfbGVuZ3RoJyxcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fTiR0b3RhbExlbmd0aDtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gTW9kZS5GSUxMRUQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG1pc2MuY2xhbXAwMSh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9OJHRvdGFsTGVuZ3RoID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVCYXJTdGF0dXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICEjZW4gVGhlIGN1cnJlbnQgcHJvZ3Jlc3Mgb2YgdGhlIGJhciBzcHJpdGUuIFRoZSB2YWxpZCB2YWx1ZSBpcyBiZXR3ZWVuIDAtMS5cclxuICAgICAgICAgKiAhI3poIOW9k+WJjei/m+W6puWAvO+8jOivpeaVsOWAvOeahOWMuumXtOaYryAwLTEg5LmL6Ze044CCXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtOdW1iZXJ9IHByb2dyZXNzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcHJvZ3Jlc3M6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogMSxcclxuICAgICAgICAgICAgdHlwZTogY2MuRmxvYXQsXHJcbiAgICAgICAgICAgIHJhbmdlOiBbMCwgMSwgMC4xXSxcclxuICAgICAgICAgICAgc2xpZGU6IHRydWUsXHJcbiAgICAgICAgICAgIHRvb2x0aXA6IENDX0RFViAmJiAnaTE4bjpDT01QT05FTlQucHJvZ3Jlc3MucHJvZ3Jlc3MnLFxyXG4gICAgICAgICAgICBub3RpZnk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQmFyU3RhdHVzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAhI2VuIFdoZXRoZXIgcmV2ZXJzZSB0aGUgcHJvZ3Jlc3MgZGlyZWN0aW9uIG9mIHRoZSBiYXIgc3ByaXRlLlxyXG4gICAgICAgICAqICEjemgg6L+b5bqm5p2h5piv5ZCm6L+b6KGM5Y+N5pa55ZCR5Y+Y5YyW44CCXHJcbiAgICAgICAgICogQHByb3BlcnR5IHtCb29sZWFufSByZXZlcnNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmV2ZXJzZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSxcclxuICAgICAgICAgICAgdG9vbHRpcDogQ0NfREVWICYmICdpMThuOkNPTVBPTkVOVC5wcm9ncmVzcy5yZXZlcnNlJyxcclxuICAgICAgICAgICAgbm90aWZ5OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmJhclNwcml0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmFyU3ByaXRlLmZpbGxTdGFydCA9IDEgLSB0aGlzLmJhclNwcml0ZS5maWxsU3RhcnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVCYXJTdGF0dXMoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYW5pbWF0YWJsZTogZmFsc2VcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHN0YXRpY3M6IHtcclxuICAgICAgICBNb2RlOiBNb2RlXHJcbiAgICB9XHJcbn0pO1xyXG5cclxuXHJcbmNjLlByb2dyZXNzQmFyID0gbW9kdWxlLmV4cG9ydHMgPSBQcm9ncmVzc0JhcjtcclxuIl0sInNvdXJjZVJvb3QiOiIvIn0=