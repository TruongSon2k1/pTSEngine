
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/asset-manager/config.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

/****************************************************************************
 Copyright (c) 2019 Xiamen Yaji Software Co., Ltd.

 https://www.cocos.com/

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated engine source code (the "Software"), a limited,
  worldwide, royalty-free, non-assignable, revocable and non-exclusive license
 to use Cocos Creator solely to develop games on your target platforms. You shall
  not use Cocos Creator software for developing other software or tools that's
  used for developing games. You are not granted to publish, distribute,
  sublicense, and/or sell copies of Cocos Creator.

 The software or tools in this License Agreement are licensed, not sold.
 Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 ****************************************************************************/
var js = require('../platform/js');

var Cache = require('./cache');

var _require = require('./helper'),
    normalize = _require.normalize;

var _require2 = require('./utilities'),
    processOptions = _require2.processOptions;

function Config() {
  this.name = '';
  this.base = '';
  this.importBase = '';
  this.nativeBase = '';
  this.deps = null;
  this.assetInfos = new Cache();
  this.scenes = new Cache();
  this.paths = new Cache();
}

Config.prototype = {
  constructor: Config,
  init: function init(options) {
    processOptions(options);
    this.importBase = options.importBase || '';
    this.nativeBase = options.nativeBase || '';
    this.base = options.base || '';
    this.name = options.name || '';
    this.deps = options.deps || []; // init

    this._initUuid(options.uuids);

    this._initPath(options.paths);

    this._initScene(options.scenes);

    this._initPackage(options.packs);

    this._initVersion(options.versions);

    this._initRedirect(options.redirect);
  },
  _initUuid: function _initUuid(uuidList) {
    if (!uuidList) return;
    this.assetInfos.clear();

    for (var i = 0, l = uuidList.length; i < l; i++) {
      var uuid = uuidList[i];
      this.assetInfos.add(uuid, {
        uuid: uuid
      });
    }
  },
  _initPath: function _initPath(pathList) {
    if (!pathList) return;
    var paths = this.paths;
    paths.clear();

    for (var uuid in pathList) {
      var info = pathList[uuid];
      var path = info[0];
      var type = info[1];
      var isSubAsset = info.length === 3;
      var assetInfo = this.assetInfos.get(uuid);
      assetInfo.path = path;
      assetInfo.ctor = js._getClassById(type);

      if (paths.has(path)) {
        if (isSubAsset) {
          paths.get(path).push(assetInfo);
        } else {
          paths.get(path).splice(0, 0, assetInfo);
        }
      } else {
        paths.add(path, [assetInfo]);
      }
    }
  },
  _initScene: function _initScene(sceneList) {
    if (!sceneList) return;
    var scenes = this.scenes;
    scenes.clear();
    var assetInfos = this.assetInfos;

    for (var sceneName in sceneList) {
      var uuid = sceneList[sceneName];
      var assetInfo = assetInfos.get(uuid);
      assetInfo.url = sceneName;
      scenes.add(sceneName, assetInfo);
    }
  },
  _initPackage: function _initPackage(packageList) {
    if (!packageList) return;
    var assetInfos = this.assetInfos;

    for (var packUuid in packageList) {
      var uuids = packageList[packUuid];
      var pack = {
        uuid: packUuid,
        packs: uuids,
        ext: '.json'
      };
      assetInfos.add(packUuid, pack);

      for (var i = 0, l = uuids.length; i < l; i++) {
        var uuid = uuids[i];
        var assetInfo = assetInfos.get(uuid);
        var assetPacks = assetInfo.packs;

        if (assetPacks) {
          if (l === 1) {
            assetPacks.splice(0, 0, pack);
          } else {
            assetPacks.push(pack);
          }
        } else {
          assetInfo.packs = [pack];
        }
      }
    }
  },
  _initVersion: function _initVersion(versions) {
    if (!versions) return;
    var assetInfos = this.assetInfos;
    var entries = versions["import"];

    if (entries) {
      for (var i = 0, l = entries.length; i < l; i += 2) {
        var uuid = entries[i];
        var assetInfo = assetInfos.get(uuid);
        assetInfo.ver = entries[i + 1];
      }
    }

    entries = versions["native"];

    if (entries) {
      for (var i = 0, l = entries.length; i < l; i += 2) {
        var uuid = entries[i];
        var assetInfo = assetInfos.get(uuid);
        assetInfo.nativeVer = entries[i + 1];
      }
    }
  },
  _initRedirect: function _initRedirect(redirect) {
    if (!redirect) return;
    var assetInfos = this.assetInfos;

    for (var i = 0, l = redirect.length; i < l; i += 2) {
      var uuid = redirect[i];
      var assetInfo = assetInfos.get(uuid);
      assetInfo.redirect = redirect[i + 1];
    }
  },
  getInfoWithPath: function getInfoWithPath(path, type) {
    if (!path) {
      return null;
    }

    path = normalize(path);
    var items = this.paths.get(path);

    if (items) {
      if (type) {
        for (var i = 0, l = items.length; i < l; i++) {
          var assetInfo = items[i];

          if (js.isChildClassOf(assetInfo.ctor, type)) {
            return assetInfo;
          }
        }
      } else {
        return items[0];
      }
    }

    return null;
  },
  getDirWithPath: function getDirWithPath(path, type, out) {
    path = normalize(path);

    if (path[path.length - 1] === '/') {
      path = path.slice(0, -1);
    }

    var infos = out || [];

    function isMatchByWord(path, test) {
      if (path.length > test.length) {
        var nextAscii = path.charCodeAt(test.length);
        return nextAscii === 47; // '/'
      }

      return true;
    }

    this.paths.forEach(function (items, p) {
      if (p.startsWith(path) && isMatchByWord(p, path) || !path) {
        for (var i = 0, l = items.length; i < l; i++) {
          var entry = items[i];

          if (!type || js.isChildClassOf(entry.ctor, type)) {
            infos.push(entry);
          }
        }
      }
    });
    return infos;
  },
  getAssetInfo: function getAssetInfo(uuid) {
    return this.assetInfos.get(uuid);
  },
  getSceneInfo: function getSceneInfo(name) {
    if (!name.endsWith('.fire')) {
      name += '.fire';
    }

    if (name[0] !== '/' && !name.startsWith('db://')) {
      name = '/' + name; // 使用全名匹配
    } // search scene


    var info = this.scenes.find(function (val, key) {
      return key.endsWith(name);
    });
    return info;
  },
  destroy: function destroy() {
    this.paths.destroy();
    this.scenes.destroy();
    this.assetInfos.destroy();
  }
};

if (CC_TEST) {
  cc._Test.Config = Config;
}

module.exports = Config;
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuZ2luZS1kZXZcXGNvY29zMmRcXGNvcmVcXGFzc2V0LW1hbmFnZXJcXGNvbmZpZy5qcyJdLCJuYW1lcyI6WyJqcyIsInJlcXVpcmUiLCJDYWNoZSIsIm5vcm1hbGl6ZSIsInByb2Nlc3NPcHRpb25zIiwiQ29uZmlnIiwibmFtZSIsImJhc2UiLCJpbXBvcnRCYXNlIiwibmF0aXZlQmFzZSIsImRlcHMiLCJhc3NldEluZm9zIiwic2NlbmVzIiwicGF0aHMiLCJwcm90b3R5cGUiLCJjb25zdHJ1Y3RvciIsImluaXQiLCJvcHRpb25zIiwiX2luaXRVdWlkIiwidXVpZHMiLCJfaW5pdFBhdGgiLCJfaW5pdFNjZW5lIiwiX2luaXRQYWNrYWdlIiwicGFja3MiLCJfaW5pdFZlcnNpb24iLCJ2ZXJzaW9ucyIsIl9pbml0UmVkaXJlY3QiLCJyZWRpcmVjdCIsInV1aWRMaXN0IiwiY2xlYXIiLCJpIiwibCIsImxlbmd0aCIsInV1aWQiLCJhZGQiLCJwYXRoTGlzdCIsImluZm8iLCJwYXRoIiwidHlwZSIsImlzU3ViQXNzZXQiLCJhc3NldEluZm8iLCJnZXQiLCJjdG9yIiwiX2dldENsYXNzQnlJZCIsImhhcyIsInB1c2giLCJzcGxpY2UiLCJzY2VuZUxpc3QiLCJzY2VuZU5hbWUiLCJ1cmwiLCJwYWNrYWdlTGlzdCIsInBhY2tVdWlkIiwicGFjayIsImV4dCIsImFzc2V0UGFja3MiLCJlbnRyaWVzIiwidmVyIiwibmF0aXZlVmVyIiwiZ2V0SW5mb1dpdGhQYXRoIiwiaXRlbXMiLCJpc0NoaWxkQ2xhc3NPZiIsImdldERpcldpdGhQYXRoIiwib3V0Iiwic2xpY2UiLCJpbmZvcyIsImlzTWF0Y2hCeVdvcmQiLCJ0ZXN0IiwibmV4dEFzY2lpIiwiY2hhckNvZGVBdCIsImZvckVhY2giLCJwIiwic3RhcnRzV2l0aCIsImVudHJ5IiwiZ2V0QXNzZXRJbmZvIiwiZ2V0U2NlbmVJbmZvIiwiZW5kc1dpdGgiLCJmaW5kIiwidmFsIiwia2V5IiwiZGVzdHJveSIsIkNDX1RFU1Qi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LE1BQUwsQ0FBWWdFLElBQVosQ0FBaUIsVUFBVUMsR0FBVixFQUFlQyxHQUFmLEVBQW9CO0FBQzVDLGFBQU9BLEdBQUcsQ0FBQ0gsUUFBSixDQUFhckUsSUFBYixDQUFQO0FBQ0gsS0FGVSxDQUFYO0FBR0EsV0FBTzhCLElBQVA7QUFDSCxHQW5NYztBQXFNZjJDLEVBQUFBLE9BQU8sRUFBRSxtQkFBWTtBQUNqQixTQUFLbEUsS0FBTCxDQUFXa0UsT0FBWDtBQUNBLFNBQUtuRSxNQUFMLENBQVltRSxPQUFaO0FBQ0EsU0FBS3BFLFVBQUwsQ0FBZ0JvRSxPQUFoQjtBQUNIO0FBek1jLENBQW5COztBQTRNQSxJQUFJQyxPQUFKLEVBQWE7QUFDVEMsRUFBQUEsRUFBRSxDQUFDQyxLQUFILENBQVM3RSxNQUFULEdBQWtCQSxNQUFsQjtBQUNIOztBQUVEOEUsTUFBTSxDQUFDQyxPQUFQLEdBQWlCL0UsTUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gQ29weXJpZ2h0IChjKSAyMDE5IFhpYW1lbiBZYWppIFNvZnR3YXJlIENvLiwgTHRkLlxyXG5cclxuIGh0dHBzOi8vd3d3LmNvY29zLmNvbS9cclxuXHJcbiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGVuZ2luZSBzb3VyY2UgY29kZSAodGhlIFwiU29mdHdhcmVcIiksIGEgbGltaXRlZCxcclxuICB3b3JsZHdpZGUsIHJveWFsdHktZnJlZSwgbm9uLWFzc2lnbmFibGUsIHJldm9jYWJsZSBhbmQgbm9uLWV4Y2x1c2l2ZSBsaWNlbnNlXHJcbiB0byB1c2UgQ29jb3MgQ3JlYXRvciBzb2xlbHkgdG8gZGV2ZWxvcCBnYW1lcyBvbiB5b3VyIHRhcmdldCBwbGF0Zm9ybXMuIFlvdSBzaGFsbFxyXG4gIG5vdCB1c2UgQ29jb3MgQ3JlYXRvciBzb2Z0d2FyZSBmb3IgZGV2ZWxvcGluZyBvdGhlciBzb2Z0d2FyZSBvciB0b29scyB0aGF0J3NcclxuICB1c2VkIGZvciBkZXZlbG9waW5nIGdhbWVzLiBZb3UgYXJlIG5vdCBncmFudGVkIHRvIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsXHJcbiAgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIENvY29zIENyZWF0b3IuXHJcblxyXG4gVGhlIHNvZnR3YXJlIG9yIHRvb2xzIGluIHRoaXMgTGljZW5zZSBBZ3JlZW1lbnQgYXJlIGxpY2Vuc2VkLCBub3Qgc29sZC5cclxuIFhpYW1lbiBZYWppIFNvZnR3YXJlIENvLiwgTHRkLiByZXNlcnZlcyBhbGwgcmlnaHRzIG5vdCBleHByZXNzbHkgZ3JhbnRlZCB0byB5b3UuXHJcblxyXG4gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbiBUSEUgU09GVFdBUkUuXHJcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG5jb25zdCBqcyA9IHJlcXVpcmUoJy4uL3BsYXRmb3JtL2pzJyk7XHJcbmNvbnN0IENhY2hlID0gcmVxdWlyZSgnLi9jYWNoZScpO1xyXG5jb25zdCB7IG5vcm1hbGl6ZSB9ID0gcmVxdWlyZSgnLi9oZWxwZXInKTtcclxuY29uc3QgeyBwcm9jZXNzT3B0aW9ucyB9ID0gcmVxdWlyZSgnLi91dGlsaXRpZXMnKTtcclxuXHJcbmZ1bmN0aW9uIENvbmZpZyAoKSB7XHJcblxyXG4gICAgdGhpcy5uYW1lID0gJyc7XHJcblxyXG4gICAgdGhpcy5iYXNlID0gJyc7XHJcblxyXG4gICAgdGhpcy5pbXBvcnRCYXNlID0gJyc7XHJcblxyXG4gICAgdGhpcy5uYXRpdmVCYXNlID0gJyc7XHJcblxyXG4gICAgdGhpcy5kZXBzID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLmFzc2V0SW5mb3MgPSBuZXcgQ2FjaGUoKTtcclxuXHJcbiAgICB0aGlzLnNjZW5lcyA9IG5ldyBDYWNoZSgpO1xyXG5cclxuICAgIHRoaXMucGF0aHMgPSBuZXcgQ2FjaGUoKTtcclxufVxyXG5cclxuQ29uZmlnLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcjogQ29uZmlnLFxyXG5cclxuICAgIGluaXQ6IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgcHJvY2Vzc09wdGlvbnMob3B0aW9ucyk7XHJcblxyXG4gICAgICAgIHRoaXMuaW1wb3J0QmFzZSA9IG9wdGlvbnMuaW1wb3J0QmFzZSB8fCAnJztcclxuICAgICAgICB0aGlzLm5hdGl2ZUJhc2UgPSBvcHRpb25zLm5hdGl2ZUJhc2UgfHwgJyc7XHJcbiAgICAgICAgdGhpcy5iYXNlID0gb3B0aW9ucy5iYXNlIHx8ICcnO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG9wdGlvbnMubmFtZSB8fCAnJztcclxuICAgICAgICB0aGlzLmRlcHMgPSBvcHRpb25zLmRlcHMgfHwgW107XHJcbiAgICAgICAgLy8gaW5pdFxyXG4gICAgICAgIHRoaXMuX2luaXRVdWlkKG9wdGlvbnMudXVpZHMpO1xyXG4gICAgICAgIHRoaXMuX2luaXRQYXRoKG9wdGlvbnMucGF0aHMpO1xyXG4gICAgICAgIHRoaXMuX2luaXRTY2VuZShvcHRpb25zLnNjZW5lcyk7XHJcbiAgICAgICAgdGhpcy5faW5pdFBhY2thZ2Uob3B0aW9ucy5wYWNrcyk7XHJcbiAgICAgICAgdGhpcy5faW5pdFZlcnNpb24ob3B0aW9ucy52ZXJzaW9ucyk7XHJcbiAgICAgICAgdGhpcy5faW5pdFJlZGlyZWN0KG9wdGlvbnMucmVkaXJlY3QpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFV1aWQ6IGZ1bmN0aW9uICh1dWlkTGlzdCkge1xyXG4gICAgICAgIGlmICghdXVpZExpc3QpIHJldHVybjtcclxuICAgICAgICB0aGlzLmFzc2V0SW5mb3MuY2xlYXIoKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHV1aWRMaXN0Lmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgdXVpZCA9IHV1aWRMaXN0W2ldO1xyXG4gICAgICAgICAgICB0aGlzLmFzc2V0SW5mb3MuYWRkKHV1aWQsIHt1dWlkfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFBhdGg6IGZ1bmN0aW9uIChwYXRoTGlzdCkge1xyXG4gICAgICAgIGlmICghcGF0aExpc3QpIHJldHVybjtcclxuICAgICAgICB2YXIgcGF0aHMgPSB0aGlzLnBhdGhzO1xyXG4gICAgICAgIHBhdGhzLmNsZWFyKCk7XHJcbiAgICAgICAgZm9yICh2YXIgdXVpZCBpbiBwYXRoTGlzdCkge1xyXG4gICAgICAgICAgICB2YXIgaW5mbyA9IHBhdGhMaXN0W3V1aWRdO1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IGluZm9bMF07XHJcbiAgICAgICAgICAgIHZhciB0eXBlID0gaW5mb1sxXTtcclxuICAgICAgICAgICAgdmFyIGlzU3ViQXNzZXQgPSBpbmZvLmxlbmd0aCA9PT0gMztcclxuXHJcbiAgICAgICAgICAgIHZhciBhc3NldEluZm8gPSB0aGlzLmFzc2V0SW5mb3MuZ2V0KHV1aWQpO1xyXG4gICAgICAgICAgICBhc3NldEluZm8ucGF0aCA9IHBhdGg7XHJcbiAgICAgICAgICAgIGFzc2V0SW5mby5jdG9yID0ganMuX2dldENsYXNzQnlJZCh0eXBlKTtcclxuICAgICAgICAgICAgaWYgKHBhdGhzLmhhcyhwYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzU3ViQXNzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRocy5nZXQocGF0aCkucHVzaChhc3NldEluZm8pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aHMuZ2V0KHBhdGgpLnNwbGljZSgwLCAwLCBhc3NldEluZm8pO1xyXG4gICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBhdGhzLmFkZChwYXRoLCBbYXNzZXRJbmZvXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9pbml0U2NlbmU6IGZ1bmN0aW9uIChzY2VuZUxpc3QpIHtcclxuICAgICAgICBpZiAoIXNjZW5lTGlzdCkgcmV0dXJuO1xyXG4gICAgICAgIHZhciBzY2VuZXMgPSB0aGlzLnNjZW5lcztcclxuICAgICAgICBzY2VuZXMuY2xlYXIoKTtcclxuICAgICAgICB2YXIgYXNzZXRJbmZvcyA9IHRoaXMuYXNzZXRJbmZvcztcclxuICAgICAgICBmb3IgKHZhciBzY2VuZU5hbWUgaW4gc2NlbmVMaXN0KSB7XHJcbiAgICAgICAgICAgIHZhciB1dWlkID0gc2NlbmVMaXN0W3NjZW5lTmFtZV07XHJcbiAgICAgICAgICAgIHZhciBhc3NldEluZm8gPSBhc3NldEluZm9zLmdldCh1dWlkKTtcclxuICAgICAgICAgICAgYXNzZXRJbmZvLnVybCA9IHNjZW5lTmFtZTtcclxuICAgICAgICAgICAgc2NlbmVzLmFkZChzY2VuZU5hbWUsIGFzc2V0SW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFBhY2thZ2U6IGZ1bmN0aW9uIChwYWNrYWdlTGlzdCkge1xyXG4gICAgICAgIGlmICghcGFja2FnZUxpc3QpIHJldHVybjtcclxuICAgICAgICB2YXIgYXNzZXRJbmZvcyA9IHRoaXMuYXNzZXRJbmZvcztcclxuICAgICAgICBmb3IgKHZhciBwYWNrVXVpZCBpbiBwYWNrYWdlTGlzdCkge1xyXG4gICAgICAgICAgICB2YXIgdXVpZHMgPSBwYWNrYWdlTGlzdFtwYWNrVXVpZF07XHJcbiAgICAgICAgICAgIHZhciBwYWNrID0ge3V1aWQ6IHBhY2tVdWlkLCBwYWNrczogdXVpZHMsIGV4dDonLmpzb24nfTtcclxuICAgICAgICAgICAgYXNzZXRJbmZvcy5hZGQocGFja1V1aWQsIHBhY2spO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSB1dWlkcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciB1dWlkID0gdXVpZHNbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgYXNzZXRJbmZvID0gYXNzZXRJbmZvcy5nZXQodXVpZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXNzZXRQYWNrcyA9IGFzc2V0SW5mby5wYWNrcztcclxuICAgICAgICAgICAgICAgIGlmIChhc3NldFBhY2tzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGwgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRQYWNrcy5zcGxpY2UoMCwgMCwgcGFjayk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldFBhY2tzLnB1c2gocGFjayk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXRJbmZvLnBhY2tzID0gW3BhY2tdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFZlcnNpb246IGZ1bmN0aW9uICh2ZXJzaW9ucykge1xyXG4gICAgICAgIGlmICghdmVyc2lvbnMpIHJldHVybjtcclxuICAgICAgICB2YXIgYXNzZXRJbmZvcyA9IHRoaXMuYXNzZXRJbmZvcztcclxuICAgICAgICB2YXIgZW50cmllcyA9IHZlcnNpb25zLmltcG9ydDtcclxuICAgICAgICBpZiAoZW50cmllcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGVudHJpZXMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXVpZCA9IGVudHJpZXNbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgYXNzZXRJbmZvID0gYXNzZXRJbmZvcy5nZXQodXVpZCk7XHJcbiAgICAgICAgICAgICAgICBhc3NldEluZm8udmVyID0gZW50cmllc1tpICsgMV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZW50cmllcyA9IHZlcnNpb25zLm5hdGl2ZTtcclxuICAgICAgICBpZiAoZW50cmllcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGVudHJpZXMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXVpZCA9IGVudHJpZXNbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgYXNzZXRJbmZvID0gYXNzZXRJbmZvcy5nZXQodXVpZCk7XHJcbiAgICAgICAgICAgICAgICBhc3NldEluZm8ubmF0aXZlVmVyID0gZW50cmllc1tpICsgMV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9pbml0UmVkaXJlY3Q6IGZ1bmN0aW9uIChyZWRpcmVjdCkge1xyXG4gICAgICAgIGlmICghcmVkaXJlY3QpIHJldHVybjtcclxuICAgICAgICB2YXIgYXNzZXRJbmZvcyA9IHRoaXMuYXNzZXRJbmZvcztcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHJlZGlyZWN0Lmxlbmd0aDsgaSA8IGw7IGkgKz0gMikge1xyXG4gICAgICAgICAgICB2YXIgdXVpZCA9IHJlZGlyZWN0W2ldO1xyXG4gICAgICAgICAgICB2YXIgYXNzZXRJbmZvID0gYXNzZXRJbmZvcy5nZXQodXVpZCk7XHJcbiAgICAgICAgICAgIGFzc2V0SW5mby5yZWRpcmVjdCA9IHJlZGlyZWN0W2kgKyAxXTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGdldEluZm9XaXRoUGF0aDogZnVuY3Rpb24gKHBhdGgsIHR5cGUpIHtcclxuXHJcbiAgICAgICAgaWYgKCFwYXRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwYXRoID0gbm9ybWFsaXplKHBhdGgpO1xyXG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMucGF0aHMuZ2V0KHBhdGgpO1xyXG4gICAgICAgIGlmIChpdGVtcykge1xyXG4gICAgICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBpdGVtcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXNzZXRJbmZvID0gaXRlbXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpzLmlzQ2hpbGRDbGFzc09mKGFzc2V0SW5mby5jdG9yLCB0eXBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXNzZXRJbmZvO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtc1swXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0RGlyV2l0aFBhdGg6IGZ1bmN0aW9uIChwYXRoLCB0eXBlLCBvdXQpIHtcclxuICAgICAgICBwYXRoID0gbm9ybWFsaXplKHBhdGgpO1xyXG4gICAgICAgIGlmIChwYXRoW3BhdGgubGVuZ3RoIC0gMV0gPT09ICcvJykge1xyXG4gICAgICAgICAgICBwYXRoID0gcGF0aC5zbGljZSgwLCAtMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaW5mb3MgPSBvdXQgfHwgW107XHJcbiAgICAgICAgZnVuY3Rpb24gaXNNYXRjaEJ5V29yZCAocGF0aCwgdGVzdCkge1xyXG4gICAgICAgICAgICBpZiAocGF0aC5sZW5ndGggPiB0ZXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5leHRBc2NpaSA9IHBhdGguY2hhckNvZGVBdCh0ZXN0Lmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV4dEFzY2lpID09PSA0NzsgLy8gJy8nXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucGF0aHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbXMsIHApIHtcclxuICAgICAgICAgICAgaWYgKChwLnN0YXJ0c1dpdGgocGF0aCkgJiYgaXNNYXRjaEJ5V29yZChwLCBwYXRoKSkgfHwgIXBhdGgpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gaXRlbXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVudHJ5ID0gaXRlbXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0eXBlIHx8IGpzLmlzQ2hpbGRDbGFzc09mKGVudHJ5LmN0b3IsIHR5cGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9zLnB1c2goZW50cnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gaW5mb3M7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldEFzc2V0SW5mbzogZnVuY3Rpb24gKHV1aWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hc3NldEluZm9zLmdldCh1dWlkKTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0U2NlbmVJbmZvOiBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIGlmICghbmFtZS5lbmRzV2l0aCgnLmZpcmUnKSkge1xyXG4gICAgICAgICAgICBuYW1lICs9ICcuZmlyZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuYW1lWzBdICE9PSAnLycgJiYgIW5hbWUuc3RhcnRzV2l0aCgnZGI6Ly8nKSkge1xyXG4gICAgICAgICAgICBuYW1lID0gJy8nICsgbmFtZTsgICAgLy8g5L2/55So5YWo5ZCN5Yy56YWNXHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHNlYXJjaCBzY2VuZVxyXG4gICAgICAgIHZhciBpbmZvID0gdGhpcy5zY2VuZXMuZmluZChmdW5jdGlvbiAodmFsLCBrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGtleS5lbmRzV2l0aChuYW1lKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgIH0sXHJcblxyXG4gICAgZGVzdHJveTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMucGF0aHMuZGVzdHJveSgpO1xyXG4gICAgICAgIHRoaXMuc2NlbmVzLmRlc3Ryb3koKTtcclxuICAgICAgICB0aGlzLmFzc2V0SW5mb3MuZGVzdHJveSgpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuaWYgKENDX1RFU1QpIHtcclxuICAgIGNjLl9UZXN0LkNvbmZpZyA9IENvbmZpZztcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDb25maWc7Il0sInNvdXJjZVJvb3QiOiIvIn0=