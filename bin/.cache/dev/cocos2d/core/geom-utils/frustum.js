
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/geom-utils/frustum.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

exports.__esModule = true;
exports["default"] = void 0;

var _valueTypes = require("../value-types");

var _enums = _interopRequireDefault(require("./enums"));

var _plane = _interopRequireDefault(require("./plane"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

var _v = new Array(8);

_v[0] = new _valueTypes.Vec3(1, 1, 1);
_v[1] = new _valueTypes.Vec3(-1, 1, 1);
_v[2] = new _valueTypes.Vec3(-1, -1, 1);
_v[3] = new _valueTypes.Vec3(1, -1, 1);
_v[4] = new _valueTypes.Vec3(1, 1, -1);
_v[5] = new _valueTypes.Vec3(-1, 1, -1);
_v[6] = new _valueTypes.Vec3(-1, -1, -1);
_v[7] = new _valueTypes.Vec3(1, -1, -1);
/**
 * !#en frustum
 * !#zh 平截头体
 * @class geomUtils.Frustum
 */

var frustum = /*#__PURE__*/function () {
  /**
   * create a new frustum
   * @method create
   * @static
   * @return {Frustum}
   */
  frustum.create = function create() {
    return new frustum();
  }
  /**
   * Clone a frustum
   * @method clone
   * @param {Frustum} f
   * @static
   * @return {Frustum}
   */
  ;

  frustum.clone = function clone(f) {
    return frustum.copy(new frustum(), f);
  }
  /**
   * Copy the values from one frustum to another
   * @method copy
   * @param {Frustum} out
   * @param {Frustum} f
   * @return {Frustum}
   */
  ;

  frustum.copy = function copy(out, f) {
    out._type = f._type;

    for (var i = 0; i < 6; ++i) {
      _plane["default"].copy(out.planes[i], f.planes[i]);
    }

    for (var _i = 0; _i < 8; ++_i) {
      _valueTypes.Vec3.copy(out.vertices[_i], f.vertices[_i]);
    }

    return out;
  }
  /**
   * @property {Plane[]} planes
   */
  ;

  function frustum() {
    this.planes = void 0;
    this.vertices = void 0;
    this._type = void 0;
    this._type = _enums["default"].SHAPE_FRUSTUM;
    this.planes = new Array(6);

    for (var i = 0; i < 6; ++i) {
      this.planes[i] = _plane["default"].create(0, 0, 0, 0);
    }

    this.vertices = new Array(8);

    for (var _i2 = 0; _i2 < 8; ++_i2) {
      this.vertices[_i2] = new _valueTypes.Vec3();
    }
  }
  /**
   * !#en Update the frustum information according to the given transform matrix.
   * Note that the resulting planes are not normalized under normal mode.
   * @method update
   * @param {Mat4} m the view-projection matrix
   * @param {Mat4} inv the inverse view-projection matrix
   */


  var _proto = frustum.prototype;

  _proto.update = function update(m, inv) {
    // RTR4, ch. 22.14.1, p. 983
    // extract frustum planes from view-proj matrix.
    var mm = m.m; // left plane

    _valueTypes.Vec3.set(this.planes[0].n, mm[3] + mm[0], mm[7] + mm[4], mm[11] + mm[8]);

    this.planes[0].d = -(mm[15] + mm[12]); // right plane

    _valueTypes.Vec3.set(this.planes[1].n, mm[3] - mm[0], mm[7] - mm[4], mm[11] - mm[8]);

    this.planes[1].d = -(mm[15] - mm[12]); // bottom plane

    _valueTypes.Vec3.set(this.planes[2].n, mm[3] + mm[1], mm[7] + mm[5], mm[11] + mm[9]);

    this.planes[2].d = -(mm[15] + mm[13]); // top plane

    _valueTypes.Vec3.set(this.planes[3].n, mm[3] - mm[1], mm[7] - mm[5], mm[11] - mm[9]);

    this.planes[3].d = -(mm[15] - mm[13]); // near plane

    _valueTypes.Vec3.set(this.planes[4].n, mm[3] + mm[2], mm[7] + mm[6], mm[11] + mm[10]);

    this.planes[4].d = -(mm[15] + mm[14]); // far plane

    _valueTypes.Vec3.set(this.planes[5].n, mm[3] - mm[2], mm[7] - mm[6], mm[11] - mm[10]);

    this.planes[5].d = -(mm[15] - mm[14]);

    if (this._type !== _enums["default"].SHAPE_FRUSTUM_ACCURATE) {
      return;
    } // normalize planes


    for (var i = 0; i < 6; i++) {
      var pl = this.planes[i];
      var invDist = 1 / pl.n.length();

      _valueTypes.Vec3.multiplyScalar(pl.n, pl.n, invDist);

      pl.d *= invDist;
    } // update frustum vertices


    for (var _i3 = 0; _i3 < 8; _i3++) {
      _valueTypes.Vec3.transformMat4(this.vertices[_i3], _v[_i3], inv);
    }
  }
  /**
   * !#en transform by matrix
   * @method transform
   * @param {Mat4} mat
   */
  ;

  _proto.transform = function transform(mat) {
    if (this._type !== _enums["default"].SHAPE_FRUSTUM_ACCURATE) {
      return;
    }

    for (var i = 0; i < 8; i++) {
      _valueTypes.Vec3.transformMat4(this.vertices[i], this.vertices[i], mat);
    }

    _plane["default"].fromPoints(this.planes[0], this.vertices[1], this.vertices[5], this.vertices[6]);

    _plane["default"].fromPoints(this.planes[1], this.vertices[3], this.vertices[7], this.vertices[4]);

    _plane["default"].fromPoints(this.planes[2], this.vertices[6], this.vertices[7], this.vertices[3]);

    _plane["default"].fromPoints(this.planes[3], this.vertices[0], this.vertices[4], this.vertices[5]);

    _plane["default"].fromPoints(this.planes[4], this.vertices[2], this.vertices[3], this.vertices[0]);

    _plane["default"].fromPoints(this.planes[0], this.vertices[7], this.vertices[6], this.vertices[5]);
  };

  _createClass(frustum, [{
    key: "accurate",
    set:
    /**
     * Set whether to use accurate intersection testing function on this frustum
     * @property {boolean} accurate
     */
    function set(b) {
      this._type = b ? _enums["default"].SHAPE_FRUSTUM_ACCURATE : _enums["default"].SHAPE_FRUSTUM;
    }
  }]);

  return frustum;
}();

exports["default"] = frustum;

frustum.createOrtho = function () {
  var _temp_v3 = new _valueTypes.Vec3();

  return function (out, width, height, near, far, transform) {
    var halfWidth = width / 2;
    var halfHeight = height / 2;

    _valueTypes.Vec3.set(_temp_v3, halfWidth, halfHeight, near);

    _valueTypes.Vec3.transformMat4(out.vertices[0], _temp_v3, transform);

    _valueTypes.Vec3.set(_temp_v3, -halfWidth, halfHeight, near);

    _valueTypes.Vec3.transformMat4(out.vertices[1], _temp_v3, transform);

    _valueTypes.Vec3.set(_temp_v3, -halfWidth, -halfHeight, near);

    _valueTypes.Vec3.transformMat4(out.vertices[2], _temp_v3, transform);

    _valueTypes.Vec3.set(_temp_v3, halfWidth, -halfHeight, near);

    _valueTypes.Vec3.transformMat4(out.vertices[3], _temp_v3, transform);

    _valueTypes.Vec3.set(_temp_v3, halfWidth, halfHeight, far);

    _valueTypes.Vec3.transformMat4(out.vertices[4], _temp_v3, transform);

    _valueTypes.Vec3.set(_temp_v3, -halfWidth, halfHeight, far);

    _valueTypes.Vec3.transformMat4(out.vertices[5], _temp_v3, transform);

    _valueTypes.Vec3.set(_temp_v3, -halfWidth, -halfHeight, far);

    _valueTypes.Vec3.transformMat4(out.vertices[6], _temp_v3, transform);

    _valueTypes.Vec3.set(_temp_v3, halfWidth, -halfHeight, far);

    _valueTypes.Vec3.transformMat4(out.vertices[7], _temp_v3, transform);

    _plane["default"].fromPoints(out.planes[0], out.vertices[1], out.vertices[6], out.vertices[5]);

    _plane["default"].fromPoints(out.planes[1], out.vertices[3], out.vertices[4], out.vertices[7]);

    _plane["default"].fromPoints(out.planes[2], out.vertices[6], out.vertices[3], out.vertices[7]);

    _plane["default"].fromPoints(out.planes[3], out.vertices[0], out.vertices[5], out.vertices[4]);

    _plane["default"].fromPoints(out.planes[4], out.vertices[2], out.vertices[0], out.vertices[3]);

    _plane["default"].fromPoints(out.planes[0], out.vertices[7], out.vertices[5], out.vertices[6]);
  };
}();

module.exports = exports["default"];
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuZ2luZS1kZXZcXGNvY29zMmRcXGNvcmVcXGdlb20tdXRpbHNcXGZydXN0dW0udHMiXSwibmFtZXMiOlsiX3YiLCJBcnJheSIsIlZlYzMiLCJmcnVzdHVtIiwiY3JlYXRlIiwiY2xvbmUiLCJmIiwiY29weSIsIm91dCIsIl90eXBlIiwiaSIsInBsYW5lIiwicGxhbmVzIiwidmVydGljZXMiLCJlbnVtcyIsIlNIQVBFX0ZSVVNUVU0iLCJ1cGRhdGUiLCJtIiwiaW52IiwibW0iLCJzZXQiLCJuIiwiZCIsIlNIQVBFX0ZSVVNUVU1fQUNDVVJBVEUiLCJwbCIsImludkRpc3QiLCJsZW5ndGgiLCJtdWx0aXBseVNjYWxhciIsInRyYW5zZm9ybU1hdDQiLCJ0cmFuc2Zvcm0iLCJtYXQiLCJmcm9tUG9pbnRzIiwiYiIsImNyZWF0ZU9ydGhvIiwiX3RlbXBfdjMiLCJ3aWR0aCIsImhlaWdodCIsIm5lYXIiLCJmYXIiLCJoYWxmV2lkdGgiLCJoYWxmSGVpZ2h0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBeUJBOztBQUNBOztBQUNBOzs7Ozs7OztBQUVBLElBQU1BLEVBQUUsR0FBRyxJQUFJQyxLQUFKLENBQVUsQ0FBVixDQUFYOztBQUNBRCxFQUFFLENBQUMsQ0FBRCxDQUFGLEdBQVEsSUFBSUUsZ0JBQUosQ0FBUyxDQUFULEVBQVksQ0FBWixFQUFlLENBQWYsQ0FBUjtBQUNBRixFQUFFLENBQUMsQ0FBRCxDQUFGLEdBQVEsSUFBSUUsZ0JBQUosQ0FBUyxDQUFDLENBQVYsRUFBYSxDQUFiLEVBQWdCLENBQWhCLENBQVI7QUFDQUYsRUFBRSxDQUFDLENBQUQsQ0FBRixHQUFRLElBQUlFLGdCQUFKLENBQVMsQ0FBQyxDQUFWLEVBQWEsQ0FBQyxDQUFkLEVBQWlCLENBQWpCLENBQVI7QUFDQUYsRUFBRSxDQUFDLENBQUQsQ0FBRixHQUFRLElBQUlFLGdCQUFKLENBQVMsQ0FBVCxFQUFZLENBQUMsQ0FBYixFQUFnQixDQUFoQixDQUFSO0FBQ0FGLEVBQUUsQ0FBQyxDQUFELENBQUYsR0FBUSxJQUFJRSxnQkFBSixDQUFTLENBQVQsRUFBWSxDQUFaLEVBQWUsQ0FBQyxDQUFoQixDQUFSO0FBQ0FGLEVBQUUsQ0FBQyxDQUFELENBQUYsR0FBUSxJQUFJRSxnQkFBSixDQUFTLENBQUMsQ0FBVixFQUFhLENBQWIsRUFBZ0IsQ0FBQyxDQUFqQixDQUFSO0FBQ0FGLEVBQUUsQ0FBQyxDQUFELENBQUYsR0FBUSxJQUFJRSxnQkFBSixDQUFTLENBQUMsQ0FBVixFQUFhLENBQUMsQ0FBZCxFQUFpQixDQUFDLENBQWxCLENBQVI7QUFDQUYsRUFBRSxDQUFDLENBQUQsQ0FBRixHQUFRLElBQUlFLGdCQUFKLENBQVMsQ0FBVCxFQUFZLENBQUMsQ0FBYixFQUFnQixDQUFDLENBQWpCLENBQVI7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztJQUNxQkM7QUF5Q2pCO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtVQUNrQkMsU0FBZCxrQkFBd0I7QUFDcEIsV0FBTyxJQUFJRCxPQUFKLEVBQVA7QUFDSDtBQUVEO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7VUFDa0JFLFFBQWQsZUFBcUJDLENBQXJCLEVBQTBDO0FBQ3RDLFdBQU9ILE9BQU8sQ0FBQ0ksSUFBUixDQUFhLElBQUlKLE9BQUosRUFBYixFQUE0QkcsQ0FBNUIsQ0FBUDtBQUNIO0FBRUQ7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztVQUNrQkMsT0FBZCxjQUFvQkMsR0FBcEIsRUFBa0NGLENBQWxDLEVBQXVEO0FBQ25ERSxJQUFBQSxHQUFHLENBQUNDLEtBQUosR0FBWUgsQ0FBQyxDQUFDRyxLQUFkOztBQUNBLFNBQUssSUFBSUMsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxDQUFwQixFQUF1QixFQUFFQSxDQUF6QixFQUE0QjtBQUN4QkMsd0JBQU1KLElBQU4sQ0FBV0MsR0FBRyxDQUFDSSxNQUFKLENBQVdGLENBQVgsQ0FBWCxFQUEwQkosQ0FBQyxDQUFDTSxNQUFGLENBQVNGLENBQVQsQ0FBMUI7QUFDSDs7QUFDRCxTQUFLLElBQUlBLEVBQUMsR0FBRyxDQUFiLEVBQWdCQSxFQUFDLEdBQUcsQ0FBcEIsRUFBdUIsRUFBRUEsRUFBekIsRUFBNEI7QUFDeEJSLHVCQUFLSyxJQUFMLENBQVVDLEdBQUcsQ0FBQ0ssUUFBSixDQUFhSCxFQUFiLENBQVYsRUFBMkJKLENBQUMsQ0FBQ08sUUFBRixDQUFXSCxFQUFYLENBQTNCO0FBQ0g7O0FBQ0QsV0FBT0YsR0FBUDtBQUNIO0FBRUQ7QUFDSjtBQUNBOzs7QUFRSSxxQkFBZTtBQUFBLFNBUFJJLE1BT1E7QUFBQSxTQUhSQyxRQUdRO0FBQUEsU0FGUEosS0FFTztBQUNYLFNBQUtBLEtBQUwsR0FBYUssa0JBQU1DLGFBQW5CO0FBQ0EsU0FBS0gsTUFBTCxHQUFjLElBQUlYLEtBQUosQ0FBVSxDQUFWLENBQWQ7O0FBQ0EsU0FBSyxJQUFJUyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLENBQXBCLEVBQXVCLEVBQUVBLENBQXpCLEVBQTRCO0FBQ3hCLFdBQUtFLE1BQUwsQ0FBWUYsQ0FBWixJQUFpQkMsa0JBQU1QLE1BQU4sQ0FBYSxDQUFiLEVBQWdCLENBQWhCLEVBQW1CLENBQW5CLEVBQXNCLENBQXRCLENBQWpCO0FBQ0g7O0FBQ0QsU0FBS1MsUUFBTCxHQUFnQixJQUFJWixLQUFKLENBQVUsQ0FBVixDQUFoQjs7QUFDQSxTQUFLLElBQUlTLEdBQUMsR0FBRyxDQUFiLEVBQWdCQSxHQUFDLEdBQUcsQ0FBcEIsRUFBdUIsRUFBRUEsR0FBekIsRUFBNEI7QUFDeEIsV0FBS0csUUFBTCxDQUFjSCxHQUFkLElBQW1CLElBQUlSLGdCQUFKLEVBQW5CO0FBQ0g7QUFDSjtBQUVEO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztTQUNXYyxTQUFQLGdCQUFlQyxDQUFmLEVBQXdCQyxHQUF4QixFQUFtQztBQUMvQjtBQUNBO0FBRUEsUUFBSUMsRUFBRSxHQUFHRixDQUFDLENBQUNBLENBQVgsQ0FKK0IsQ0FNL0I7O0FBQ0FmLHFCQUFLa0IsR0FBTCxDQUFTLEtBQUtSLE1BQUwsQ0FBWSxDQUFaLEVBQWVTLENBQXhCLEVBQTJCRixFQUFFLENBQUMsQ0FBRCxDQUFGLEdBQVFBLEVBQUUsQ0FBQyxDQUFELENBQXJDLEVBQTBDQSxFQUFFLENBQUMsQ0FBRCxDQUFGLEdBQVFBLEVBQUUsQ0FBQyxDQUFELENBQXBELEVBQXlEQSxFQUFFLENBQUMsRUFBRCxDQUFGLEdBQVNBLEVBQUUsQ0FBQyxDQUFELENBQXBFOztBQUNBLFNBQUtQLE1BQUwsQ0FBWSxDQUFaLEVBQWVVLENBQWYsR0FBbUIsRUFBRUgsRUFBRSxDQUFDLEVBQUQsQ0FBRixHQUFTQSxFQUFFLENBQUMsRUFBRCxDQUFiLENBQW5CLENBUitCLENBUy9COztBQUNBakIscUJBQUtrQixHQUFMLENBQVMsS0FBS1IsTUFBTCxDQUFZLENBQVosRUFBZVMsQ0FBeEIsRUFBMkJGLEVBQUUsQ0FBQyxDQUFELENBQUYsR0FBUUEsRUFBRSxDQUFDLENBQUQsQ0FBckMsRUFBMENBLEVBQUUsQ0FBQyxDQUFELENBQUYsR0FBUUEsRUFBRSxDQUFDLENBQUQsQ0FBcEQsRUFBeURBLEVBQUUsQ0FBQyxFQUFELENBQUYsR0FBU0EsRUFBRSxDQUFDLENBQUQsQ0FBcEU7O0FBQ0EsU0FBS1AsTUFBTCxDQUFZLENBQVosRUFBZVUsQ0FBZixHQUFtQixFQUFFSCxFQUFFLENBQUMsRUFBRCxDQUFGLEdBQVNBLEVBQUUsQ0FBQyxFQUFELENBQWIsQ0FBbkIsQ0FYK0IsQ0FZL0I7O0FBQ0FqQixxQkFBS2tCLEdBQUwsQ0FBUyxLQUFLUixNQUFMLENBQVksQ0FBWixFQUFlUyxDQUF4QixFQUEyQkYsRUFBRSxDQUFDLENBQUQsQ0FBRixHQUFRQSxFQUFFLENBQUMsQ0FBRCxDQUFyQyxFQUEwQ0EsRUFBRSxDQUFDLENBQUQsQ0FBRixHQUFRQSxFQUFFLENBQUMsQ0FBRCxDQUFwRCxFQUF5REEsRUFBRSxDQUFDLEVBQUQsQ0FBRixHQUFTQSxFQUFFLENBQUMsQ0FBRCxDQUFwRTs7QUFDQSxTQUFLUCxNQUFMLENBQVksQ0FBWixFQUFlVSxDQUFmLEdBQW1CLEVBQUVILEVBQUUsQ0FBQyxFQUFELENBQUYsR0FBU0EsRUFBRSxDQUFDLEVBQUQsQ0FBYixDQUFuQixDQWQrQixDQWUvQjs7QUFDQWpCLHFCQUFLa0IsR0FBTCxDQUFTLEtBQUtSLE1BQUwsQ0FBWSxDQUFaLEVBQWVTLENBQXhCLEVBQTJCRixFQUFFLENBQUMsQ0FBRCxDQUFGLEdBQVFBLEVBQUUsQ0FBQyxDQUFELENBQXJDLEVBQTBDQSxFQUFFLENBQUMsQ0FBRCxDQUFGLEdBQVFBLEVBQUUsQ0FBQyxDQUFELENBQXBELEVBQXlEQSxFQUFFLENBQUMsRUFBRCxDQUFGLEdBQVNBLEVBQUUsQ0FBQyxDQUFELENBQXBFOztBQUNBLFNBQUtQLE1BQUwsQ0FBWSxDQUFaLEVBQWVVLENBQWYsR0FBbUIsRUFBRUgsRUFBRSxDQUFDLEVBQUQsQ0FBRixHQUFTQSxFQUFFLENBQUMsRUFBRCxDQUFiLENBQW5CLENBakIrQixDQWtCL0I7O0FBQ0FqQixxQkFBS2tCLEdBQUwsQ0FBUyxLQUFLUixNQUFMLENBQVksQ0FBWixFQUFlUyxDQUF4QixFQUEyQkYsRUFBRSxDQUFDLENBQUQsQ0FBRixHQUFRQSxFQUFFLENBQUMsQ0FBRCxDQUFyQyxFQUEwQ0EsRUFBRSxDQUFDLENBQUQsQ0FBRixHQUFRQSxFQUFFLENBQUMsQ0FBRCxDQUFwRCxFQUF5REEsRUFBRSxDQUFDLEVBQUQsQ0FBRixHQUFTQSxFQUFFLENBQUMsRUFBRCxDQUFwRTs7QUFDQSxTQUFLUCxNQUFMLENBQVksQ0FBWixFQUFlVSxDQUFmLEdBQW1CLEVBQUVILEVBQUUsQ0FBQyxFQUFELENBQUYsR0FBU0EsRUFBRSxDQUFDLEVBQUQsQ0FBYixDQUFuQixDQXBCK0IsQ0FxQi9COztBQUNBakIscUJBQUtrQixHQUFMLENBQVMsS0FBS1IsTUFBTCxDQUFZLENBQVosRUFBZVMsQ0FBeEIsRUFBMkJGLEVBQUUsQ0FBQyxDQUFELENBQUYsR0FBUUEsRUFBRSxDQUFDLENBQUQsQ0FBckMsRUFBMENBLEVBQUUsQ0FBQyxDQUFELENBQUYsR0FBUUEsRUFBRSxDQUFDLENBQUQsQ0FBcEQsRUFBeURBLEVBQUUsQ0FBQyxFQUFELENBQUYsR0FBU0EsRUFBRSxDQUFDLEVBQUQsQ0FBcEU7O0FBQ0EsU0FBS1AsTUFBTCxDQUFZLENBQVosRUFBZVUsQ0FBZixHQUFtQixFQUFFSCxFQUFFLENBQUMsRUFBRCxDQUFGLEdBQVNBLEVBQUUsQ0FBQyxFQUFELENBQWIsQ0FBbkI7O0FBRUEsUUFBSSxLQUFLVixLQUFMLEtBQWVLLGtCQUFNUyxzQkFBekIsRUFBaUQ7QUFBRTtBQUFTLEtBekI3QixDQTJCL0I7OztBQUNBLFNBQUssSUFBSWIsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxDQUFwQixFQUF1QkEsQ0FBQyxFQUF4QixFQUE0QjtBQUN4QixVQUFNYyxFQUFFLEdBQUcsS0FBS1osTUFBTCxDQUFZRixDQUFaLENBQVg7QUFDQSxVQUFNZSxPQUFPLEdBQUcsSUFBSUQsRUFBRSxDQUFDSCxDQUFILENBQUtLLE1BQUwsRUFBcEI7O0FBQ0F4Qix1QkFBS3lCLGNBQUwsQ0FBb0JILEVBQUUsQ0FBQ0gsQ0FBdkIsRUFBMEJHLEVBQUUsQ0FBQ0gsQ0FBN0IsRUFBZ0NJLE9BQWhDOztBQUNBRCxNQUFBQSxFQUFFLENBQUNGLENBQUgsSUFBUUcsT0FBUjtBQUNILEtBakM4QixDQW1DL0I7OztBQUNBLFNBQUssSUFBSWYsR0FBQyxHQUFHLENBQWIsRUFBZ0JBLEdBQUMsR0FBRyxDQUFwQixFQUF1QkEsR0FBQyxFQUF4QixFQUE0QjtBQUN4QlIsdUJBQUswQixhQUFMLENBQW1CLEtBQUtmLFFBQUwsQ0FBY0gsR0FBZCxDQUFuQixFQUFxQ1YsRUFBRSxDQUFDVSxHQUFELENBQXZDLEVBQTRDUSxHQUE1QztBQUNIO0FBQ0o7QUFFRDtBQUNKO0FBQ0E7QUFDQTtBQUNBOzs7U0FDV1csWUFBUCxtQkFBa0JDLEdBQWxCLEVBQTZCO0FBQ3pCLFFBQUksS0FBS3JCLEtBQUwsS0FBZUssa0JBQU1TLHNCQUF6QixFQUFpRDtBQUM3QztBQUNIOztBQUNELFNBQUssSUFBSWIsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxDQUFwQixFQUF1QkEsQ0FBQyxFQUF4QixFQUE0QjtBQUN4QlIsdUJBQUswQixhQUFMLENBQW1CLEtBQUtmLFFBQUwsQ0FBY0gsQ0FBZCxDQUFuQixFQUFxQyxLQUFLRyxRQUFMLENBQWNILENBQWQsQ0FBckMsRUFBdURvQixHQUF2RDtBQUNIOztBQUNEbkIsc0JBQU1vQixVQUFOLENBQWlCLEtBQUtuQixNQUFMLENBQVksQ0FBWixDQUFqQixFQUFpQyxLQUFLQyxRQUFMLENBQWMsQ0FBZCxDQUFqQyxFQUFtRCxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFuRCxFQUFxRSxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFyRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCLEtBQUtuQixNQUFMLENBQVksQ0FBWixDQUFqQixFQUFpQyxLQUFLQyxRQUFMLENBQWMsQ0FBZCxDQUFqQyxFQUFtRCxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFuRCxFQUFxRSxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFyRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCLEtBQUtuQixNQUFMLENBQVksQ0FBWixDQUFqQixFQUFpQyxLQUFLQyxRQUFMLENBQWMsQ0FBZCxDQUFqQyxFQUFtRCxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFuRCxFQUFxRSxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFyRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCLEtBQUtuQixNQUFMLENBQVksQ0FBWixDQUFqQixFQUFpQyxLQUFLQyxRQUFMLENBQWMsQ0FBZCxDQUFqQyxFQUFtRCxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFuRCxFQUFxRSxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFyRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCLEtBQUtuQixNQUFMLENBQVksQ0FBWixDQUFqQixFQUFpQyxLQUFLQyxRQUFMLENBQWMsQ0FBZCxDQUFqQyxFQUFtRCxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFuRCxFQUFxRSxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFyRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCLEtBQUtuQixNQUFMLENBQVksQ0FBWixDQUFqQixFQUFpQyxLQUFLQyxRQUFMLENBQWMsQ0FBZCxDQUFqQyxFQUFtRCxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFuRCxFQUFxRSxLQUFLQSxRQUFMLENBQWMsQ0FBZCxDQUFyRTtBQUNIOzs7OztBQXRLRDtBQUNKO0FBQ0E7QUFDQTtBQUNJLGlCQUFjbUIsQ0FBZCxFQUEwQjtBQUN0QixXQUFLdkIsS0FBTCxHQUFhdUIsQ0FBQyxHQUFHbEIsa0JBQU1TLHNCQUFULEdBQWtDVCxrQkFBTUMsYUFBdEQ7QUFDSDs7Ozs7Ozs7QUFSZ0JaLFFBVUg4QixjQUFlLFlBQU07QUFDL0IsTUFBTUMsUUFBUSxHQUFHLElBQUloQyxnQkFBSixFQUFqQjs7QUFDQSxTQUFPLFVBQUNNLEdBQUQsRUFBZTJCLEtBQWYsRUFBOEJDLE1BQTlCLEVBQThDQyxJQUE5QyxFQUE0REMsR0FBNUQsRUFBeUVULFNBQXpFLEVBQTZGO0FBQ2hHLFFBQU1VLFNBQVMsR0FBR0osS0FBSyxHQUFHLENBQTFCO0FBQ0EsUUFBTUssVUFBVSxHQUFHSixNQUFNLEdBQUcsQ0FBNUI7O0FBQ0FsQyxxQkFBS2tCLEdBQUwsQ0FBU2MsUUFBVCxFQUFtQkssU0FBbkIsRUFBOEJDLFVBQTlCLEVBQTBDSCxJQUExQzs7QUFDQW5DLHFCQUFLMEIsYUFBTCxDQUFtQnBCLEdBQUcsQ0FBQ0ssUUFBSixDQUFhLENBQWIsQ0FBbkIsRUFBb0NxQixRQUFwQyxFQUE4Q0wsU0FBOUM7O0FBQ0EzQixxQkFBS2tCLEdBQUwsQ0FBU2MsUUFBVCxFQUFtQixDQUFDSyxTQUFwQixFQUErQkMsVUFBL0IsRUFBMkNILElBQTNDOztBQUNBbkMscUJBQUswQixhQUFMLENBQW1CcEIsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFuQixFQUFvQ3FCLFFBQXBDLEVBQThDTCxTQUE5Qzs7QUFDQTNCLHFCQUFLa0IsR0FBTCxDQUFTYyxRQUFULEVBQW1CLENBQUNLLFNBQXBCLEVBQStCLENBQUNDLFVBQWhDLEVBQTRDSCxJQUE1Qzs7QUFDQW5DLHFCQUFLMEIsYUFBTCxDQUFtQnBCLEdBQUcsQ0FBQ0ssUUFBSixDQUFhLENBQWIsQ0FBbkIsRUFBb0NxQixRQUFwQyxFQUE4Q0wsU0FBOUM7O0FBQ0EzQixxQkFBS2tCLEdBQUwsQ0FBU2MsUUFBVCxFQUFtQkssU0FBbkIsRUFBOEIsQ0FBQ0MsVUFBL0IsRUFBMkNILElBQTNDOztBQUNBbkMscUJBQUswQixhQUFMLENBQW1CcEIsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFuQixFQUFvQ3FCLFFBQXBDLEVBQThDTCxTQUE5Qzs7QUFDQTNCLHFCQUFLa0IsR0FBTCxDQUFTYyxRQUFULEVBQW1CSyxTQUFuQixFQUE4QkMsVUFBOUIsRUFBMENGLEdBQTFDOztBQUNBcEMscUJBQUswQixhQUFMLENBQW1CcEIsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFuQixFQUFvQ3FCLFFBQXBDLEVBQThDTCxTQUE5Qzs7QUFDQTNCLHFCQUFLa0IsR0FBTCxDQUFTYyxRQUFULEVBQW1CLENBQUNLLFNBQXBCLEVBQStCQyxVQUEvQixFQUEyQ0YsR0FBM0M7O0FBQ0FwQyxxQkFBSzBCLGFBQUwsQ0FBbUJwQixHQUFHLENBQUNLLFFBQUosQ0FBYSxDQUFiLENBQW5CLEVBQW9DcUIsUUFBcEMsRUFBOENMLFNBQTlDOztBQUNBM0IscUJBQUtrQixHQUFMLENBQVNjLFFBQVQsRUFBbUIsQ0FBQ0ssU0FBcEIsRUFBK0IsQ0FBQ0MsVUFBaEMsRUFBNENGLEdBQTVDOztBQUNBcEMscUJBQUswQixhQUFMLENBQW1CcEIsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFuQixFQUFvQ3FCLFFBQXBDLEVBQThDTCxTQUE5Qzs7QUFDQTNCLHFCQUFLa0IsR0FBTCxDQUFTYyxRQUFULEVBQW1CSyxTQUFuQixFQUE4QixDQUFDQyxVQUEvQixFQUEyQ0YsR0FBM0M7O0FBQ0FwQyxxQkFBSzBCLGFBQUwsQ0FBbUJwQixHQUFHLENBQUNLLFFBQUosQ0FBYSxDQUFiLENBQW5CLEVBQW9DcUIsUUFBcEMsRUFBOENMLFNBQTlDOztBQUVBbEIsc0JBQU1vQixVQUFOLENBQWlCdkIsR0FBRyxDQUFDSSxNQUFKLENBQVcsQ0FBWCxDQUFqQixFQUFnQ0osR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFoQyxFQUFpREwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFqRCxFQUFrRUwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFsRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCdkIsR0FBRyxDQUFDSSxNQUFKLENBQVcsQ0FBWCxDQUFqQixFQUFnQ0osR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFoQyxFQUFpREwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFqRCxFQUFrRUwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFsRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCdkIsR0FBRyxDQUFDSSxNQUFKLENBQVcsQ0FBWCxDQUFqQixFQUFnQ0osR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFoQyxFQUFpREwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFqRCxFQUFrRUwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFsRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCdkIsR0FBRyxDQUFDSSxNQUFKLENBQVcsQ0FBWCxDQUFqQixFQUFnQ0osR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFoQyxFQUFpREwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFqRCxFQUFrRUwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFsRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCdkIsR0FBRyxDQUFDSSxNQUFKLENBQVcsQ0FBWCxDQUFqQixFQUFnQ0osR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFoQyxFQUFpREwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFqRCxFQUFrRUwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFsRTs7QUFDQUYsc0JBQU1vQixVQUFOLENBQWlCdkIsR0FBRyxDQUFDSSxNQUFKLENBQVcsQ0FBWCxDQUFqQixFQUFnQ0osR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFoQyxFQUFpREwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFqRCxFQUFrRUwsR0FBRyxDQUFDSyxRQUFKLENBQWEsQ0FBYixDQUFsRTtBQUNILEdBMUJEO0FBMkJILENBN0IyQiIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiBDb3B5cmlnaHQgKGMpIDIwMTkgWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuXHJcblxyXG4gaHR0cHM6Ly93d3cuY29jb3MuY29tL1xyXG5cclxuIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcclxuIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZW5naW5lIHNvdXJjZSBjb2RlICh0aGUgXCJTb2Z0d2FyZVwiKSwgYSBsaW1pdGVkLFxyXG4gd29ybGR3aWRlLCByb3lhbHR5LWZyZWUsIG5vbi1hc3NpZ25hYmxlLCByZXZvY2FibGUgYW5kIG5vbi1leGNsdXNpdmUgbGljZW5zZVxyXG4gdG8gdXNlIENvY29zIENyZWF0b3Igc29sZWx5IHRvIGRldmVsb3AgZ2FtZXMgb24geW91ciB0YXJnZXQgcGxhdGZvcm1zLiBZb3Ugc2hhbGxcclxuIG5vdCB1c2UgQ29jb3MgQ3JlYXRvciBzb2Z0d2FyZSBmb3IgZGV2ZWxvcGluZyBvdGhlciBzb2Z0d2FyZSBvciB0b29scyB0aGF0J3NcclxuIHVzZWQgZm9yIGRldmVsb3BpbmcgZ2FtZXMuIFlvdSBhcmUgbm90IGdyYW50ZWQgdG8gcHVibGlzaCwgZGlzdHJpYnV0ZSxcclxuIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiBDb2NvcyBDcmVhdG9yLlxyXG5cclxuIFRoZSBzb2Z0d2FyZSBvciB0b29scyBpbiB0aGlzIExpY2Vuc2UgQWdyZWVtZW50IGFyZSBsaWNlbnNlZCwgbm90IHNvbGQuXHJcbiBYaWFtZW4gWWFqaSBTb2Z0d2FyZSBDby4sIEx0ZC4gcmVzZXJ2ZXMgYWxsIHJpZ2h0cyBub3QgZXhwcmVzc2x5IGdyYW50ZWQgdG8geW91LlxyXG5cclxuIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4gVEhFIFNPRlRXQVJFLlxyXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcbmltcG9ydCB7IE1hdDQsIFZlYzMgfSBmcm9tICcuLi92YWx1ZS10eXBlcyc7XHJcbmltcG9ydCBlbnVtcyBmcm9tICcuL2VudW1zJztcclxuaW1wb3J0IHBsYW5lIGZyb20gJy4vcGxhbmUnO1xyXG5cclxuY29uc3QgX3YgPSBuZXcgQXJyYXkoOCk7XHJcbl92WzBdID0gbmV3IFZlYzMoMSwgMSwgMSk7XHJcbl92WzFdID0gbmV3IFZlYzMoLTEsIDEsIDEpO1xyXG5fdlsyXSA9IG5ldyBWZWMzKC0xLCAtMSwgMSk7XHJcbl92WzNdID0gbmV3IFZlYzMoMSwgLTEsIDEpO1xyXG5fdls0XSA9IG5ldyBWZWMzKDEsIDEsIC0xKTtcclxuX3ZbNV0gPSBuZXcgVmVjMygtMSwgMSwgLTEpO1xyXG5fdls2XSA9IG5ldyBWZWMzKC0xLCAtMSwgLTEpO1xyXG5fdls3XSA9IG5ldyBWZWMzKDEsIC0xLCAtMSk7XHJcblxyXG4vKipcclxuICogISNlbiBmcnVzdHVtXHJcbiAqICEjemgg5bmz5oiq5aS05L2TXHJcbiAqIEBjbGFzcyBnZW9tVXRpbHMuRnJ1c3R1bVxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZnJ1c3R1bSB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgd2hldGhlciB0byB1c2UgYWNjdXJhdGUgaW50ZXJzZWN0aW9uIHRlc3RpbmcgZnVuY3Rpb24gb24gdGhpcyBmcnVzdHVtXHJcbiAgICAgKiBAcHJvcGVydHkge2Jvb2xlYW59IGFjY3VyYXRlXHJcbiAgICAgKi9cclxuICAgIHNldCBhY2N1cmF0ZSAoYjogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSBiID8gZW51bXMuU0hBUEVfRlJVU1RVTV9BQ0NVUkFURSA6IGVudW1zLlNIQVBFX0ZSVVNUVU07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVPcnRobyA9ICgoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgX3RlbXBfdjMgPSBuZXcgVmVjMygpO1xyXG4gICAgICAgIHJldHVybiAob3V0OiBmcnVzdHVtLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgbmVhcjogbnVtYmVyLCBmYXI6IG51bWJlciwgdHJhbnNmb3JtOiBNYXQ0KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhbGZXaWR0aCA9IHdpZHRoIC8gMjtcclxuICAgICAgICAgICAgY29uc3QgaGFsZkhlaWdodCA9IGhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgIFZlYzMuc2V0KF90ZW1wX3YzLCBoYWxmV2lkdGgsIGhhbGZIZWlnaHQsIG5lYXIpO1xyXG4gICAgICAgICAgICBWZWMzLnRyYW5zZm9ybU1hdDQob3V0LnZlcnRpY2VzWzBdLCBfdGVtcF92MywgdHJhbnNmb3JtKTtcclxuICAgICAgICAgICAgVmVjMy5zZXQoX3RlbXBfdjMsIC1oYWxmV2lkdGgsIGhhbGZIZWlnaHQsIG5lYXIpO1xyXG4gICAgICAgICAgICBWZWMzLnRyYW5zZm9ybU1hdDQob3V0LnZlcnRpY2VzWzFdLCBfdGVtcF92MywgdHJhbnNmb3JtKTtcclxuICAgICAgICAgICAgVmVjMy5zZXQoX3RlbXBfdjMsIC1oYWxmV2lkdGgsIC1oYWxmSGVpZ2h0LCBuZWFyKTtcclxuICAgICAgICAgICAgVmVjMy50cmFuc2Zvcm1NYXQ0KG91dC52ZXJ0aWNlc1syXSwgX3RlbXBfdjMsIHRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgIFZlYzMuc2V0KF90ZW1wX3YzLCBoYWxmV2lkdGgsIC1oYWxmSGVpZ2h0LCBuZWFyKTtcclxuICAgICAgICAgICAgVmVjMy50cmFuc2Zvcm1NYXQ0KG91dC52ZXJ0aWNlc1szXSwgX3RlbXBfdjMsIHRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgIFZlYzMuc2V0KF90ZW1wX3YzLCBoYWxmV2lkdGgsIGhhbGZIZWlnaHQsIGZhcik7XHJcbiAgICAgICAgICAgIFZlYzMudHJhbnNmb3JtTWF0NChvdXQudmVydGljZXNbNF0sIF90ZW1wX3YzLCB0cmFuc2Zvcm0pO1xyXG4gICAgICAgICAgICBWZWMzLnNldChfdGVtcF92MywgLWhhbGZXaWR0aCwgaGFsZkhlaWdodCwgZmFyKTtcclxuICAgICAgICAgICAgVmVjMy50cmFuc2Zvcm1NYXQ0KG91dC52ZXJ0aWNlc1s1XSwgX3RlbXBfdjMsIHRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgIFZlYzMuc2V0KF90ZW1wX3YzLCAtaGFsZldpZHRoLCAtaGFsZkhlaWdodCwgZmFyKTtcclxuICAgICAgICAgICAgVmVjMy50cmFuc2Zvcm1NYXQ0KG91dC52ZXJ0aWNlc1s2XSwgX3RlbXBfdjMsIHRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgIFZlYzMuc2V0KF90ZW1wX3YzLCBoYWxmV2lkdGgsIC1oYWxmSGVpZ2h0LCBmYXIpO1xyXG4gICAgICAgICAgICBWZWMzLnRyYW5zZm9ybU1hdDQob3V0LnZlcnRpY2VzWzddLCBfdGVtcF92MywgdHJhbnNmb3JtKTtcclxuXHJcbiAgICAgICAgICAgIHBsYW5lLmZyb21Qb2ludHMob3V0LnBsYW5lc1swXSwgb3V0LnZlcnRpY2VzWzFdLCBvdXQudmVydGljZXNbNl0sIG91dC52ZXJ0aWNlc1s1XSk7XHJcbiAgICAgICAgICAgIHBsYW5lLmZyb21Qb2ludHMob3V0LnBsYW5lc1sxXSwgb3V0LnZlcnRpY2VzWzNdLCBvdXQudmVydGljZXNbNF0sIG91dC52ZXJ0aWNlc1s3XSk7XHJcbiAgICAgICAgICAgIHBsYW5lLmZyb21Qb2ludHMob3V0LnBsYW5lc1syXSwgb3V0LnZlcnRpY2VzWzZdLCBvdXQudmVydGljZXNbM10sIG91dC52ZXJ0aWNlc1s3XSk7XHJcbiAgICAgICAgICAgIHBsYW5lLmZyb21Qb2ludHMob3V0LnBsYW5lc1szXSwgb3V0LnZlcnRpY2VzWzBdLCBvdXQudmVydGljZXNbNV0sIG91dC52ZXJ0aWNlc1s0XSk7XHJcbiAgICAgICAgICAgIHBsYW5lLmZyb21Qb2ludHMob3V0LnBsYW5lc1s0XSwgb3V0LnZlcnRpY2VzWzJdLCBvdXQudmVydGljZXNbMF0sIG91dC52ZXJ0aWNlc1szXSk7XHJcbiAgICAgICAgICAgIHBsYW5lLmZyb21Qb2ludHMob3V0LnBsYW5lc1swXSwgb3V0LnZlcnRpY2VzWzddLCBvdXQudmVydGljZXNbNV0sIG91dC52ZXJ0aWNlc1s2XSk7XHJcbiAgICAgICAgfTtcclxuICAgIH0pKCk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBjcmVhdGUgYSBuZXcgZnJ1c3R1bVxyXG4gICAgICogQG1ldGhvZCBjcmVhdGVcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEByZXR1cm4ge0ZydXN0dW19XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IGZydXN0dW0oKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENsb25lIGEgZnJ1c3R1bVxyXG4gICAgICogQG1ldGhvZCBjbG9uZVxyXG4gICAgICogQHBhcmFtIHtGcnVzdHVtfSBmXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAcmV0dXJuIHtGcnVzdHVtfVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGNsb25lIChmOiBmcnVzdHVtKTogZnJ1c3R1bSB7XHJcbiAgICAgICAgcmV0dXJuIGZydXN0dW0uY29weShuZXcgZnJ1c3R1bSgpLCBmKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvcHkgdGhlIHZhbHVlcyBmcm9tIG9uZSBmcnVzdHVtIHRvIGFub3RoZXJcclxuICAgICAqIEBtZXRob2QgY29weVxyXG4gICAgICogQHBhcmFtIHtGcnVzdHVtfSBvdXRcclxuICAgICAqIEBwYXJhbSB7RnJ1c3R1bX0gZlxyXG4gICAgICogQHJldHVybiB7RnJ1c3R1bX1cclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBjb3B5IChvdXQ6IGZydXN0dW0sIGY6IGZydXN0dW0pOiBmcnVzdHVtIHtcclxuICAgICAgICBvdXQuX3R5cGUgPSBmLl90eXBlO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgKytpKSB7XHJcbiAgICAgICAgICAgIHBsYW5lLmNvcHkob3V0LnBsYW5lc1tpXSwgZi5wbGFuZXNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDg7ICsraSkge1xyXG4gICAgICAgICAgICBWZWMzLmNvcHkob3V0LnZlcnRpY2VzW2ldLCBmLnZlcnRpY2VzW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSB7UGxhbmVbXX0gcGxhbmVzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBwbGFuZXM6IHBsYW5lW107XHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSB7VmVjM1tdfSBwbGFuZXNcclxuICAgICAqL1xyXG4gICAgcHVibGljIHZlcnRpY2VzOiBWZWMzW107XHJcbiAgICBwcml2YXRlIF90eXBlOiBudW1iZXI7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSBlbnVtcy5TSEFQRV9GUlVTVFVNO1xyXG4gICAgICAgIHRoaXMucGxhbmVzID0gbmV3IEFycmF5KDYpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgKytpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGxhbmVzW2ldID0gcGxhbmUuY3JlYXRlKDAsIDAsIDAsIDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnZlcnRpY2VzID0gbmV3IEFycmF5KDgpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgKytpKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmVydGljZXNbaV0gPSBuZXcgVmVjMygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqICEjZW4gVXBkYXRlIHRoZSBmcnVzdHVtIGluZm9ybWF0aW9uIGFjY29yZGluZyB0byB0aGUgZ2l2ZW4gdHJhbnNmb3JtIG1hdHJpeC5cclxuICAgICAqIE5vdGUgdGhhdCB0aGUgcmVzdWx0aW5nIHBsYW5lcyBhcmUgbm90IG5vcm1hbGl6ZWQgdW5kZXIgbm9ybWFsIG1vZGUuXHJcbiAgICAgKiBAbWV0aG9kIHVwZGF0ZVxyXG4gICAgICogQHBhcmFtIHtNYXQ0fSBtIHRoZSB2aWV3LXByb2plY3Rpb24gbWF0cml4XHJcbiAgICAgKiBAcGFyYW0ge01hdDR9IGludiB0aGUgaW52ZXJzZSB2aWV3LXByb2plY3Rpb24gbWF0cml4XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB1cGRhdGUgKG06IE1hdDQsIGludjogTWF0NCkge1xyXG4gICAgICAgIC8vIFJUUjQsIGNoLiAyMi4xNC4xLCBwLiA5ODNcclxuICAgICAgICAvLyBleHRyYWN0IGZydXN0dW0gcGxhbmVzIGZyb20gdmlldy1wcm9qIG1hdHJpeC5cclxuXHJcbiAgICAgICAgbGV0IG1tID0gbS5tO1xyXG5cclxuICAgICAgICAvLyBsZWZ0IHBsYW5lXHJcbiAgICAgICAgVmVjMy5zZXQodGhpcy5wbGFuZXNbMF0ubiwgbW1bM10gKyBtbVswXSwgbW1bN10gKyBtbVs0XSwgbW1bMTFdICsgbW1bOF0pO1xyXG4gICAgICAgIHRoaXMucGxhbmVzWzBdLmQgPSAtKG1tWzE1XSArIG1tWzEyXSk7XHJcbiAgICAgICAgLy8gcmlnaHQgcGxhbmVcclxuICAgICAgICBWZWMzLnNldCh0aGlzLnBsYW5lc1sxXS5uLCBtbVszXSAtIG1tWzBdLCBtbVs3XSAtIG1tWzRdLCBtbVsxMV0gLSBtbVs4XSk7XHJcbiAgICAgICAgdGhpcy5wbGFuZXNbMV0uZCA9IC0obW1bMTVdIC0gbW1bMTJdKTtcclxuICAgICAgICAvLyBib3R0b20gcGxhbmVcclxuICAgICAgICBWZWMzLnNldCh0aGlzLnBsYW5lc1syXS5uLCBtbVszXSArIG1tWzFdLCBtbVs3XSArIG1tWzVdLCBtbVsxMV0gKyBtbVs5XSk7XHJcbiAgICAgICAgdGhpcy5wbGFuZXNbMl0uZCA9IC0obW1bMTVdICsgbW1bMTNdKTtcclxuICAgICAgICAvLyB0b3AgcGxhbmVcclxuICAgICAgICBWZWMzLnNldCh0aGlzLnBsYW5lc1szXS5uLCBtbVszXSAtIG1tWzFdLCBtbVs3XSAtIG1tWzVdLCBtbVsxMV0gLSBtbVs5XSk7XHJcbiAgICAgICAgdGhpcy5wbGFuZXNbM10uZCA9IC0obW1bMTVdIC0gbW1bMTNdKTtcclxuICAgICAgICAvLyBuZWFyIHBsYW5lXHJcbiAgICAgICAgVmVjMy5zZXQodGhpcy5wbGFuZXNbNF0ubiwgbW1bM10gKyBtbVsyXSwgbW1bN10gKyBtbVs2XSwgbW1bMTFdICsgbW1bMTBdKTtcclxuICAgICAgICB0aGlzLnBsYW5lc1s0XS5kID0gLShtbVsxNV0gKyBtbVsxNF0pO1xyXG4gICAgICAgIC8vIGZhciBwbGFuZVxyXG4gICAgICAgIFZlYzMuc2V0KHRoaXMucGxhbmVzWzVdLm4sIG1tWzNdIC0gbW1bMl0sIG1tWzddIC0gbW1bNl0sIG1tWzExXSAtIG1tWzEwXSk7XHJcbiAgICAgICAgdGhpcy5wbGFuZXNbNV0uZCA9IC0obW1bMTVdIC0gbW1bMTRdKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3R5cGUgIT09IGVudW1zLlNIQVBFX0ZSVVNUVU1fQUNDVVJBVEUpIHsgcmV0dXJuOyB9XHJcblxyXG4gICAgICAgIC8vIG5vcm1hbGl6ZSBwbGFuZXNcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBwbCA9IHRoaXMucGxhbmVzW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBpbnZEaXN0ID0gMSAvIHBsLm4ubGVuZ3RoKCk7XHJcbiAgICAgICAgICAgIFZlYzMubXVsdGlwbHlTY2FsYXIocGwubiwgcGwubiwgaW52RGlzdCk7XHJcbiAgICAgICAgICAgIHBsLmQgKj0gaW52RGlzdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHVwZGF0ZSBmcnVzdHVtIHZlcnRpY2VzXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcclxuICAgICAgICAgICAgVmVjMy50cmFuc2Zvcm1NYXQ0KHRoaXMudmVydGljZXNbaV0sIF92W2ldLCBpbnYpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqICEjZW4gdHJhbnNmb3JtIGJ5IG1hdHJpeFxyXG4gICAgICogQG1ldGhvZCB0cmFuc2Zvcm1cclxuICAgICAqIEBwYXJhbSB7TWF0NH0gbWF0XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB0cmFuc2Zvcm0gKG1hdDogTWF0NCkge1xyXG4gICAgICAgIGlmICh0aGlzLl90eXBlICE9PSBlbnVtcy5TSEFQRV9GUlVTVFVNX0FDQ1VSQVRFKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcclxuICAgICAgICAgICAgVmVjMy50cmFuc2Zvcm1NYXQ0KHRoaXMudmVydGljZXNbaV0sIHRoaXMudmVydGljZXNbaV0sIG1hdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBsYW5lLmZyb21Qb2ludHModGhpcy5wbGFuZXNbMF0sIHRoaXMudmVydGljZXNbMV0sIHRoaXMudmVydGljZXNbNV0sIHRoaXMudmVydGljZXNbNl0pO1xyXG4gICAgICAgIHBsYW5lLmZyb21Qb2ludHModGhpcy5wbGFuZXNbMV0sIHRoaXMudmVydGljZXNbM10sIHRoaXMudmVydGljZXNbN10sIHRoaXMudmVydGljZXNbNF0pO1xyXG4gICAgICAgIHBsYW5lLmZyb21Qb2ludHModGhpcy5wbGFuZXNbMl0sIHRoaXMudmVydGljZXNbNl0sIHRoaXMudmVydGljZXNbN10sIHRoaXMudmVydGljZXNbM10pO1xyXG4gICAgICAgIHBsYW5lLmZyb21Qb2ludHModGhpcy5wbGFuZXNbM10sIHRoaXMudmVydGljZXNbMF0sIHRoaXMudmVydGljZXNbNF0sIHRoaXMudmVydGljZXNbNV0pO1xyXG4gICAgICAgIHBsYW5lLmZyb21Qb2ludHModGhpcy5wbGFuZXNbNF0sIHRoaXMudmVydGljZXNbMl0sIHRoaXMudmVydGljZXNbM10sIHRoaXMudmVydGljZXNbMF0pO1xyXG4gICAgICAgIHBsYW5lLmZyb21Qb2ludHModGhpcy5wbGFuZXNbMF0sIHRoaXMudmVydGljZXNbN10sIHRoaXMudmVydGljZXNbNl0sIHRoaXMudmVydGljZXNbNV0pO1xyXG4gICAgfVxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiLyJ9